/*!
 * Handsontable 0.13.1
 * Handsontable is a JavaScript library for editable tables with basic copy-paste compatibility with Excel and Google Docs
 *
 * Copyright (c) 2012-2014 Marcin Warpechowski
 * Copyright (c) 2015 Handsoncode sp. z o.o. <hello@handsontable.com>
 * Licensed under the MIT license.
 * http://handsontable.com/
 *
 * Date: Thu Mar 19 2015 15:05:12 GMT+0100 (CET)
 */
function deleteHistory(e,t){var o=$("#delete-form");o.attr("action","/indicator_histories/"+e);var n=o.data("confirm-orig");o.data("confirm",n.replace("XXX",t)),o.submit()}var Handsontable=function(e,t){t=t||{};var o=new Handsontable.Core(e,t);return o.init(),o};Handsontable.plugins={},function(e,t){"use strict";function o(){this.refCounter=0,this.init()}function n(){function e(){var e=this;e._registerTimeout(setTimeout(function(){e.updateSettings({observeChanges:!0})},0))}function o(e){return function(t,o){return"string"==typeof t[1]&&(t[1]=t[1].toLowerCase()),"string"==typeof o[1]&&(o[1]=o[1].toLowerCase()),t[1]===o[1]?0:null===t[1]||""===t[1]?1:null===o[1]||""===o[1]?-1:t[1]<o[1]?e?-1:1:t[1]>o[1]?e?1:-1:0}}function n(e){return function(t,o){if(t[1]===o[1])return 0;if(null===t[1])return 1;if(null===o[1])return-1;var n=new Date(t[1]),i=new Date(o[1]);return i>n?e?-1:1:n>i?e?1:-1:0}}function i(e){return"undefined"!=typeof e.sortColumn}var r=this;this.init=function(t){var o,n,i=this,s=i.getSettings().columnSorting;if(i.sortingEnabled=!!s,i.sortingEnabled){i.sortIndex=[];var c=a.call(i);"undefined"!=typeof c?(o=c.sortColumn,n=c.sortOrder):(o=s.column,n=s.sortOrder),r.sortByColumn.call(i,o,n),i.sort=function(){var e=Array.prototype.slice.call(arguments);return r.sortByColumn.apply(i,e)},"undefined"==typeof i.getSettings().observeChanges&&e.call(i),"afterInit"==t&&(l.call(i),i.addHook("afterCreateRow",r.afterCreateRow),i.addHook("afterRemoveRow",r.afterRemoveRow),i.addHook("afterLoadData",r.init))}else delete i.sort,i.removeHook("afterCreateRow",r.afterCreateRow),i.removeHook("afterRemoveRow",r.afterRemoveRow),i.removeHook("afterLoadData",r.init)},this.setSortingColumn=function(e,t){var o=this;return"undefined"==typeof e?(delete o.sortColumn,void delete o.sortOrder):(o.sortColumn===e&&"undefined"==typeof t?o.sortOrder=!o.sortOrder:o.sortOrder="undefined"!=typeof t?t:!0,void(o.sortColumn=e))},this.sortByColumn=function(e,o){var n=this;r.setSortingColumn.call(n,e,o),"undefined"!=typeof n.sortColumn&&(t.hooks.run(n,"beforeColumnSort",n.sortColumn,n.sortOrder),r.sort.call(n),n.render(),s.call(n),t.hooks.run(n,"afterColumnSort",n.sortColumn,n.sortOrder))};var s=function(){var e=this,o={};"undefined"!=typeof e.sortColumn&&(o.sortColumn=e.sortColumn),"undefined"!=typeof e.sortOrder&&(o.sortOrder=e.sortOrder),(o.hasOwnProperty("sortColumn")||o.hasOwnProperty("sortOrder"))&&t.hooks.run(e,"persistentStateSave","columnSorting",o)},a=function(){var e=this,o={};return t.hooks.run(e,"persistentStateLoad","columnSorting",o),o.value},l=function(){function e(){var e=n.view.TBODY.querySelector("tr").querySelectorAll("th");return e.length}function o(o){var n=t.Dom.closest(o,"TH");return t.Dom.index(n)-e()}var n=this,i=t.eventManager(n);i.addEventListener(n.rootElement,"click",function(e){if(t.Dom.hasClass(e.target,"columnSorting")){var i=o(e.target);r.sortByColumn.call(n,i)}})};this.sort=function(){var e=this;if("undefined"!=typeof e.sortOrder){e.sortingEnabled=!1,e.sortIndex.length=0;for(var t=this.colOffset(),i=0,r=this.countRows()-e.getSettings().minSpareRows;r>i;i++)this.sortIndex.push([i,e.getDataAtCell(i,this.sortColumn+t)]);var s,a=e.getCellMeta(0,e.sortColumn);switch(a.type){case"date":s=n;break;default:s=o}this.sortIndex.sort(s(e.sortOrder));for(var i=this.sortIndex.length;i<e.countRows();i++)this.sortIndex.push([i,e.getDataAtCell(i,this.sortColumn+t)]);e.sortingEnabled=!0}},this.translateRow=function(e){var t=this;return t.sortingEnabled&&t.sortIndex&&t.sortIndex.length&&t.sortIndex[e]?t.sortIndex[e][0]:e},this.untranslateRow=function(e){var t=this;if(t.sortingEnabled&&t.sortIndex&&t.sortIndex.length)for(var o=0;o<t.sortIndex.length;o++)if(t.sortIndex[o][0]==e)return o},this.getColHeader=function(e,o){this.getSettings().columnSorting&&e>=0&&t.Dom.addClass(o.querySelector(".colHeader"),"columnSorting")},this.afterCreateRow=function(e,t){var o=this;if(i(o)){for(var n=0;n<o.sortIndex.length;n++)o.sortIndex[n][0]>=e&&(o.sortIndex[n][0]+=t);for(var n=0;t>n;n++)o.sortIndex.splice(e+n,0,[e+n,o.getData()[e+n][o.sortColumn+o.colOffset()]]);s.call(o)}},this.afterRemoveRow=function(e,t){var o=this;if(i(o)){var n=r.translateRow.call(o,e);o.sortIndex.splice(e,t);for(var a=0;a<o.sortIndex.length;a++)o.sortIndex[a][0]>n&&(o.sortIndex[a][0]-=t);s.call(o)}},this.afterChangeSort=function(e){var t=this,o=!1,n={};if(e){for(var i=0;i<e.length;i++)if(e[i][1]==t.sortColumn){o=!0,n.row=r.translateRow.call(t,e[i][0]),n.col=e[i][1];break}o&&t._registerTimeout(setTimeout(function(){r.sort.call(t),t.render(),t.selectCell(r.untranslateRow.call(t,n.row),n.col)},0))}}}function i(e){var o=t.eventManager(e),n=function(e,t,o,n){n.setCellMeta(e,t,"comment",o),n.render()},i=function(e,t,o){n(e.from.row,e.from.col,t,o)},r=function(){var e=c();e.style.display="none",e.value=""},s=function(n){function s(t){if(o.removeEventListener(document,"mouseover"),"htCommentTextArea"!=t.target.className&&-1==t.target.innerHTML.indexOf("Comment")){var s=document.querySelector(".htCommentTextArea").value;s.trim().length>1&&i(n,s,e),a(),r()}}o.addEventListener(document,"mousedown",t.helper.proxy(s))},a=function(){o.removeEventListener(document,"mousedown"),o.addEventListener(document,"mousedown",t.helper.proxy(u))},l=function(o,n){var i=e.view.wt.wtTable.getCell(o.from),r=t.Dom.offset(i),a=e.getColWidth(o.from.col);n.style.position="absolute",n.style.left=r.left+a+"px",n.style.top=r.top+"px",n.style.zIndex=2,s(o,n)},c=function(e){var o=document.querySelector(".htComments");if(!o){o=document.createElement("DIV");var n=document.createElement("TEXTAREA");t.Dom.addClass(n,"htCommentTextArea"),o.appendChild(n),t.Dom.addClass(o,"htComments"),document.getElementsByTagName("body")[0].appendChild(o)}return e=e||"",document.querySelector(".htCommentTextArea").value=e,o},u=function(o){if(-1!=o.target.className.indexOf("htCommentCell")){a();var n=e.view.wt.wtTable.getCoords(o.target),i={from:new h(n.row,n.col)};t.Comments.showComment(i)}else"htCommentTextArea"!=o.target.className&&r()};return{init:function(){o.addEventListener(document,"mouseover",t.helper.proxy(u))},showComment:function(t){var o=e.getCellMeta(t.from.row,t.from.col),n="";o.comment&&(n=o.comment);var i=c(n);i.style.display="block",l(t,i)},removeComment:function(t,o){e.removeCellMeta(t,o,"comment"),e.render()},checkSelectionCommentsConsistency:function(){var t=!1,o=e.getSelectedRange().from;return e.getCellMeta(o.row,o.col).comment&&(t=!0),t}}}function r(t){var o,n=function(){e.localStorage[t+"__persistentStateKeys"]=JSON.stringify(o)},i=function(){var n=e.localStorage[t+"__persistentStateKeys"],i="string"==typeof n?JSON.parse(n):void 0;o=i?i:[]},r=function(){o=[],n()};i(),this.saveValue=function(i,r){e.localStorage[t+"_"+i]=JSON.stringify(r),-1==o.indexOf(i)&&(o.push(i),n())},this.loadValue=function(o,n){o="undefined"!=typeof o?o:n;var i=e.localStorage[t+"_"+o];return"undefined"==typeof i?void 0:JSON.parse(i)},this.reset=function(o){e.localStorage.removeItem(t+"_"+o)},this.resetAll=function(){for(var n=0;n<o.length;n++)e.localStorage.removeItem(t+"_"+o[n]);r()}}function s(){this.boundaries=null,this.callback=null}function a(){var e=[];return e.getInfo=function(e,t){for(var o=0,n=this.length;n>o;o++)if(this[o].row<=e&&this[o].row+this[o].rowspan-1>=e&&this[o].col<=t&&this[o].col+this[o].colspan-1>=t)return this[o]},e.setInfo=function(e){for(var t=0,o=this.length;o>t;t++)if(this[t].row===e.row&&this[t].col===e.col)return void(this[t]=e);this.push(e)},e.removeInfo=function(e,t){for(var o=0,n=this.length;n>o;o++)if(this[o].row===e&&this[o].col===t){this.splice(o,1);break}},e}function l(e){if(this.mergedCellInfoCollection=new a,Array.isArray(e))for(var t=0,o=e.length;o>t;t++)this.mergedCellInfoCollection.setInfo(e[t])}function c(){}function u(e,o){var n,i=function(){this.selectionHandles={topLeft:document.createElement("DIV"),topLeftHitArea:document.createElement("DIV"),bottomRight:document.createElement("DIV"),bottomRightHitArea:document.createElement("DIV")};var e=10,t=40;this.selectionHandles.topLeft.className="topLeftSelectionHandle",this.selectionHandles.topLeftHitArea.className="topLeftSelectionHandle-HitArea",this.selectionHandles.bottomRight.className="bottomRightSelectionHandle",this.selectionHandles.bottomRightHitArea.className="bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={topLeft:this.selectionHandles.topLeft.style,topLeftHitArea:this.selectionHandles.topLeftHitArea.style,bottomRight:this.selectionHandles.bottomRight.style,bottomRightHitArea:this.selectionHandles.bottomRightHitArea.style};var o={position:"absolute",height:t+"px",width:t+"px","border-radius":parseInt(t/1.5,10)+"px"};for(var n in o)o.hasOwnProperty(n)&&(this.selectionHandles.styles.bottomRightHitArea[n]=o[n],this.selectionHandles.styles.topLeftHitArea[n]=o[n]);var i={position:"absolute",height:e+"px",width:e+"px","border-radius":parseInt(e/1.5,10)+"px",background:"#F5F5FF",border:"1px solid #4285c8"};for(var n in i)i.hasOwnProperty(n)&&(this.selectionHandles.styles.bottomRight[n]=i[n],this.selectionHandles.styles.topLeft[n]=i[n]);this.main.appendChild(this.selectionHandles.topLeft),this.main.appendChild(this.selectionHandles.bottomRight),this.main.appendChild(this.selectionHandles.topLeftHitArea),this.main.appendChild(this.selectionHandles.bottomRightHitArea)};if(o){var r=t.eventManager(e);this.instance=e,this.settings=o,this.main=document.createElement("div"),n=this.main.style,n.position="absolute",n.top=0,n.left=0;for(var s=["top","left","bottom","right","corner"],a=0;5>a;a++){var l=s[a],c=document.createElement("DIV");c.className="wtBorder "+(this.settings.className||""),this.settings[l]&&this.settings[l].hide&&(c.className+=" hidden"),n=c.style,n.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:o.border.color,n.height=this.settings[l]&&this.settings[l].width?this.settings[l].width+"px":o.border.width+"px",n.width=this.settings[l]&&this.settings[l].width?this.settings[l].width+"px":o.border.width+"px",this.main.appendChild(c)}this.top=this.main.childNodes[0],this.left=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.right=this.main.childNodes[3],this.topStyle=this.top.style,this.leftStyle=this.left.style,this.bottomStyle=this.bottom.style,this.rightStyle=this.right.style,this.cornerDefaultStyle={width:"5px",height:"5px",borderWidth:"2px",borderStyle:"solid",borderColor:"#FFF"},this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),t.mobileBrowser&&i.call(this),this.disappear(),e.wtTable.bordersHolder||(e.wtTable.bordersHolder=document.createElement("div"),e.wtTable.bordersHolder.className="htBorders",e.wtTable.hider.appendChild(e.wtTable.bordersHolder)),e.wtTable.bordersHolder.insertBefore(this.main,e.wtTable.bordersHolder.firstChild);var u=!1;r.addEventListener(document.body,"mousedown",function(){u=!0}),r.addEventListener(document.body,"mouseup",function(){u=!1});for(var h=0,d=this.main.childNodes.length;d>h;h++)r.addEventListener(this.main.childNodes[h],"mouseenter",function(t){if(u&&e.getSetting("hideBorderOnMouseDownOver")){t.preventDefault(),t.stopImmediatePropagation();var o=this.getBoundingClientRect();this.style.display="none";var n=function(e){return e.clientY<Math.floor(o.top)?!0:e.clientY>Math.ceil(o.top+o.height)?!0:e.clientX<Math.floor(o.left)?!0:e.clientX>Math.ceil(o.left+o.width)?!0:void 0},i=function(e){n(e)&&(r.removeEventListener(document.body,"mousemove",i),this.style.display="block")};r.addEventListener(document.body,"mousemove",i)}})}}function h(e,t){"undefined"!=typeof e&&"undefined"!=typeof t?(this.row=e,this.col=t):(this.row=null,this.col=null)}function d(e,t,o){this.highlight=e,this.from=t,this.to=o}function f(e,t,o){this.offset=e,this.total=t,this.countTH=o}function p(e,t,o,n){var i,r=0;for(this.instance=e,this.containerSizeFn=t,this.cellSizesSum=0,this.cellSizes=[],this.cellStretch=[],this.cellCount=0,this.visibleCellCount=0,this.remainingSize=0,this.strategy=n;;){if(i=o(r),void 0===i)break;this.cellSizesSum<this.getContainerSize()&&this.visibleCellCount++,this.cellSizes.push(i),this.cellSizesSum+=i,this.cellCount++,r++}var s=this.getContainerSize();this.remainingSize=this.cellSizesSum-s}function m(e){var o=[];if(this.guid="wt_"+v(),e.cloneSource?(this.cloneSource=e.cloneSource,this.cloneOverlay=e.cloneOverlay,this.wtSettings=e.cloneSource.wtSettings,this.wtTable=new k(this,e.table),this.wtScroll=new y(this),this.wtViewport=e.cloneSource.wtViewport,this.wtEvent=new w(this),this.selections=this.cloneSource.selections):(this.wtSettings=new D(this,e),this.wtTable=new k(this,e.table),this.wtScroll=new y(this),this.wtViewport=new H(this),this.wtEvent=new w(this),this.selections=this.getSetting("selections"),this.wtScrollbars=new E(this)),this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var n=0,i=this.wtTable.THEAD.childNodes[0].childNodes.length;i>n;n++)o.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.getSetting("columnHeaders").length||this.update("columnHeaders",[function(e,n){t.Dom.fastInnerText(n,o[e])}])}this.drawn=!1,this.drawInterrupted=!1}function g(e){this.instance=e,this.init(),this.clone=this.makeClone("debug"),this.clone.wtTable.holder.style.opacity=.4,this.clone.wtTable.holder.style.textShadow="0 0 2px #ff0000",this.lastTimeout=null,t.Dom.addClass(this.clone.wtTable.holder.parentNode,"wtDebugVisible")}function w(o){var n=this,i=t.eventManager(o);this.instance=o;var r=[null,null];this.dblClickTimeout=[null,null];var s,a,l=function(e){var o=n.parentCell(e.target);t.Dom.hasClass(e.target,"corner")?n.instance.getSetting("onCellCornerMouseDown",e,e.target):o.TD&&n.instance.hasSetting("onCellMouseDown")&&n.instance.getSetting("onCellMouseDown",e,o.coords,o.TD,n.instance),2!==e.button&&o.TD&&(r[0]=o.TD,clearTimeout(n.dblClickTimeout[0]),n.dblClickTimeout[0]=setTimeout(function(){r[0]=null},1e3))},c=function(e){n.instance.touchMoving=!0},u=function(e){i.addEventListener(this,"touchmove",c),n.checkIfTouchMove=setTimeout(function(){return n.instance.touchMoving===!0?(n.instance.touchMoving=void 0,void i.removeEventListener("touchmove",c,!1)):void l(e)},30)},h=function(e){if(n.instance.hasSetting("onCellMouseOver")){var o=n.instance.wtTable.TABLE,i=t.Dom.closest(e.target,["TD","TH"],o);i&&i!==a&&t.Dom.isChildOf(i,o)&&(a=i,n.instance.getSetting("onCellMouseOver",e,n.instance.wtTable.getCoords(i),i,n.instance))}},d=function(e){if(2!==e.button){var o=n.parentCell(e.target);o.TD===r[0]&&o.TD===r[1]?(t.Dom.hasClass(e.target,"corner")?n.instance.getSetting("onCellCornerDblClick",e,o.coords,o.TD,n.instance):n.instance.getSetting("onCellDblClick",e,o.coords,o.TD,n.instance),r[0]=null,r[1]=null):o.TD===r[0]&&(r[1]=o.TD,clearTimeout(n.dblClickTimeout[1]),n.dblClickTimeout[1]=setTimeout(function(){r[1]=null},500))}},f=function(e){clearTimeout(s),e.preventDefault(),d(e)};if(i.addEventListener(this.instance.wtTable.holder,"mousedown",l),i.addEventListener(this.instance.wtTable.TABLE,"mouseover",h),i.addEventListener(this.instance.wtTable.holder,"mouseup",d),this.instance.wtTable.holder.parentNode.parentNode&&t.mobileBrowser){var p="."+this.instance.wtTable.holder.parentNode.className.split(" ").join(".");i.addEventListener(this.instance.wtTable.holder.parentNode.parentNode,"touchstart",function(e){n.instance.touchApplied=!0,t.Dom.isChildOf(e.target,p)&&u.call(e.target,e)}),i.addEventListener(this.instance.wtTable.holder.parentNode.parentNode,"touchend",function(e){n.instance.touchApplied=!1,t.Dom.isChildOf(e.target,p)&&f.call(e.target,e)}),n.instance.momentumScrolling||(n.instance.momentumScrolling={}),i.addEventListener(this.instance.wtTable.holder.parentNode.parentNode,"scroll",function(e){clearTimeout(n.instance.momentumScrolling._timeout),n.instance.momentumScrolling.ongoing||n.instance.getSetting("onBeforeTouchScroll"),n.instance.momentumScrolling.ongoing=!0,n.instance.momentumScrolling._timeout=setTimeout(function(){n.instance.touchApplied||(n.instance.momentumScrolling.ongoing=!1,n.instance.getSetting("onAfterMomentumScroll"))},200)})}i.addEventListener(e,"resize",function(){n.instance.draw()}),this.destroy=function(){clearTimeout(this.dblClickTimeout[0]),clearTimeout(this.dblClickTimeout[1]),i.clear()}}function v(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+e()+e()}function C(e,t,o){this.offset=e,this.total=t,this.countTH=o}function y(e){this.instance=e}function b(e){this.instance=e,this.type="corner",this.init(),this.clone=this.makeClone("corner")}function R(e){this.instance=e,this.type="horizontal",this.offset=0,this.init(),this.clone=this.makeClone("left")}function S(e){this.instance=e,this.type="vertical",this.init(),this.clone=this.makeClone("top")}function E(e){this.instance=e,e.update("scrollbarWidth",t.Dom.getScrollbarWidth()),e.update("scrollbarHeight",t.Dom.getScrollbarWidth()),this.vertical=new S(e),this.horizontal=new R(e),this.corner=new b(e),e.getSetting("debug")&&(this.debug=new g(e)),this.registerListeners()}function T(e,t){this.settings=e,this.cellRange=t||null,this.instanceBorders={}}function D(e,o){var n=this;this.instance=e,this.defaults={table:void 0,debug:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,data:void 0,fixedColumnsLeft:0,fixedRowsTop:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:function(e,o,i){var r=n.getSetting("data",e,o);t.Dom.fastInnerText(i,void 0===r||null===r?"":r)},columnWidth:function(e){},rowHeight:function(e){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellMouseOver:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,scrollbarWidth:10,scrollbarHeight:10,renderAllRows:!1,groups:!1},this.settings={};for(var i in this.defaults)if(this.defaults.hasOwnProperty(i))if(void 0!==o[i])this.settings[i]=o[i];else{if(void 0===this.defaults[i])throw new Error('A required setting "'+i+'" was not provided');this.settings[i]=this.defaults[i]}}function k(e,o){this.instance=e,this.TABLE=o,t.Dom.removeTextNodes(this.TABLE);var n=this.TABLE.parentNode;if(!n||1!==n.nodeType||!t.Dom.hasClass(n,"wtHolder")){var i=document.createElement("DIV");i.className="wtSpreader",n&&n.insertBefore(i,this.TABLE),i.appendChild(this.TABLE)}if(this.spreader=this.TABLE.parentNode,n=this.spreader.parentNode,!n||1!==n.nodeType||!t.Dom.hasClass(n,"wtHolder")){var r=document.createElement("DIV");r.className="wtHider",n&&n.insertBefore(r,this.spreader),r.appendChild(this.spreader)}if(this.hider=this.spreader.parentNode,this.hiderStyle=this.hider.style,this.hiderStyle.position="relative",n=this.hider.parentNode,!n||1!==n.nodeType||!t.Dom.hasClass(n,"wtHolder")){var s=document.createElement("DIV");s.style.position="relative",s.className="wtHolder",e.cloneSource||(s.className+=" ht_master"),n&&n.insertBefore(s,this.hider),s.appendChild(this.hider)}if(this.holder=this.hider.parentNode,this.isWorkingOnClone()||(this.holder.parentNode.style.position="relative"),this.TBODY=this.TABLE.getElementsByTagName("TBODY")[0],this.TBODY||(this.TBODY=document.createElement("TBODY"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.getElementsByTagName("THEAD")[0],this.THEAD||(this.THEAD=document.createElement("THEAD"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.getElementsByTagName("COLGROUP")[0],this.COLGROUP||(this.COLGROUP=document.createElement("COLGROUP"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD)),this.instance.getSetting("columnHeaders").length&&!this.THEAD.childNodes.length){var a=document.createElement("TR");this.THEAD.appendChild(a)}this.colgroupChildrenLength=this.COLGROUP.childNodes.length,this.theadChildrenLength=this.THEAD.firstChild?this.THEAD.firstChild.childNodes.length:0,this.tbodyChildrenLength=this.TBODY.childNodes.length,this.rowFilter=null,this.columnFilter=null}function A(e){this.wtTable=e,this.instance=e.instance,this.rowFilter=e.rowFilter,this.columnFilter=e.columnFilter,this.TABLE=e.TABLE,this.THEAD=e.THEAD,this.TBODY=e.TBODY,this.COLGROUP=e.COLGROUP,this.utils=A.utils}function H(o){this.instance=o,this.oversizedRows=[],this.oversizedCols=[],this.oversizedColumnHeaders=[];var n=this,i=t.eventManager(o);i.addEventListener(e,"resize",function(){n.clientHeight=n.getWorkspaceHeight()})}function x(e,t,o,n,i,r,s){function a(e,t){var n=0;if(d.stretchAllColumnsWidth[e]||(d.stretchAllColumnsWidth[e]=Math.round(t*d.stretchAllRatio)),d.stretchAllColumnsWidth.length===o&&d.needVerifyLastColumnWidth){d.needVerifyLastColumnWidth=!1;for(var i=0;i<d.stretchAllColumnsWidth.length;i++)n+=d.stretchAllColumnsWidth[i];n!=d.totalTargetWidth&&(d.stretchAllColumnsWidth[d.stretchAllColumnsWidth.length-1]+=d.totalTargetWidth-n)}return d.stretchAllColumnsWidth[e]}function l(e,t){return e===o-1?d.stretchLastWidth:null}var c,u,h,d=this,f=1,p=0,m=!0,g=50,w=[];for(this.scrollOffset=t,this.startColumn=null,this.endColumn=null,this.startPosition=null,this.count=0,this.stretchAllRatio=0,this.stretchLastWidth=0,this.stretch=s,this.totalTargetWidth=0,this.needVerifyLastColumnWidth=!0,this.stretchAllColumnsWidth=[],c=function(e){var t=n(e);return f=f||1,void 0===t&&(t=g),t},this.refreshStretching=function(e){for(var t,n,i=0,r=0;o>r;r++)t=c(r),i+=t;this.totalTargetWidth=e,n=i-e,"all"===this.stretch&&0>n?(this.stretchAllRatio=e/i,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0):"last"===this.stretch&&e!==1/0&&(this.stretchLastWidth=-n+c(o-1))},this.getStretchedColumnWidth=function(e,t){var o=null;return"all"===this.stretch&&0!==this.stretchAllRatio?o=a(e,t):"last"===this.stretch&&0!==this.stretchLastWidth&&(o=l(e,t)),o},h=0;o>h;h++)if(u=c(h),t>=p&&!r&&(this.startColumn=h),p>=t&&t+e>=p+u&&(null==this.startColumn&&(this.startColumn=h),this.endColumn=h),w.push(p),p+=u,r||(this.endColumn=h),p>=t+e){m=!1;break}if(this.endColumn==o-1&&m)for(this.startColumn=this.endColumn;this.startColumn>0;){var v=w[this.endColumn]+u-w[this.startColumn-1];if((e>=v||!r)&&this.startColumn--,v>e)break}null!==this.startColumn&&i&&i(this),this.startPosition=w[this.startColumn],void 0==this.startPosition&&(this.startPosition=null),null!=this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}function O(e,t,o,n,i,r){this.scrollOffset=t,this.startRow=null,this.startPosition=null,this.endRow=null,this.count=0;for(var s,a=0,l=!0,c=23,u=[],h=0;o>h;h++)if(s=n(h),void 0===s&&(s=c),t>=a&&!r&&(this.startRow=h),a>=t&&t+e>=a+s&&(null==this.startRow&&(this.startRow=h),this.endRow=h),u.push(a),a+=s,r||(this.endRow=h),a>=t+e){l=!1;break}if(this.endRow==o-1&&l)for(this.startRow=this.endRow;this.startRow>0;){var d=u[this.endRow]+s-u[this.startRow-1];if((e>=d||!r)&&this.startRow--,d>=e)break}null!==this.startRow&&i&&i(this),this.startPosition=u[this.startRow],void 0==this.startPosition&&(this.startPosition=null),null!=this.startRow&&(this.count=this.endRow-this.startRow+1)}Array.prototype.indexOf||(Array.prototype.indexOf=function(e){var t=this.length>>>0,o=Number(arguments[1])||0;for(o=0>o?Math.ceil(o):Math.floor(o),0>o&&(o+=t);t>o;o++)if(o in this&&this[o]===e)return o;return-1}),Array.prototype.filter||(Array.prototype.filter=function(e,t){function o(e){return/NodeList/i.test(e.item)}function n(e){for(var t=[],o=0,n=e.length;n>o;o++)t[o]=e[o];return t}if("undefined"==typeof this||null===this)throw new TypeError;if("function"!=typeof e)throw new TypeError;t=t||this,o(t)&&(t=n(t));var i,r,s=t.length,a=[];for(i=0;s>i;i+=1)t.hasOwnProperty(i)&&(r=t[i],e.call(t,r,i,t)&&a.push(r));return a}),Array.isArray||(Array.isArray=function(e){return"[object Array]"==toString.call(e)}),Object.keys||(Object.keys=function(){var e=Object.prototype.hasOwnProperty,t=!{toString:null}.propertyIsEnumerable("toString"),o=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],n=o.length;return function(i){if("object"!=typeof i&&("function"!=typeof i||null===i))throw new TypeError("Object.keys called on non-object");var r,s,a=[];for(r in i)e.call(i,r)&&a.push(r);if(t)for(s=0;n>s;s++)e.call(i,o[s])&&a.push(o[s]);return a}}()),/*
 * Copyright 2012 The Polymer Authors. All rights reserved.
 * Use of this source code is governed by a BSD-style
 * license that can be found in the LICENSE file.
 */
"undefined"==typeof WeakMap&&!function(){var t=Object.defineProperty;try{var o=!0;t(function(){},"foo",{})}catch(n){o=!1}var i=+new Date%1e9,r=function(){this.name="__st"+(1e9*Math.random()>>>0)+(i++ +"__"),o||(this._wmCache=[])};o?r.prototype={set:function(e,o){var n=e[this.name];n&&n[0]===e?n[1]=o:t(e,this.name,{value:[e,o],writable:!0})},get:function(e){var t;return(t=e[this.name])&&t[0]===e?t[1]:void 0},"delete":function(e){this.set(e,void 0)}}:r.prototype={set:function(e,t){if("undefined"!=typeof e&&"undefined"!=typeof t){for(var o=0,n=this._wmCache.length;n>o;o++)if(this._wmCache[o].key==e)return void(this._wmCache[o].value=t);this._wmCache.push({key:e,value:t})}},get:function(e){if("undefined"!=typeof e)for(var t=0,o=this._wmCache.length;o>t;t++)if(this._wmCache[t].key==e)return this._wmCache[t].value},"delete":function(e){if("undefined"!=typeof e)for(var t=0,o=this._wmCache.length;o>t;t++)this._wmCache[t].key==e&&Array.prototype.slice.call(this._wmCache,t,1)}},e.WeakMap=r}(),t.activeGuid=null,t.Core=function(e,o){function n(){var e=!1;return{validatorsInQueue:0,addValidatorToQueue:function(){this.validatorsInQueue++,e=!1},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty:function(){},checkIfQueueIsEmpty:function(){0==this.validatorsInQueue&&0==e&&(e=!0,this.onQueueEmpty())}}}function i(e,o,i){function r(){var n;e.length&&(n=t.hooks.run(v,"beforeChange",e,o),"function"==typeof n?console.warn("Your beforeChange callback returns a function. It's not supported since Handsontable 0.12.1 (and the returned function will not be executed)."):n===!1&&e.splice(0,e.length)),i()}var s=new n;s.onQueueEmpty=r;for(var a=e.length-1;a>=0;a--)if(null===e[a])e.splice(a,1);else{var l=e[a][0],c=p.propToCol(e[a][1]),u=v.runHooks("modifyCol",c),h=v.getCellMeta(l,u);if("numeric"===h.type&&"string"==typeof e[a][3]&&e[a][3].length>0&&(/^-?[\d\s]*(\.|\,)?\d*$/.test(e[a][3])||h.format)){var d=e[a][3].length;"undefined"==typeof h.language?numeral.language("en"):e[a][3].indexOf(".")===d-3&&-1===e[a][3].indexOf(",")?numeral.language("en"):numeral.language(h.language),numeral.validate(e[a][3])&&(e[a][3]=numeral().unformat(e[a][3]))}v.getCellValidator(h)&&(s.addValidatorToQueue(),v.validateCell(e[a][3],h,function(t,o){return function(n){if("boolean"!=typeof n)throw new Error("Validation error: result is not boolean");n===!1&&o.allowInvalid===!1&&(e.splice(t,1),o.valid=!0,--t),s.removeValidatorFormQueue()}}(a,h),o))}s.checkIfQueueIsEmpty()}function r(e,o){var n=e.length-1;if(!(0>n)){for(;n>=0;n--)if(null!==e[n]){if(null!=e[n][2]||null!=e[n][3]){if(f.settings.allowInsertRow)for(;e[n][0]>v.countRows()-1;)p.createRow();if("array"===v.dataType&&f.settings.allowInsertColumn)for(;p.propToCol(e[n][1])>v.countCols()-1;)p.createCol();p.set(e[n][0],e[n][1],e[n][3])}}else e.splice(n,1);v.forceFullRender=!0,m.adjustRowsAndCols(),t.hooks.run(v,"beforeChangeRender",e,o),g.refreshBorders(null,!0),t.hooks.run(v,"afterChange",e,o||"edit")}}function s(e,t,o){return"object"==typeof e?e:[[e,t,o]]}function a(e){if(e.hasOwnProperty("type")){var o,n={};if("object"==typeof e.type)o=e.type;else if("string"==typeof e.type&&(o=t.cellTypes[e.type],void 0===o))throw new Error('You declared cell type "'+e.type+'" as a string that is not mapped to a known object. Cell type must be an object or a string mapped to an object in Handsontable.cellTypes');for(var i in o)o.hasOwnProperty(i)&&!e.hasOwnProperty(i)&&(n[i]=o[i]);return n}}function l(e){return t.hooks.run(v,"modifyRow",e)}function c(e){return t.hooks.run(v,"modifyCol",e)}function u(){throw new Error("This method cannot be called because this Handsontable instance has been destroyed")}var f,p,m,g,w,v=this,C=function(){},y=t.eventManager(v);t.helper.extend(C.prototype,P.prototype),t.helper.extend(C.prototype,o),t.helper.extend(C.prototype,a(o)),this.rootElement=e,this.isHotTableEnv=t.Dom.isChildOfWebComponentTable(this.rootElement),t.eventManager.isHotTableEnv=this.isHotTableEnv,this.container=document.createElement("DIV"),this.container.className="htContainer",e.insertBefore(this.container,e.firstChild),this.guid="ht_"+t.helper.randomString(),this.rootElement.id&&"ht_"!==this.rootElement.id.substring(0,3)||(this.rootElement.id=this.guid),f={cellSettings:[],columnSettings:[],columnsSettingConflicts:["data","width"],settings:new C,selRange:null,isPopulated:null,scrollable:null,firstRun:!0},m={alter:function(e,t,o,n,i){var r;switch(o=o||1,e){case"insert_row":r=p.createRow(t,o),r&&(g.isSelected()&&f.selRange.from.row>=t?(f.selRange.from.row=f.selRange.from.row+r,g.transformEnd(r,0)):g.refreshBorders());break;case"insert_col":if(r=p.createCol(t,o)){if(Array.isArray(v.getSettings().colHeaders)){var s=[t,0];s.length+=r,Array.prototype.splice.apply(v.getSettings().colHeaders,s)}g.isSelected()&&f.selRange.from.col>=t?(f.selRange.from.col=f.selRange.from.col+r,g.transformEnd(0,r)):g.refreshBorders()}break;case"remove_row":t=v.runHooks("modifyCol",t),p.removeRow(t,o),f.cellSettings.splice(t,o);var a=v.getSettings().fixedRowsTop;a>=t+1&&(v.getSettings().fixedRowsTop-=Math.min(o,a-t)),m.adjustRowsAndCols(),g.refreshBorders();break;case"remove_col":p.removeCol(t,o);for(var l=0,c=p.getAll().length;c>l;l++)l in f.cellSettings&&f.cellSettings[l].splice(t,o);var u=v.getSettings().fixedColumnsLeft;u>=t+1&&(v.getSettings().fixedColumnsLeft-=Math.min(o,u-t)),Array.isArray(v.getSettings().colHeaders)&&("undefined"==typeof t&&(t=-1),v.getSettings().colHeaders.splice(t,o)),m.adjustRowsAndCols(),g.refreshBorders();break;default:throw new Error('There is no such action "'+e+'"')}i||m.adjustRowsAndCols()},adjustRowsAndCols:function(){var e,t,o,n;if(t=v.countRows(),t<f.settings.minRows)for(e=0;e<f.settings.minRows-t;e++)p.createRow(v.countRows(),1,!0);if(o=v.countEmptyRows(!0),o<f.settings.minSpareRows)for(;o<f.settings.minSpareRows&&v.countRows()<f.settings.maxRows;o++)p.createRow(v.countRows(),1,!0);if(n=v.countEmptyCols(!0),!f.settings.columns&&v.countCols()<f.settings.minCols)for(;v.countCols()<f.settings.minCols;n++)p.createCol(v.countCols(),1,!0);if(!f.settings.columns&&"array"===v.dataType&&n<f.settings.minSpareCols)for(;n<f.settings.minSpareCols&&v.countCols()<f.settings.maxCols;n++)p.createCol(v.countCols(),1,!0);var i=v.countRows(),r=v.countCols();if((0===i||0===r)&&g.deselect(),g.isSelected()){var s,a=f.selRange.from.row,l=f.selRange.from.col,c=f.selRange.to.row,u=f.selRange.to.col;a>i-1?(a=i-1,s=!0,c>a&&(c=a)):c>i-1&&(c=i-1,s=!0,a>c&&(a=c)),l>r-1?(l=r-1,s=!0,u>l&&(u=l)):u>r-1&&(u=r-1,s=!0,l>u&&(l=u)),s&&v.selectCell(a,l,c,u)}},populateFromArray:function(e,o,n,i,r,s,a){var l,c,u,h,d=[],p={};if(c=o.length,0===c)return!1;var m,g,w,C;switch(r){case"shift_down":for(m=n?n.col-e.col+1:0,g=n?n.row-e.row+1:0,o=t.helper.translateRowsToColumns(o),u=0,h=o.length,w=Math.max(h,m);w>u;u++)if(h>u){for(l=0,c=o[u].length;g-c>l;l++)o[u].push(o[u][l%c]);o[u].unshift(e.col+u,e.row,0),v.spliceCol.apply(v,o[u])}else o[u%h][0]=e.col+u,v.spliceCol.apply(v,o[u%h]);break;case"shift_right":for(m=n?n.col-e.col+1:0,g=n?n.row-e.row+1:0,l=0,c=o.length,C=Math.max(c,g);C>l;l++)if(c>l){for(u=0,h=o[l].length;m-h>u;u++)o[l].push(o[l][u%h]);o[l].unshift(e.row+l,e.col,0),v.spliceRow.apply(v,o[l])}else o[l%c][0]=e.row+l,v.spliceRow.apply(v,o[l%c]);break;case"overwrite":default:p.row=e.row,p.col=e.col;var y={row:0,col:0},b={row:n&&e?n.row-e.row+1:1,col:n&&e?n.col-e.col+1:1};for(-1!==["up","left"].indexOf(s)?y={row:Math.ceil(b.row/c)||1,col:Math.ceil(b.col/o[0].length)||1}:-1!==["down","right"].indexOf(s)&&(y={row:1,col:1}),l=0;c>l&&!(n&&p.row>n.row||!f.settings.allowInsertRow&&p.row>v.countRows()-1||p.row>=f.settings.maxRows);l++){for(p.col=e.col,h=o[l]?o[l].length:0,u=0;h>u&&!(n&&p.col>n.col||!f.settings.allowInsertColumn&&p.col>v.countCols()-1||p.col>=f.settings.maxCols);u++){if(!v.getCellMeta(p.row,p.col).readOnly){var R,S=o[l][u],E={row:l,col:u};"autofill"===i&&(R=v.runHooks("beforeAutofillInsidePopulate",E,s,o,a,y,b),R&&(y="undefined"!=typeof R.iterators?R.iterators:y,S="undefined"!=typeof R.value?R.value:S)),d.push([p.row,p.col,S])}p.col++,n&&u===h-1&&(u=-1,-1!==["down","right"].indexOf(s)?y.col++:-1!==["up","left"].indexOf(s)&&y.col>1&&y.col--)}p.row++,y.col=1,n&&l===c-1&&(l=-1,-1!==["down","right"].indexOf(s)?y.row++:-1!==["up","left"].indexOf(s)&&y.row>1&&y.row--)}v.setDataAtCell(d,null,null,i||"populateFromArray")}}},this.selection=g={inProgress:!1,selectedHeader:{cols:!1,rows:!1},setSelectedHeaders:function(e,t){v.selection.selectedHeader.rows=e,v.selection.selectedHeader.cols=t},begin:function(){v.selection.inProgress=!0},finish:function(){var e=v.getSelected();t.hooks.run(v,"afterSelectionEnd",e[0],e[1],e[2],e[3]),t.hooks.run(v,"afterSelectionEndByProp",e[0],v.colToProp(e[1]),e[2],v.colToProp(e[3])),v.selection.inProgress=!1},isInProgress:function(){return v.selection.inProgress},setRangeStart:function(e,o){t.hooks.run(v,"beforeSetRangeStart",e),f.selRange=new d(e,e,e),g.setRangeEnd(e,null,o)},setRangeEnd:function(e,o,n){t.hooks.run(v,"beforeSetRangeEnd",e),v.selection.begin(),f.selRange.to=new h(e.row,e.col),f.settings.multiSelect||(f.selRange.from=e),v.view.wt.selections.current.clear(),v.view.wt.selections.current.add(f.selRange.highlight),v.view.wt.selections.area.clear(),g.isMultiple()&&(v.view.wt.selections.area.add(f.selRange.from),v.view.wt.selections.area.add(f.selRange.to)),(f.settings.currentRowClassName||f.settings.currentColClassName)&&(v.view.wt.selections.highlight.clear(),v.view.wt.selections.highlight.add(f.selRange.from),v.view.wt.selections.highlight.add(f.selRange.to)),t.hooks.run(v,"afterSelection",f.selRange.from.row,f.selRange.from.col,f.selRange.to.row,f.selRange.to.col),t.hooks.run(v,"afterSelectionByProp",f.selRange.from.row,p.colToProp(f.selRange.from.col),f.selRange.to.row,p.colToProp(f.selRange.to.col)),o!==!1&&v.view.mainViewIsActive()&&(f.selRange.from&&!g.isMultiple()?v.view.scrollViewport(f.selRange.from):v.view.scrollViewport(e)),g.refreshBorders(null,n)},refreshBorders:function(e,t){t||w.destroyEditor(e),v.view.render(),g.isSelected()&&!t&&w.prepareEditor()},isMultiple:function(){var e=!(f.selRange.to.col===f.selRange.from.col&&f.selRange.to.row===f.selRange.from.row),o=t.hooks.run(v,"afterIsMultipleSelection",e);return e?o:void 0},transformStart:function(e,t,o,n){var i=new h(e,t);v.runHooks("modifyTransformStart",i),f.selRange.highlight.row+e>v.countRows()-1?o&&f.settings.minSpareRows>0?v.alter("insert_row",v.countRows()):f.settings.autoWrapCol&&(i.row=1-v.countRows(),i.col=f.selRange.highlight.col+i.col==v.countCols()-1?1-v.countCols():1):f.settings.autoWrapCol&&f.selRange.highlight.row+i.row<0&&f.selRange.highlight.col+i.col>=0&&(i.row=v.countRows()-1,i.col=f.selRange.highlight.col+i.col==0?v.countCols()-1:-1),f.selRange.highlight.col+i.col>v.countCols()-1?o&&f.settings.minSpareCols>0?v.alter("insert_col",v.countCols()):f.settings.autoWrapRow&&(i.row=f.selRange.highlight.row+i.row==v.countRows()-1?1-v.countRows():1,i.col=1-v.countCols()):f.settings.autoWrapRow&&f.selRange.highlight.col+i.col<0&&f.selRange.highlight.row+i.row>=0&&(i.row=f.selRange.highlight.row+i.row==0?v.countRows()-1:-1,i.col=v.countCols()-1);var r=v.countRows(),s=v.countCols(),a=new h(f.selRange.highlight.row+i.row,f.selRange.highlight.col+i.col);a.row<0?a.row=0:a.row>0&&a.row>=r&&(a.row=r-1),a.col<0?a.col=0:a.col>0&&a.col>=s&&(a.col=s-1),g.setRangeStart(a,n)},transformEnd:function(e,t){var o=new h(e,t);v.runHooks("modifyTransformEnd",o);var n=v.countRows(),i=v.countCols(),r=new h(f.selRange.to.row+o.row,f.selRange.to.col+o.col);r.row<0?r.row=0:r.row>0&&r.row>=n&&(r.row=n-1),r.col<0?r.col=0:r.col>0&&r.col>=i&&(r.col=i-1),g.setRangeEnd(r,!0)},isSelected:function(){return null!==f.selRange},inInSelection:function(e){return g.isSelected()?f.selRange.includes(e):!1},deselect:function(){g.isSelected()&&(v.selection.inProgress=!1,f.selRange=null,v.view.wt.selections.current.clear(),v.view.wt.selections.area.clear(),(f.settings.currentRowClassName||f.settings.currentColClassName)&&v.view.wt.selections.highlight.clear(),w.destroyEditor(),g.refreshBorders(),t.hooks.run(v,"afterDeselect"))},selectAll:function(){f.settings.multiSelect&&(g.setRangeStart(new h(0,0)),g.setRangeEnd(new h(v.countRows()-1,v.countCols()-1),!1))},empty:function(){if(g.isSelected()){var e,t,o=f.selRange.getTopLeftCorner(),n=f.selRange.getBottomRightCorner(),i=[];for(e=o.row;e<=n.row;e++)for(t=o.col;t<=n.col;t++)v.getCellMeta(e,t).readOnly||i.push([e,t,""]);v.setDataAtCell(i)}}},this.init=function(){t.hooks.run(v,"beforeInit"),t.mobileBrowser&&t.Dom.addClass(v.rootElement,"mobile"),this.updateSettings(f.settings,!0),this.view=new t.TableView(this),w=new t.EditorManager(v,f,g,p),this.forceFullRender=!0,this.view.render(),"object"==typeof f.firstRun&&(t.hooks.run(v,"afterChange",f.firstRun[0],f.firstRun[1]),f.firstRun=!1),t.hooks.run(v,"afterInit")},this.validateCell=function(e,o,n,i){function r(e){var t=o.col,i=o.row,r=v.getCell(i,t,!0);r&&v.view.wt.wtSettings.settings.cellRenderer(i,t,r),n(e)}var s=v.getCellValidator(o);"[object RegExp]"===Object.prototype.toString.call(s)&&(s=function(e){return function(t,o){o(e.test(t))}}(s)),"function"==typeof s?(e=t.hooks.run(v,"beforeValidate",e,o.row,o.prop,i),v._registerTimeout(setTimeout(function(){s.call(o,e,function(n){n=t.hooks.run(v,"afterValidate",n,e,o.row,o.prop,i),o.valid=n,r(n),t.hooks.run(v,"postAfterValidate",n,e,o.row,o.prop,i)})},0))):(o.valid=!0,r(o.valid))},this.setDataAtCell=function(e,t,o,n){var a,l,c,u=s(e,t,o),h=[];for(a=0,l=u.length;l>a;a++){if("object"!=typeof u[a])throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if("number"!=typeof u[a][1])throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");c=p.colToProp(u[a][1]),h.push([u[a][0],c,p.get(u[a][0],c),u[a][2]])}n||"object"!=typeof e||(n=t),i(h,n,function(){r(h,n)})},this.setDataAtRowProp=function(e,t,o,n){var a,l,c=s(e,t,o),u=[];for(a=0,l=c.length;l>a;a++)u.push([c[a][0],c[a][1],p.get(c[a][0],c[a][1]),c[a][2]]);n||"object"!=typeof e||(n=t),i(u,n,function(){r(u,n)})},this.listen=function(){t.activeGuid=v.guid,document.activeElement&&document.activeElement!==document.body?document.activeElement.blur():document.activeElement||document.body.focus()},this.unlisten=function(){t.activeGuid=null},this.isListening=function(){return t.activeGuid===v.guid},this.destroyEditor=function(e){g.refreshBorders(e)},this.populateFromArray=function(e,t,o,n,i,r,s,a,l){var c;if("object"!=typeof o||"object"!=typeof o[0])throw new Error("populateFromArray parameter `input` must be an array of arrays");return c="number"==typeof n?new h(n,i):null,m.populateFromArray(new h(e,t),o,c,r,s,a,l)},this.spliceCol=function(e,t,o){return p.spliceCol.apply(p,arguments)},this.spliceRow=function(e,t,o){return p.spliceRow.apply(p,arguments)},this.getSelected=function(){return g.isSelected()?[f.selRange.from.row,f.selRange.from.col,f.selRange.to.row,f.selRange.to.col]:void 0},this.getSelectedRange=function(){return g.isSelected()?f.selRange:void 0},this.render=function(){v.view&&(v.forceFullRender=!0,g.refreshBorders(null,!0))},this.loadData=function(e){function o(){f.cellSettings.length=0}if("object"==typeof e&&null!==e)e.push&&e.splice||(e=[e]);else{if(null!==e)throw new Error("loadData only accepts array of objects or array of arrays ("+typeof e+" given)");e=[];for(var n,i=0,r=f.settings.startRows;r>i;i++){n=[];for(var s=0,a=f.settings.startCols;a>s;s++)n.push(null);e.push(n)}}f.isPopulated=!1,C.prototype.data=e,Array.isArray(f.settings.dataSchema)||Array.isArray(e[0])?v.dataType="array":"function"==typeof f.settings.dataSchema?v.dataType="function":v.dataType="object",p=new t.DataMap(v,f,C),o(),m.adjustRowsAndCols(),t.hooks.run(v,"afterLoadData"),f.firstRun?f.firstRun=[null,"loadData"]:(t.hooks.run(v,"afterChange",null,"loadData"),v.render()),f.isPopulated=!0},this.getData=function(e,t,o,n){return"undefined"==typeof e?p.getAll():p.getRange(new h(e,t),new h(o,n),p.DESTINATION_RENDERER)},this.getCopyableData=function(e,t,o,n){return p.getCopyableText(new h(e,t),new h(o,n))},this.updateSettings=function(e,o){var n,i;if("undefined"!=typeof e.rows)throw new Error("'rows' setting is no longer supported. do you mean startRows, minRows or maxRows?");if("undefined"!=typeof e.cols)throw new Error("'cols' setting is no longer supported. do you mean startCols, minCols or maxCols?");for(n in e)"data"!==n&&(void 0!==t.hooks.hooks[n]||void 0!==t.hooks.legacy[n]?("function"==typeof e[n]||Array.isArray(e[n]))&&v.addHook(n,e[n]):!o&&e.hasOwnProperty(n)&&(C.prototype[n]=e[n]));if(void 0===e.data&&void 0===f.settings.data?v.loadData(null):void 0!==e.data?v.loadData(e.data):void 0!==e.columns&&p.createMap(),i=v.countCols(),f.cellSettings.length=0,i>0){var r,s;for(n=0;i>n;n++)f.columnSettings[n]=t.helper.columnFactory(C,f.columnsSettingConflicts),r=f.columnSettings[n].prototype,C.prototype.columns&&(s=C.prototype.columns[n],t.helper.extend(r,s),t.helper.extend(r,a(s)))}if("undefined"!=typeof e.cell)for(n in e.cell){var l=e.cell[n];v.setCellMetaObject(l.row,l.col,l)}if(t.hooks.run(v,"afterCellMetaReset"),"undefined"!=typeof e.className&&(C.prototype.className&&t.Dom.removeClass(v.rootElement,C.prototype.className),e.className&&t.Dom.addClass(v.rootElement,e.className)),"undefined"!=typeof e.height){var c=e.height;"function"==typeof c&&(c=c()),v.rootElement.style.height=c+"px"}if("undefined"!=typeof e.width){var u=e.width;"function"==typeof u&&(u=u()),v.rootElement.style.width=u+"px"}c&&(v.rootElement.style.overflow="auto"),o||t.hooks.run(v,"afterUpdateSettings"),m.adjustRowsAndCols(),v.view&&!f.firstRun&&(v.forceFullRender=!0,g.refreshBorders(null,!0))},this.getValue=function(){var e=v.getSelected();if(C.prototype.getValue){if("function"==typeof C.prototype.getValue)return C.prototype.getValue.call(v);if(e)return v.getData()[e[0]][C.prototype.getValue]}else if(e)return v.getDataAtCell(e[0],e[1])},this.getSettings=function(){return f.settings},this.clear=function(){g.selectAll(),g.empty()},this.alter=function(e,t,o,n,i){m.alter(e,t,o,n,i)},this.getCell=function(e,t,o){return v.view.getCellAtCoords(new h(e,t),o)},this.getCoords=function(e){return this.view.wt.wtTable.getCoords.call(this.view.wt.wtTable,e)},this.colToProp=function(e){return p.colToProp(e)},this.propToCol=function(e){return p.propToCol(e)},this.getDataAtCell=function(e,t){return p.get(e,p.colToProp(t))},this.getDataAtRowProp=function(e,t){return p.get(e,t)},this.getDataAtCol=function(e){var t=[];return t.concat.apply(t,p.getRange(new h(0,e),new h(f.settings.data.length-1,e),p.DESTINATION_RENDERER))},this.getDataAtProp=function(e){var t,o=[];return t=p.getRange(new h(0,p.propToCol(e)),new h(f.settings.data.length-1,p.propToCol(e)),p.DESTINATION_RENDERER),o.concat.apply(o,t)},this.getSourceDataAtCol=function(e){for(var t=[],o=f.settings.data,n=0;n<o.length;n++)t.push(o[n][e]);return t},this.getSourceDataAtRow=function(e){return f.settings.data[e]},this.getDataAtRow=function(e){var t=p.getRange(new h(e,0),new h(e,this.countCols()-1),p.DESTINATION_RENDERER);return t[0]},this.removeCellMeta=function(e,t,o){var n=v.getCellMeta(e,t);void 0!=n[o]&&delete f.cellSettings[e][t][o]},this.setCellMetaObject=function(e,t,o){if("object"==typeof o)for(var n in o){var i=o[n];this.setCellMeta(e,t,n,i)}},this.setCellMeta=function(e,o,n,i){f.cellSettings[e]||(f.cellSettings[e]=[]),f.cellSettings[e][o]||(f.cellSettings[e][o]=new f.columnSettings[o]),f.cellSettings[e][o][n]=i,t.hooks.run(v,"afterSetCellMeta",e,o,n,i)},this.getCellMeta=function(e,o){var n,i=p.colToProp(o);if(e=l(e),o=c(o),f.columnSettings[o]||(f.columnSettings[o]=t.helper.columnFactory(C,f.columnsSettingConflicts)),f.cellSettings[e]||(f.cellSettings[e]=[]),f.cellSettings[e][o]||(f.cellSettings[e][o]=new f.columnSettings[o]),n=f.cellSettings[e][o],n.row=e,n.col=o,n.prop=i,n.instance=v,t.hooks.run(v,"beforeGetCellMeta",e,o,n),t.helper.extend(n,a(n)),n.cells){var r=n.cells.call(n,e,o,i);r&&(t.helper.extend(n,r),t.helper.extend(n,a(r)))}return t.hooks.run(v,"afterGetCellMeta",e,o,n),n};var b=t.helper.cellMethodLookupFactory("renderer");this.getCellRenderer=function(e,o){var n=b.call(this,e,o);return t.renderers.getRenderer(n)},this.getCellEditor=t.helper.cellMethodLookupFactory("editor"),this.getCellValidator=t.helper.cellMethodLookupFactory("validator"),this.validateCells=function(e){var t=new n;t.onQueueEmpty=e;for(var o=v.countRows()-1;o>=0;){for(var i=v.countCols()-1;i>=0;)t.addValidatorToQueue(),v.validateCell(v.getDataAtCell(o,i),v.getCellMeta(o,i),function(){t.removeValidatorFormQueue()},"validateCells"),i--;o--}t.checkIfQueueIsEmpty()},this.getRowHeader=function(e){if(void 0===e){for(var t=[],o=0,n=v.countRows();n>o;o++)t.push(v.getRowHeader(o));return t}return Array.isArray(f.settings.rowHeaders)&&void 0!==f.settings.rowHeaders[e]?f.settings.rowHeaders[e]:"function"==typeof f.settings.rowHeaders?f.settings.rowHeaders(e):f.settings.rowHeaders&&"string"!=typeof f.settings.rowHeaders&&"number"!=typeof f.settings.rowHeaders?e+1:f.settings.rowHeaders},this.hasRowHeaders=function(){return!!f.settings.rowHeaders},this.hasColHeaders=function(){if(void 0!==f.settings.colHeaders&&null!==f.settings.colHeaders)return!!f.settings.colHeaders;for(var e=0,t=v.countCols();t>e;e++)if(v.getColHeader(e))return!0;return!1},this.getColHeader=function(e){if(void 0===e){for(var o=[],n=0,i=v.countCols();i>n;n++)o.push(v.getColHeader(n));return o}var r=e;return e=t.hooks.run(v,"modifyCol",e),f.settings.columns&&f.settings.columns[e]&&f.settings.columns[e].title?f.settings.columns[e].title:Array.isArray(f.settings.colHeaders)&&void 0!==f.settings.colHeaders[e]?f.settings.colHeaders[e]:"function"==typeof f.settings.colHeaders?f.settings.colHeaders(e):f.settings.colHeaders&&"string"!=typeof f.settings.colHeaders&&"number"!=typeof f.settings.colHeaders?t.helper.spreadsheetColumnLabel(r):f.settings.colHeaders},this._getColWidthFromSettings=function(e){var t=v.getCellMeta(0,e),o=t.width;if((void 0===o||o===f.settings.width)&&(o=t.colWidths),void 0!==o&&null!==o){switch(typeof o){case"object":o=o[e];break;case"function":o=o(e)}"string"==typeof o&&(o=parseInt(o,10))}return o},this.getColWidth=function(e){var o=v._getColWidthFromSettings(e);return o||(o=50),o=t.hooks.run(v,"modifyColWidth",o,e)},this._getRowHeightFromSettings=function(e){var t=f.settings.rowHeights;if(void 0!==t&&null!==t){switch(typeof t){case"object":t=t[e];break;case"function":t=t(e)}"string"==typeof t&&(t=parseInt(t,10))}return t},this.getRowHeight=function(e){var o=v._getRowHeightFromSettings(e);return o=t.hooks.run(v,"modifyRowHeight",o,e)},this.countRows=function(){return f.settings.data.length},this.countCols=function(){return"object"===v.dataType||"function"===v.dataType?f.settings.columns&&f.settings.columns.length?f.settings.columns.length:p.colToPropCache.length:"array"===v.dataType?f.settings.columns&&f.settings.columns.length?f.settings.columns.length:f.settings.data&&f.settings.data[0]&&f.settings.data[0].length?f.settings.data[0].length:0:void 0},this.rowOffset=function(){return v.view.wt.wtTable.getFirstRenderedRow()},this.colOffset=function(){return v.view.wt.wtTable.getFirstRenderedColumn()},this.countRenderedRows=function(){return v.view.wt.drawn?v.view.wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return v.view.wt.drawn?v.view.wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return v.view.wt.drawn?v.view.wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return v.view.wt.drawn?v.view.wt.wtTable.getVisibleColumnsCount():-1},this.countEmptyRows=function(e){for(var o,n=v.countRows()-1,i=0;n>=0;){if(o=t.hooks.run(this,"modifyRow",n),v.isEmptyRow(o))i++;else if(e)break;n--}return i},this.countEmptyCols=function(e){if(v.countRows()<1)return 0;for(var t=v.countCols()-1,o=0;t>=0;){if(v.isEmptyCol(t))o++;else if(e)break;t--}return o},this.isEmptyRow=function(e){return f.settings.isEmptyRow.call(v,e)},this.isEmptyCol=function(e){return f.settings.isEmptyCol.call(v,e)},this.selectCell=function(e,t,o,n,i){if("number"!=typeof e||0>e||e>=v.countRows())return!1;if("number"!=typeof t||0>t||t>=v.countCols())return!1;if("undefined"!=typeof o){if("number"!=typeof o||0>o||o>=v.countRows())return!1;if("number"!=typeof n||0>n||n>=v.countCols())return!1}var r=new h(e,t);return f.selRange=new d(r,r,r),document.activeElement&&document.activeElement!==document.documentElement&&document.activeElement!==document.body&&document.activeElement.blur(),v.listen(),"undefined"==typeof o?g.setRangeEnd(f.selRange.from,i):g.setRangeEnd(new h(o,n),i),v.selection.finish(),!0},this.selectCellByProp=function(e,t,o,n,i){return arguments[1]=p.propToCol(arguments[1]),"undefined"!=typeof arguments[3]&&(arguments[3]=p.propToCol(arguments[3])),v.selectCell.apply(v,arguments)},this.deselectCell=function(){g.deselect()},this.destroy=function(){v._clearTimeouts(),v.view&&v.view.destroy(),t.Dom.empty(v.rootElement),y.clear(),t.hooks.run(v,"afterDestroy"),t.hooks.destroy(v);for(var e in v)v.hasOwnProperty(e)&&("function"==typeof v[e]?"runHooks"!==e&&(v[e]=u):"guid"!==e&&(v[e]=null));f=null,p=null,m=null,g=null,w=null,v=null,C=null},this.getActiveEditor=function(){return w.getActiveEditor()},this.getInstance=function(){return v},this.addHook=function(e,o){t.hooks.add(e,o,v)},this.addHookOnce=function(e,o){t.hooks.once(e,o,v)},this.removeHook=function(e,o){t.hooks.remove(e,o,v)},this.runHooks=function(e,o,n,i,r,s,a){return t.hooks.run(v,e,o,n,i,r,s,a)},this.timeouts=[],this._registerTimeout=function(e){this.timeouts.push(e)},this._clearTimeouts=function(){for(var e=0,t=this.timeouts.length;t>e;e++)clearTimeout(this.timeouts[e])},this.version="0.13.1"};var P=function(){};if(P.prototype={data:void 0,dataSchema:void 0,width:void 0,height:void 0,startRows:5,startCols:5,rowHeaders:null,colHeaders:null,colWidths:void 0,columns:void 0,cells:void 0,cell:[],comments:!1,customBorders:!1,minRows:0,minCols:0,maxRows:1/0,maxCols:1/0,minSpareRows:0,minSpareCols:0,allowInsertRow:!0,allowInsertColumn:!0,allowRemoveRow:!0,allowRemoveColumn:!0,multiSelect:!0,fillHandle:!0,fixedRowsTop:0,fixedColumnsLeft:0,outsideClickDeselects:!0,enterBeginsEditing:!0,enterMoves:{row:1,col:0},tabMoves:{row:0,col:1},autoWrapRow:!1,autoWrapCol:!1,copyRowsLimit:1e3,copyColsLimit:1e3,pasteMode:"overwrite",persistentState:!1,currentRowClassName:void 0,currentColClassName:void 0,stretchH:"none",isEmptyRow:function(e){for(var t,o=0,n=this.countCols();n>o;o++)if(t=this.getDataAtCell(e,o),""!==t&&null!==t&&"undefined"!=typeof t)return!1;return!0},isEmptyCol:function(e){for(var t,o=0,n=this.countRows();n>o;o++)if(t=this.getDataAtCell(o,e),""!==t&&null!==t&&"undefined"!=typeof t)return!1;return!0},observeDOMVisibility:!0,allowInvalid:!0,invalidCellClassName:"htInvalid",placeholder:!1,placeholderCellClassName:"htPlaceholder",readOnlyCellClassName:"htDimmed",renderer:void 0,commentedCellClassName:"htCommentCell",fragmentSelection:!1,readOnly:!1,search:!1,type:"text",copyable:!0,editor:"text",autoComplete:void 0,debug:!1,wordWrap:!0,noWordWrapClassName:"htNoWrap",contextMenu:void 0,undo:void 0,columnSorting:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,mergeCells:!1,viewportRowRenderingOffset:10,viewportColumnRenderingOffset:10,groups:void 0,validator:void 0,manualColumnFreeze:void 0,trimWhitespace:!0,settings:void 0,source:void 0,title:void 0,checkedTemplate:void 0,uncheckedTemplate:void 0,format:void 0,className:void 0},t.DefaultSettings=P,function(e){function t(){function e(e){return null!==e&&!o(e)&&("string"==typeof e||"number"==typeof e)}function t(e){return null!==e&&("object"==typeof e||"function"==typeof e)}function o(e){return e!==e}var n={arrayMap:[],weakMap:new WeakMap};return{get:function(o){return e(o)?n.arrayMap[o]:t(o)?n.weakMap.get(o):void 0},set:function(o,i){if(e(o))n.arrayMap[o]=i;else{if(!t(o))throw new Error("Invalid key type");n.weakMap.set(o,i)}},"delete":function(o){e(o)?delete n.arrayMap[o]:t(o)&&n.weakMap["delete"](o)}}}e.MultiMap||(e.MultiMap=t)}(e),!e.Handsontable)var t={};if(t.Dom={},t.Dom.enableImmediatePropagation=function(e){null!=e&&null==e.isImmediatePropagationEnabled&&(e.stopImmediatePropagation=function(){this.isImmediatePropagationEnabled=!1,this.cancelBubble=!0},e.isImmediatePropagationEnabled=!0,e.isImmediatePropagationStopped=function(){return!this.isImmediatePropagationEnabled})},t.Dom.closest=function(e,t,o){for(;null!=e&&e!==o;){if(1===e.nodeType&&t.indexOf(e.nodeName)>-1)return e;e=e.parentNode}return null},t.Dom.isChildOf=function(e,t){var o=e.parentNode,n=[];for("string"==typeof t?n=Array.prototype.slice.call(document.querySelectorAll(t),0):n.push(t);null!=o;){if(n.indexOf(o)>-1)return!0;o=o.parentNode}return!1},t.Dom.isChildOfWebComponentTable=function(e){function t(e){return e.nodeType===Node.ELEMENT_NODE&&e.nodeName===n.toUpperCase()}var o,n="hot-table",i=!1;for(o="undefined"==typeof wrap?e:wrap(e);null!=o;){if(t(o)){i=!0;break}if(o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(i=t(o.host))break;o=o.host}o=o.parentNode}return i},t.Dom.index=function(e){var t=0;if(e.previousSibling)for(;e=e.previousSibling;)++t;return t},document.documentElement.classList?(t.Dom.hasClass=function(e,t){return e.classList.contains(t)},t.Dom.addClass=function(e,t){t&&e.classList.add(t)},t.Dom.removeClass=function(e,t){e.classList.remove(t)}):(t.Dom.hasClass=function(e,t){return e.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))},t.Dom.addClass=function(e,t){""===e.className?e.className=t:this.hasClass(e,t)||(e.className+=" "+t)},t.Dom.removeClass=function(e,t){if(this.hasClass(e,t)){var o=new RegExp("(\\s|^)"+t+"(\\s|$)");e.className=e.className.replace(o," ").trim()}}),t.Dom.removeTextNodes=function(e,t){if(3===e.nodeType)t.removeChild(e);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(e.nodeName)>-1)for(var o=e.childNodes,n=o.length-1;n>=0;n--)this.removeTextNodes(o[n],e)},t.Dom.empty=function(e){for(var t;t=e.lastChild;)e.removeChild(t)},t.Dom.HTML_CHARACTERS=/(<(.*)>|&(.*);)/,t.Dom.fastInnerHTML=function(e,t){this.HTML_CHARACTERS.test(t)?e.innerHTML=t:this.fastInnerText(e,t)},document.createTextNode("test").textContent?t.Dom.fastInnerText=function(e,t){var o=e.firstChild;o&&3===o.nodeType&&null===o.nextSibling?o.textContent=t:(this.empty(e),e.appendChild(document.createTextNode(t)))}:t.Dom.fastInnerText=function(e,t){var o=e.firstChild;o&&3===o.nodeType&&null===o.nextSibling?o.data=t:(this.empty(e),e.appendChild(document.createTextNode(t)))},t.Dom.isVisible=function(e){function o(e){return"undefined"==typeof unwrap?e:unwrap(e)}for(var n=e;o(n)!==document.documentElement;){if(null===n)return!1;if(n.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(n.host){if(n.host.impl)return t.Dom.isVisible(n.host.impl);if(n.host)return t.Dom.isVisible(n.host);throw new Error("Lost in Web Components world")}return!1}if("none"===n.style.display)return!1;n=n.parentNode}return!0},t.Dom.offset=function(t){var o,n,i,r,s;if(r=document.documentElement,this.hasCaptionProblem()&&t.firstChild&&"CAPTION"===t.firstChild.nodeName)return s=t.getBoundingClientRect(),{top:s.top+(e.pageYOffset||r.scrollTop)-(r.clientTop||0),left:s.left+(e.pageXOffset||r.scrollLeft)-(r.clientLeft||0)};for(o=t.offsetLeft,n=t.offsetTop,i=t;(t=t.offsetParent)&&t!==document.body;)o+=t.offsetLeft,n+=t.offsetTop,i=t;return i&&"fixed"===i.style.position&&(o+=e.pageXOffset||r.scrollLeft,n+=e.pageYOffset||r.scrollTop),{left:o,top:n}},t.Dom.getWindowScrollTop=function(){var t=e.scrollY;return void 0==t&&(t=document.documentElement.scrollTop),t},t.Dom.getWindowScrollLeft=function(){var t=e.scrollX;return void 0==t&&(t=document.documentElement.scrollLeft),t},t.Dom.getScrollTop=function(o){return o===e?t.Dom.getWindowScrollTop(o):o.scrollTop},t.Dom.getScrollLeft=function(o){return o===e?t.Dom.getWindowScrollLeft(o):o.scrollLeft},t.Dom.getScrollableElement=function(t){for(var o,n,i,r=t.parentNode,s=["auto","scroll"];r&&r.style;){if(o=r.style.overflow,n=r.style.overflowX,i=r.style.overflowY,"scroll"==o||"scroll"==n||"scroll"==i)return r;if(r.clientHeight<r.scrollHeight&&(-1!==s.indexOf(i)||-1!==s.indexOf(o)))return r;if(r.clientWidth<r.scrollWidth&&(-1!==s.indexOf(n)||-1!==s.indexOf(o)))return r;r=r.parentNode}return e},t.Dom.getComputedStyle=function(e){return e.currentStyle||document.defaultView.getComputedStyle(e)},t.Dom.outerWidth=function(e){return e.offsetWidth},t.Dom.outerHeight=function(e){return this.hasCaptionProblem()&&e.firstChild&&"CAPTION"===e.firstChild.nodeName?e.offsetHeight+e.firstChild.offsetHeight:e.offsetHeight;
},t.Dom.innerHeight=function(e){return e.clientHeight||e.innerHeight},t.Dom.innerWidth=function(e){return e.clientWidth||e.innerWidth},t.Dom.addEvent=function(t,o,n){e.addEventListener?t.addEventListener(o,n,!1):t.attachEvent("on"+o,n)},t.Dom.removeEvent=function(t,o,n){e.removeEventListener?t.removeEventListener(o,n,!1):t.detachEvent("on"+o,n)},function(){function e(){var e=document.createElement("TABLE");e.style.borderSpacing=0,e.style.borderWidth=0,e.style.padding=0;var t=document.createElement("TBODY");e.appendChild(t),t.appendChild(document.createElement("TR")),t.firstChild.appendChild(document.createElement("TD")),t.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>";var o=document.createElement("CAPTION");o.innerHTML="c<br>c<br>c<br>c",o.style.padding=0,o.style.margin=0,e.insertBefore(o,t),document.body.appendChild(e),n=e.offsetHeight<2*e.lastChild.offsetHeight,document.body.removeChild(e)}function o(){var e=document.createElement("p");e.style.width="100%",e.style.height="200px";var t=document.createElement("div");t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.visibility="hidden",t.style.width="200px",t.style.height="150px",t.style.overflow="hidden",t.appendChild(e),(document.body||document.documentElement).appendChild(t);var o=e.offsetWidth;t.style.overflow="scroll";var n=e.offsetWidth;return o==n&&(n=t.clientWidth),(document.body||document.documentElement).removeChild(t),o-n}var n;t.Dom.hasCaptionProblem=function(){return void 0===n&&e(),n},t.Dom.getCaretPosition=function(e){if(e.selectionStart)return e.selectionStart;if(document.selection){e.focus();var t=document.selection.createRange();if(null==t)return 0;var o=e.createTextRange(),n=o.duplicate();return o.moveToBookmark(t.getBookmark()),n.setEndPoint("EndToStart",o),n.text.length}return 0},t.Dom.getSelectionEndPosition=function(e){if(e.selectionEnd)return e.selectionEnd;if(document.selection){var t=document.selection.createRange();if(null==t)return 0;var o=e.createTextRange();return o.text.indexOf(t.text)+t.text.length}},t.Dom.setCaretPosition=function(e,t,o){if(void 0===o&&(o=t),e.setSelectionRange)e.focus(),e.setSelectionRange(t,o);else if(e.createTextRange){var n=e.createTextRange();n.collapse(!0),n.moveEnd("character",o),n.moveStart("character",t),n.select()}};var i;t.Dom.getScrollbarWidth=function(){return void 0===i&&(i=o()),i};var r=!document.createTextNode("test").textContent;t.Dom.isIE8=function(){return r};var s=!!document.documentMode;t.Dom.isIE9=function(){return s};var a=/Safari/.test(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor);t.Dom.isSafari=function(){return a},t.Dom.setOverlayPosition=function(e,t,o){r||s?(e.style.top=o,e.style.left=t):a?e.style["-webkit-transform"]="translate3d("+t+","+o+",0)":e.style.transform="translate3d("+t+","+o+",0)"},t.Dom.getCssTransform=function(e){var t;return e.style.transform&&""!=(t=e.style.transform)?["transform",t]:e.style["-webkit-transform"]&&""!=(t=e.style["-webkit-transform"])?["-webkit-transform",t]:-1},t.Dom.resetCssTransform=function(e){e.transform&&""!=e.transform?e.transform="":e["-webkit-transform"]&&""!=e["-webkit-transform"]&&(e["-webkit-transform"]="")}}(),!e.Handsontable)var t={};t.countEventManagerListeners=0,t.eventManager=function(o){var n,i,r,s;if(!o)throw new Error("instance not defined");return o.eventListeners||(o.eventListeners=[]),n=function(n,r,s){var a;return a=function(e){var o,n,i=!1;if(void 0==e.target&&void 0!=e.srcElement&&(e.definePoperty?e.definePoperty("target",{value:e.srcElement}):e.target=e.srcElement),void 0==e.preventDefault&&(e.definePoperty?e.definePoperty("preventDefault",{value:function(){this.returnValue=!1}}):e.preventDefault=function(){this.returnValue=!1}),e.isTargetWebComponent=!1,t.eventManager.isHotTableEnv){for(e="undefined"==typeof wrap?e:wrap(e),n=e.path?e.path.length:0;n--;)"HOT-TABLE"===e.path[n].nodeName?i=!0:i&&e.path[n].shadowRoot&&(o=e.path[n]),0!==n||o||(o=e.path[n]);o||(o=e.target),e.isTargetWebComponent=!0,Object.defineProperty(e,"target",{get:function(){return"undefined"==typeof wrap?o:wrap(o)},enumerable:!0,configurable:!0})}s.call(this,e)},o.eventListeners.push({element:n,event:r,callback:s,callbackProxy:a}),e.addEventListener?n.addEventListener(r,a,!1):n.attachEvent("on"+r,a),t.countEventManagerListeners++,function(){i(n,r,s)}},i=function(e,n,i){for(var r,s=o.eventListeners.length;s--;)if(r=o.eventListeners[s],r.event==n&&r.element==e){if(i&&i!=r.callback)continue;o.eventListeners.splice(s,1),r.element.removeEventListener?r.element.removeEventListener(r.event,r.callbackProxy,!1):r.element.detachEvent("on"+r.event,r.callbackProxy),t.countEventManagerListeners--}},r=function(){for(var e,t=o.eventListeners.length;t--;)e=o.eventListeners[t],e&&i(e.element,e.event,e.callback)},s=function(t,o){var n,i;n={bubbles:!0,cancelable:"mousemove"!==o,view:e,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0},document.createEvent?(i=document.createEvent("MouseEvents"),i.initMouseEvent(o,n.bubbles,n.cancelable,n.view,n.detail,n.screenX,n.screenY,n.clientX,n.clientY,n.ctrlKey,n.altKey,n.shiftKey,n.metaKey,n.button,n.relatedTarget||document.body.parentNode)):i=document.createEventObject(),t.dispatchEvent?t.dispatchEvent(i):t.fireEvent("on"+o,i)},{addEventListener:n,removeEventListener:i,clear:r,fireEvent:s}},t.TableView=function(o){var n=this;this.eventManager=t.eventManager(o),this.instance=o,this.settings=o.getSettings();var i=o.rootElement.getAttribute("style");i&&o.rootElement.setAttribute("data-originalstyle",i),t.Dom.addClass(o.rootElement,"handsontable");var r=document.createElement("TABLE");r.className="htCore",this.THEAD=document.createElement("THEAD"),r.appendChild(this.THEAD),this.TBODY=document.createElement("TBODY"),r.appendChild(this.TBODY),o.table=r,o.container.insertBefore(r,o.container.firstChild),this.eventManager.addEventListener(o.rootElement,"mousedown",function(t){n.isTextSelectionAllowed(t.target)||(a(),t.preventDefault(),e.focus())}),this.eventManager.addEventListener(document.documentElement,"keyup",function(e){o.selection.isInProgress()&&!e.shiftKey&&o.selection.finish()});var s;this.isMouseDown=function(){return s},this.eventManager.addEventListener(document.documentElement,"mouseup",function(e){o.selection.isInProgress()&&1===e.which&&o.selection.finish(),s=!1,t.helper.isOutsideInput(document.activeElement)&&o.unlisten()}),this.eventManager.addEventListener(document.documentElement,"mousedown",function(e){var t=e.target;if(!s){if(t!==n.instance.container)for(;t!==document.documentElement;){if(null===t){if(e.isTargetWebComponent)break;return}if(t===o.rootElement)return;t=t.parentNode}n.settings.outsideClickDeselects?o.deselectCell():o.destroyEditor()}}),this.eventManager.addEventListener(r,"selectstart",function(e){n.settings.fragmentSelection||e.preventDefault()});var a=function(){e.getSelection?e.getSelection().empty?e.getSelection().empty():e.getSelection().removeAllRanges&&e.getSelection().removeAllRanges():document.selection&&document.selection.empty()},l=[new T({className:"current",border:{width:2,color:"#5292F7",cornerVisible:function(){return n.settings.fillHandle&&!n.isCellEdited()&&!o.selection.isMultiple()},multipleSelectionHandlesVisible:function(){return!n.isCellEdited()&&!o.selection.isMultiple()}}}),new T({className:"area",border:{width:1,color:"#89AFF9",cornerVisible:function(){return n.settings.fillHandle&&!n.isCellEdited()&&o.selection.isMultiple()},multipleSelectionHandlesVisible:function(){return!n.isCellEdited()&&o.selection.isMultiple()}}}),new T({className:"highlight",highlightRowClassName:n.settings.currentRowClassName,highlightColumnClassName:n.settings.currentColClassName}),new T({className:"fill",border:{width:1,color:"red"}})];l.current=l[0],l.area=l[1],l.highlight=l[2],l.fill=l[3];var c={debug:function(){return n.settings.debug},table:r,stretchH:this.settings.stretchH,data:o.getDataAtCell,totalRows:o.countRows,totalColumns:o.countCols,fixedColumnsLeft:function(){return n.settings.fixedColumnsLeft},fixedRowsTop:function(){return n.settings.fixedRowsTop},renderAllRows:n.settings.renderAllRows,rowHeaders:function(){var e=[];return o.hasRowHeaders()&&e.push(function(e,t){n.appendRowHeader(e,t)}),t.hooks.run(o,"afterGetRowHeaderRenderers",e),e},columnHeaders:function(){var e=[];return o.hasColHeaders()&&e.push(function(e,t){n.appendColHeader(e,t)}),t.hooks.run(o,"afterGetColumnHeaderRenderers",e),e},columnWidth:o.getColWidth,rowHeight:o.getRowHeight,cellRenderer:function(e,o,i){var r=n.instance.colToProp(o),s=n.instance.getCellMeta(e,o),a=n.instance.getCellRenderer(s),l=n.instance.getDataAtRowProp(e,r);a(n.instance,i,e,o,r,l,s),t.hooks.run(n.instance,"afterRenderer",i,e,o,r,l,s)},selections:l,hideBorderOnMouseDownOver:function(){return n.settings.fragmentSelection},onCellMouseDown:function(e,i,r,a){o.listen(),n.activeWt=a,s=!0,t.Dom.enableImmediatePropagation(e),t.hooks.run(o,"beforeOnCellMouseDown",e,i,r),e.isImmediatePropagationStopped()||(2===e.button&&o.selection.inInSelection(i)||(e.shiftKey?i.row>=0&&i.col>=0&&o.selection.setRangeEnd(i):(i.row<0||i.col<0)&&(i.row>=0||i.col>=0)?(i.row<0&&(o.selectCell(0,i.col,o.countRows()-1,i.col),o.selection.setSelectedHeaders(!1,!0)),i.col<0&&(o.selectCell(i.row,0,i.row,o.countCols()-1),o.selection.setSelectedHeaders(!0,!1))):(i.row=i.row<0?0:i.row,i.col=i.col<0?0:i.col,o.selection.setRangeStart(i))),t.hooks.run(o,"afterOnCellMouseDown",e,i,r),n.activeWt=n.wt)},onCellMouseOver:function(e,i,r,a){n.activeWt=a,i.row>=0&&i.col>=0?s&&o.selection.setRangeEnd(i):s&&(i.row<0&&(o.selection.setRangeEnd(new h(o.countRows()-1,i.col)),o.selection.setSelectedHeaders(!1,!0)),i.col<0&&(o.selection.setRangeEnd(new h(i.row,o.countCols()-1)),o.selection.setSelectedHeaders(!0,!1))),t.hooks.run(o,"afterOnCellMouseOver",e,i,r),n.activeWt=n.wt},onCellCornerMouseDown:function(e){e.preventDefault(),t.hooks.run(o,"afterOnCellCornerMouseDown",e)},beforeDraw:function(e){n.beforeRender(e)},onDraw:function(e){n.onDraw(e)},onScrollVertically:function(){o.runHooks("afterScrollVertically")},onScrollHorizontally:function(){o.runHooks("afterScrollHorizontally")},onBeforeDrawBorders:function(e,t){o.runHooks("beforeDrawBorders",e,t)},onBeforeTouchScroll:function(){o.runHooks("beforeTouchScroll")},onAfterMomentumScroll:function(){o.runHooks("afterMomentumScroll")},viewportRowCalculatorOverride:function(e){n.settings.viewportRowRenderingOffset&&(e.startRow=Math.max(e.startRow-n.settings.viewportRowRenderingOffset,0),e.endRow=Math.min(e.endRow+n.settings.viewportRowRenderingOffset,o.countRows()-1)),o.runHooks("afterViewportRowCalculatorOverride",e)},viewportColumnCalculatorOverride:function(e){n.settings.viewportColumnRenderingOffset&&(e.startColumn=Math.max(e.startColumn-n.settings.viewportColumnRenderingOffset,0),e.endColumn=Math.min(e.endColumn+n.settings.viewportColumnRenderingOffset,o.countCols()-1)),o.runHooks("afterViewportColumnCalculatorOverride",e)}};t.hooks.run(o,"beforeInitWalkontable",c),this.wt=new m(c),this.activeWt=this.wt,this.eventManager.addEventListener(n.wt.wtTable.spreader,"mousedown",function(e){e.target===n.wt.wtTable.spreader&&3===e.which&&t.helper.stopPropagation(e)}),this.eventManager.addEventListener(n.wt.wtTable.spreader,"contextmenu",function(e){e.target===n.wt.wtTable.spreader&&3===e.which&&t.helper.stopPropagation(e)}),this.eventManager.addEventListener(document.documentElement,"click",function(){n.settings.observeDOMVisibility&&n.wt.drawInterrupted&&(n.instance.forceFullRender=!0,n.render())})},t.TableView.prototype.isTextSelectionAllowed=function(e){return t.helper.isInput(e)?!0:this.settings.fragmentSelection&&t.Dom.isChildOf(e,this.TBODY)?!0:!1},t.TableView.prototype.isCellEdited=function(){var e=this.instance.getActiveEditor();return e&&e.isOpened()},t.TableView.prototype.beforeRender=function(e){e&&t.hooks.run(this.instance,"beforeRender",this.instance.forceFullRender)},t.TableView.prototype.onDraw=function(e){e&&t.hooks.run(this.instance,"afterRender",this.instance.forceFullRender)},t.TableView.prototype.render=function(){this.wt.draw(!this.instance.forceFullRender),this.instance.forceFullRender=!1},t.TableView.prototype.getCellAtCoords=function(e,t){var o=this.wt.getCell(e,t);return 0>o?null:o},t.TableView.prototype.scrollViewport=function(e){this.wt.scrollViewport(e)},t.TableView.prototype.appendRowHeader=function(e,o){var n=document.createElement("DIV"),i=document.createElement("SPAN");n.className="relative",i.className="rowHeader",e>-1?t.Dom.fastInnerHTML(i,this.instance.getRowHeader(e)):t.Dom.fastInnerText(i,String.fromCharCode(160)),n.appendChild(i),t.Dom.empty(o),o.appendChild(n),t.hooks.run(this.instance,"afterGetRowHeader",e,o)},t.TableView.prototype.appendColHeader=function(e,o){var n=document.createElement("DIV"),i=document.createElement("SPAN");n.className="relative",i.className="colHeader",e>-1?t.Dom.fastInnerHTML(i,this.instance.getColHeader(e)):(t.Dom.fastInnerText(i,String.fromCharCode(160)),t.Dom.addClass(i,"cornerHeader")),n.appendChild(i),t.Dom.empty(o),o.appendChild(n),t.hooks.run(this.instance,"afterGetColHeader",e,o)},t.TableView.prototype.maximumVisibleElementWidth=function(e){var t=this.wt.wtViewport.getWorkspaceWidth(),o=t-e;return o>0?o:0},t.TableView.prototype.maximumVisibleElementHeight=function(e){var t=this.wt.wtViewport.getWorkspaceHeight(),o=t-e;return o>0?o:0},t.TableView.prototype.mainViewIsActive=function(){return this.wt===this.activeWt},t.TableView.prototype.destroy=function(){this.wt.destroy(),this.eventManager.clear()},function(e){function t(e){var t,o;o={},t=e,this.getInstance=function(e){return e.guid in o||(o[e.guid]=new t(e)),o[e.guid]}}var o={},n=new WeakMap;e.editors={registerEditor:function(e,i){var r=new t(i);"string"==typeof e&&(o[e]=r),n.set(i,r)},getEditor:function(e,t){var i;if("function"==typeof e)n.get(e)||this.registerEditor(null,e),i=n.get(e);else{if("string"!=typeof e)throw Error('Only strings and functions can be passed as "editor" parameter ');i=o[e]}if(!i)throw Error('No editor registered under name "'+e+'"');return i.getInstance(t)}}}(t),function(e){e.EditorManager=function(t,o,n){function i(e){var t="function"==typeof o.settings.enterMoves?o.settings.enterMoves(event):o.settings.enterMoves;e?n.transformStart(-t.row,-t.col):n.transformStart(t.row,t.col,!0)}function r(e){e?n.transformEnd(-1,0):n.transformStart(-1,0)}function s(e){e?n.transformEnd(1,0):n.transformStart(1,0)}function a(e){e?n.transformEnd(0,1):n.transformStart(0,1)}function l(e){e?n.transformEnd(0,-1):n.transformStart(0,-1)}function c(c){var u,d;if(t.isListening()&&(e.hooks.run(t,"beforeKeyDown",c),!g&&(e.Dom.enableImmediatePropagation(c),!c.isImmediatePropagationStopped()&&(o.lastKeyCode=c.keyCode,n.isSelected())))){if(u=(c.ctrlKey||c.metaKey)&&!c.altKey,f&&!f.isWaiting()&&!e.helper.isMetaKey(c.keyCode)&&!u&&!p.isEditorOpened())return void p.openEditor("",c);switch(d=c.shiftKey?n.setRangeEnd:n.setRangeStart,c.keyCode){case m.A:u&&(n.selectAll(),c.preventDefault(),e.helper.stopPropagation(c));break;case m.ARROW_UP:p.isEditorOpened()&&f&&!f.isWaiting()&&p.closeEditorAndSaveChanges(u),r(c.shiftKey),c.preventDefault(),e.helper.stopPropagation(c);break;case m.ARROW_DOWN:p.isEditorOpened()&&f&&!f.isWaiting()&&p.closeEditorAndSaveChanges(u),s(c.shiftKey),c.preventDefault(),e.helper.stopPropagation(c);break;case m.ARROW_RIGHT:p.isEditorOpened()&&f&&!f.isWaiting()&&p.closeEditorAndSaveChanges(u),a(c.shiftKey),c.preventDefault(),e.helper.stopPropagation(c);break;case m.ARROW_LEFT:p.isEditorOpened()&&f&&!f.isWaiting()&&p.closeEditorAndSaveChanges(u),l(c.shiftKey),c.preventDefault(),e.helper.stopPropagation(c);break;case m.TAB:var w="function"==typeof o.settings.tabMoves?o.settings.tabMoves(c):o.settings.tabMoves;c.shiftKey?n.transformStart(-w.row,-w.col):n.transformStart(w.row,w.col,!0),c.preventDefault(),e.helper.stopPropagation(c);break;case m.BACKSPACE:case m.DELETE:n.empty(c),p.prepareEditor(),c.preventDefault();break;case m.F2:p.openEditor(null,c),c.preventDefault();break;case m.ENTER:p.isEditorOpened()?(f&&f.state!==e.EditorState.WAITING&&p.closeEditorAndSaveChanges(u),i(c.shiftKey)):t.getSettings().enterBeginsEditing?p.openEditor(null,c):i(c.shiftKey),c.preventDefault(),c.stopImmediatePropagation();break;case m.ESCAPE:p.isEditorOpened()&&p.closeEditorAndRestoreOriginalValue(u),c.preventDefault();break;case m.HOME:d(c.ctrlKey||c.metaKey?new h(0,o.selRange.from.col):new h(o.selRange.from.row,0)),c.preventDefault(),e.helper.stopPropagation(c);break;case m.END:d(c.ctrlKey||c.metaKey?new h(t.countRows()-1,o.selRange.from.col):new h(o.selRange.from.row,t.countCols()-1)),c.preventDefault(),e.helper.stopPropagation(c);break;case m.PAGE_UP:n.transformStart(-t.countVisibleRows(),0),c.preventDefault(),e.helper.stopPropagation(c);break;case m.PAGE_DOWN:n.transformStart(t.countVisibleRows(),0),c.preventDefault(),e.helper.stopPropagation(c)}}}function u(){function e(e,t,o){"TD"==o.nodeName&&p.openEditor()}t.addHook("afterDocumentKeyDown",c),d.addEventListener(document.documentElement,"keydown",function(e){t.runHooks("afterDocumentKeyDown",e)}),t.view.wt.update("onCellDblClick",e),t.addHook("afterDestroy",function(){g=!0})}var d,f,p=this,m=e.helper.keyCode,g=!1;d=e.eventManager(t),this.destroyEditor=function(e){this.closeEditor(e)},this.getActiveEditor=function(){return f},this.prepareEditor=function(){var n,i,r,s,a,l,c;return f&&f.isWaiting()?void this.closeEditor(!1,!1,function(e){e&&p.prepareEditor()}):(n=o.selRange.highlight.row,i=o.selRange.highlight.col,r=t.colToProp(i),s=t.getCell(n,i),a=t.getDataAtCell(n,i),l=t.getCellMeta(n,i),c=t.getCellEditor(l),void(c?(f=e.editors.getEditor(c,t),f.prepare(n,i,r,s,a,l)):f=void 0))},this.isEditorOpened=function(){return f&&f.isOpened()},this.openEditor=function(e,t){f&&!f.cellProperties.readOnly&&f.beginEditing(e,t)},this.closeEditor=function(e,t,o){f?f.finishEditing(e,t,o):o&&o(!1)},this.closeEditorAndSaveChanges=function(e){return this.closeEditor(!1,e)},this.closeEditorAndRestoreOriginalValue=function(e){return this.closeEditor(!0,e)},u()}}(t),function(e){var t={};e.renderers={registerRenderer:function(e,o){t[e]=o},getRenderer:function(e){if("function"==typeof e)return e;if("string"!=typeof e)throw Error('Only strings and functions can be passed as "renderer" parameter ');if(!(e in t))throw Error('No editor registered under name "'+e+'"');return t[e]}}}(t),t.helper={},t.helper.isPrintableChar=function(e){return 32==e||e>=48&&57>=e||e>=96&&111>=e||e>=186&&192>=e||e>=219&&222>=e||e>=226||e>=65&&90>=e},t.helper.isMetaKey=function(e){var o=t.helper.keyCode,n=[o.ARROW_DOWN,o.ARROW_UP,o.ARROW_LEFT,o.ARROW_RIGHT,o.HOME,o.END,o.DELETE,o.BACKSPACE,o.F1,o.F2,o.F3,o.F4,o.F5,o.F6,o.F7,o.F8,o.F9,o.F10,o.F11,o.F12,o.TAB,o.PAGE_DOWN,o.PAGE_UP,o.ENTER,o.ESCAPE,o.SHIFT,o.CAPS_LOCK,o.ALT];return-1!=n.indexOf(e)},t.helper.isCtrlKey=function(e){var o=t.helper.keyCode;return-1!=[o.CONTROL_LEFT,224,o.COMMAND_LEFT,o.COMMAND_RIGHT].indexOf(e)},t.helper.stringify=function(e){switch(typeof e){case"string":case"number":return e+"";case"object":return null===e?"":e.toString();case"undefined":return"";default:return e.toString()}},t.helper.spreadsheetColumnLabel=function(e){for(var t,o=e+1,n="";o>0;)t=(o-1)%26,n=String.fromCharCode(65+t)+n,o=parseInt((o-t)/26,10);return n},t.helper.createSpreadsheetData=function(e,o){e="number"==typeof e?e:100,o="number"==typeof o?o:4;var n,i,r=[];for(n=0;e>n;n++){var s=[];for(i=0;o>i;i++)s.push(t.helper.spreadsheetColumnLabel(i)+(n+1));r.push(s)}return r},t.helper.createSpreadsheetObjectData=function(e,o){e="number"==typeof e?e:100,o="number"==typeof o?o:4;var n,i,r=[];for(n=0;e>n;n++){var s={};for(i=0;o>i;i++)s["prop"+i]=t.helper.spreadsheetColumnLabel(i)+(n+1);r.push(s)}return r},t.helper.isNumeric=function(e){var t=typeof e;return"number"==t?!isNaN(e)&&isFinite(e):"string"==t?e.length?1==e.length?/\d/.test(e):/^\s*[+-]?\s*(?:(?:\d+(?:\.\d+)?(?:e[+-]?\d+)?)|(?:0x[a-f\d]+))\s*$/i.test(e):!1:"object"==t?!(!e||"number"!=typeof e.valueOf()||e instanceof Date):!1},t.helper.randomString=function(){return v()},t.helper.inherit=function(e,t){return t.prototype.constructor=t,e.prototype=new t,e.prototype.constructor=e,e},t.helper.extend=function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])},t.helper.deepExtend=function(e,o){for(var n in o)o.hasOwnProperty(n)&&(o[n]&&"object"==typeof o[n]?(e[n]||(Array.isArray(o[n])?e[n]=[]:e[n]={}),t.helper.deepExtend(e[n],o[n])):e[n]=o[n])},t.helper.deepClone=function(e){return"object"==typeof e?JSON.parse(JSON.stringify(e)):e},t.helper.getPrototypeOf=function(e){var t;if("object"==typeof e.__proto__)t=e.__proto__;else{var o,n=e.constructor;"function"==typeof e.constructor&&(o=n,delete e.constructor&&(n=e.constructor,e.constructor=o)),t=n?n.prototype:null}return t},t.helper.columnFactory=function(e,o){function n(){}t.helper.inherit(n,e);for(var i=0,r=o.length;r>i;i++)n.prototype[o[i]]=void 0;return n},t.helper.translateRowsToColumns=function(e){var t,o,n,i,r=[],s=0;for(t=0,o=e.length;o>t;t++)for(n=0,i=e[t].length;i>n;n++)n==s&&(r.push([]),s++),r[n].push(e[t][n]);return r},t.helper.to2dArray=function(e){for(var t=0,o=e.length;o>t;)e[t]=[e[t]],t++},t.helper.extendArray=function(e,t){for(var o=0,n=t.length;n>o;)e.push(t[o]),o++},t.helper.isInput=function(e){var t=["INPUT","SELECT","TEXTAREA"];return t.indexOf(e.nodeName)>-1},t.helper.isOutsideInput=function(e){return t.helper.isInput(e)&&-1==e.className.indexOf("handsontableInput")},t.helper.keyCode={MOUSE_LEFT:1,MOUSE_RIGHT:3,MOUSE_MIDDLE:2,BACKSPACE:8,COMMA:188,INSERT:45,DELETE:46,END:35,ENTER:13,ESCAPE:27,CONTROL_LEFT:91,COMMAND_LEFT:17,COMMAND_RIGHT:93,ALT:18,HOME:36,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,SPACE:32,SHIFT:16,CAPS_LOCK:20,TAB:9,ARROW_RIGHT:39,ARROW_LEFT:37,ARROW_UP:38,ARROW_DOWN:40,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,A:65,X:88,C:67,V:86},t.helper.isObject=function(e){return"[object Object]"==Object.prototype.toString.call(e)},t.helper.pivot=function(e){var t=[];if(!e||0===e.length||!e[0]||0===e[0].length)return t;for(var o=e.length,n=e[0].length,i=0;o>i;i++)for(var r=0;n>r;r++)t[r]||(t[r]=[]),t[r][i]=e[i][r];return t},t.helper.proxy=function(e,t){return function(){return e.apply(t,arguments)}},t.helper.cellMethodLookupFactory=function(e,o){function n(e){var o=t.cellTypes[e];if("undefined"==typeof o)throw new Error('You declared cell type "'+e+'" as a string that is not mapped to a known object. Cell type must be an object or a string mapped to an object in Handsontable.cellTypes');return o}return o="undefined"==typeof o?!0:o,function(i,r){return function s(i){if(i){if(i.hasOwnProperty(e)&&void 0!==i[e])return i[e];if(i.hasOwnProperty("type")&&i.type){var r;if("string"!=typeof i.type)throw new Error("Cell type must be a string ");if(r=n(i.type),r.hasOwnProperty(e))return r[e];if(o)return}return s(t.helper.getPrototypeOf(i))}}("number"==typeof i?this.getCellMeta(i,r):i)}},t.helper.isMobileBrowser=function(e){return e||(e=navigator.userAgent),/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e)},t.helper.isTouchSupported=function(){return"ontouchstart"in e},t.helper.stopPropagation=function(e){"function"==typeof e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},t.helper.pageX=function(e){if(e.pageX)return e.pageX;var o=t.Dom.getWindowScrollLeft(),n=e.clientX+o;return n},t.helper.pageY=function(e){if(e.pageY)return e.pageY;var o=t.Dom.getWindowScrollTop(),n=e.clientY+o;return n},function(e){e.DataMap=function(e,t,o){this.instance=e,this.priv=t,this.GridSettings=o,this.dataSource=this.instance.getSettings().data,this.dataSource[0]?this.duckSchema=this.recursiveDuckSchema(this.dataSource[0]):this.duckSchema={},this.createMap()},e.DataMap.prototype.DESTINATION_RENDERER=1,e.DataMap.prototype.DESTINATION_CLIPBOARD_GENERATOR=2,e.DataMap.prototype.recursiveDuckSchema=function(e){var t;if(Array.isArray(e))t=[];else{t={};for(var o in e)e.hasOwnProperty(o)&&("object"!=typeof e[o]||Array.isArray(e[o])?t[o]=null:t[o]=this.recursiveDuckSchema(e[o]))}return t},e.DataMap.prototype.recursiveDuckColumns=function(e,t,o){var n,i;if("undefined"==typeof t&&(t=0,o=""),"object"==typeof e&&!Array.isArray(e))for(i in e)e.hasOwnProperty(i)&&(null===e[i]?(n=o+i,this.colToPropCache.push(n),this.propToColCache.set(n,t),t++):t=this.recursiveDuckColumns(e[i],t,i+"."));return t},e.DataMap.prototype.createMap=function(){var e,t,o=this.getSchema();if("undefined"==typeof o)throw new Error("trying to create `columns` definition but you didnt' provide `schema` nor `data`");this.colToPropCache=[],this.propToColCache=new MultiMap;var n=this.instance.getSettings().columns;if(n)for(e=0,t=n.length;t>e;e++)"undefined"!=typeof n[e].data&&(this.colToPropCache[e]=n[e].data,this.propToColCache.set(n[e].data,e));else this.recursiveDuckColumns(o)},e.DataMap.prototype.colToProp=function(t){return t=e.hooks.run(this.instance,"modifyCol",t),this.colToPropCache&&"undefined"!=typeof this.colToPropCache[t]?this.colToPropCache[t]:t},e.DataMap.prototype.propToCol=function(t){var o;return o="undefined"!=typeof this.propToColCache.get(t)?this.propToColCache.get(t):t,o=e.hooks.run(this.instance,"modifyCol",o)},e.DataMap.prototype.getSchema=function(){var e=this.instance.getSettings().dataSchema;return e?"function"==typeof e?e():e:this.duckSchema},e.DataMap.prototype.createRow=function(t,o,n){var i,r,s=this.instance.countCols(),a=0;o||(o=1),("number"!=typeof t||t>=this.instance.countRows())&&(t=this.instance.countRows()),r=t;for(var l=this.instance.getSettings().maxRows;o>a&&this.instance.countRows()<l;){if("array"===this.instance.dataType){i=[];for(var c=0;s>c;c++)i.push(null)}else"function"===this.instance.dataType?i=this.instance.getSettings().dataSchema(t):(i={},e.helper.deepExtend(i,this.getSchema()));t===this.instance.countRows()?this.dataSource.push(i):this.dataSource.splice(t,0,i),a++,r++}return e.hooks.run(this.instance,"afterCreateRow",t,a,n),this.instance.forceFullRender=!0,a},e.DataMap.prototype.createCol=function(t,o,n){if("object"===this.instance.dataType||this.instance.getSettings().columns)throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");var i,r,s=this.instance.countRows(),a=this.dataSource,l=0;o||(o=1),r=t;for(var c=this.instance.getSettings().maxCols;o>l&&this.instance.countCols()<c;){if(i=e.helper.columnFactory(this.GridSettings,this.priv.columnsSettingConflicts),"number"!=typeof t||t>=this.instance.countCols()){for(var u=0;s>u;u++)"undefined"==typeof a[u]&&(a[u]=[]),a[u].push(null);this.priv.columnSettings.push(i)}else{for(var u=0;s>u;u++)a[u].splice(r,0,null);this.priv.columnSettings.splice(r,0,i)}l++,r++}return e.hooks.run(this.instance,"afterCreateCol",t,l,n),this.instance.forceFullRender=!0,l},e.DataMap.prototype.removeRow=function(t,o){o||(o=1),"number"!=typeof t&&(t=-o),t=(this.instance.countRows()+t)%this.instance.countRows();var n=this.physicalRowsToLogical(t,o),i=e.hooks.run(this.instance,"beforeRemoveRow",t,o);if(i!==!1){var r=this.dataSource,s=r.filter(function(e,t){return-1==n.indexOf(t)});r.length=0,Array.prototype.push.apply(r,s),e.hooks.run(this.instance,"afterRemoveRow",t,o),this.instance.forceFullRender=!0}},e.DataMap.prototype.removeCol=function(t,o){if("object"===this.instance.dataType||this.instance.getSettings().columns)throw new Error("cannot remove column with object data source or columns option specified");o||(o=1),"number"!=typeof t&&(t=-o),t=(this.instance.countCols()+t)%this.instance.countCols();var n=e.hooks.run(this.instance,"beforeRemoveCol",t,o);if(n!==!1){for(var i=this.dataSource,r=0,s=this.instance.countRows();s>r;r++)i[r].splice(t,o);this.priv.columnSettings.splice(t,o),e.hooks.run(this.instance,"afterRemoveCol",t,o),this.instance.forceFullRender=!0}},e.DataMap.prototype.spliceCol=function(t,o,n){var i=4<=arguments.length?[].slice.call(arguments,3):[],r=this.instance.getDataAtCol(t),s=r.slice(o,o+n),a=r.slice(o+n);e.helper.extendArray(i,a);for(var l=0;n>l;)i.push(null),l++;return e.helper.to2dArray(i),this.instance.populateFromArray(o,t,i,null,null,"spliceCol"),s},e.DataMap.prototype.spliceRow=function(t,o,n){var i=4<=arguments.length?[].slice.call(arguments,3):[],r=this.instance.getSourceDataAtRow(t),s=r.slice(o,o+n),a=r.slice(o+n);e.helper.extendArray(i,a);for(var l=0;n>l;)i.push(null),l++;return this.instance.populateFromArray(t,o,[i],null,null,"spliceRow"),s},e.DataMap.prototype.get=function(t,o){if(t=e.hooks.run(this.instance,"modifyRow",t),"string"==typeof o&&o.indexOf(".")>-1){var n=o.split("."),i=this.dataSource[t];if(!i)return null;for(var r=0,s=n.length;s>r;r++)if(i=i[n[r]],"undefined"==typeof i)return null;return i}return"function"==typeof o?o(this.dataSource.slice(t,t+1)[0]):this.dataSource[t]?this.dataSource[t][o]:null};var t=e.helper.cellMethodLookupFactory("copyable",!1);e.DataMap.prototype.getCopyable=function(e,o){return t.call(this.instance,e,this.propToCol(o))?this.get(e,o):""},e.DataMap.prototype.set=function(t,o,n,i){if(t=e.hooks.run(this.instance,"modifyRow",t,i||"datamapGet"),"string"==typeof o&&o.indexOf(".")>-1){for(var r=o.split("."),s=this.dataSource[t],a=0,l=r.length-1;l>a;a++)"undefined"==typeof s[r[a]]&&(s[r[a]]={}),s=s[r[a]];s[r[a]]=n}else"function"==typeof o?o(this.dataSource.slice(t,t+1)[0],n):this.dataSource[t][o]=n},e.DataMap.prototype.physicalRowsToLogical=function(t,o){for(var n,i=this.instance.countRows(),r=(i+t)%i,s=[],a=o;i>r&&a;)n=e.hooks.run(this.instance,"modifyRow",r),s.push(n),a--,r++;return s},e.DataMap.prototype.clear=function(){for(var e=0;e<this.instance.countRows();e++)for(var t=0;t<this.instance.countCols();t++)this.set(e,this.colToProp(t),"")},e.DataMap.prototype.getAll=function(){return this.dataSource},e.DataMap.prototype.getRange=function(e,t,o){var n,i,r,s,a,l=[],c=o===this.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get;for(i=Math.max(e.row,t.row),s=Math.max(e.col,t.col),n=Math.min(e.row,t.row);i>=n;n++){for(a=[],r=Math.min(e.col,t.col);s>=r;r++)a.push(c.call(this,n,this.colToProp(r)));l.push(a)}return l},e.DataMap.prototype.getText=function(e,t){return SheetClip.stringify(this.getRange(e,t,this.DESTINATION_RENDERER))},e.DataMap.prototype.getCopyableText=function(e,t){return SheetClip.stringify(this.getRange(e,t,this.DESTINATION_CLIPBOARD_GENERATOR))}}(t),function(e){e.renderers.cellDecorator=function(t,o,n,i,r,s,a){a.className&&(o.className?o.className=o.className+" "+a.className:o.className=a.className),a.readOnly&&e.Dom.addClass(o,a.readOnlyCellClassName),a.valid===!1&&a.invalidCellClassName?e.Dom.addClass(o,a.invalidCellClassName):e.Dom.removeClass(o,a.invalidCellClassName),a.wordWrap===!1&&a.noWordWrapClassName&&e.Dom.addClass(o,a.noWordWrapClassName),!s&&a.placeholder&&e.Dom.addClass(o,a.placeholderCellClassName)}}(t),function(e){var t=function(t,o,n,i,r,s,a){e.renderers.cellDecorator.apply(this,arguments),!s&&a.placeholder&&(s=a.placeholder);var l=e.helper.stringify(s);if(t.getSettings().trimWhitespace||(l=l.replace(/ /g,String.fromCharCode(160))),a.rendererTemplate){e.Dom.empty(o);var c=document.createElement("TEMPLATE");c.setAttribute("bind","{{}}"),c.innerHTML=a.rendererTemplate,HTMLTemplateElement.decorate(c),c.model=t.getSourceDataAtRow(n),o.appendChild(c)}else e.Dom.fastInnerText(o,l)};e.renderers.TextRenderer=t,e.renderers.registerRenderer("text",t)}(t),function(e){var t=document.createElement("DIV");t.className="htAutocompleteWrapper";var o=document.createElement("DIV");o.className="htAutocompleteArrow",o.appendChild(document.createTextNode(String.fromCharCode(9660)));var n=function(n,i,r,s,a,l,c){var u=(t.cloneNode(!0),o.cloneNode(!0));if(e.renderers.TextRenderer(n,i,r,s,a,l,c),i.appendChild(u),e.Dom.addClass(i,"htAutocomplete"),i.firstChild||i.appendChild(document.createTextNode(String.fromCharCode(160))),!n.acArrowListener){var d=e.eventManager(n);n.acArrowListener=function(t){e.Dom.hasClass(t.target,"htAutocompleteArrow")&&n.view.wt.getSetting("onCellDblClick",null,new h(r,s),i)},d.addEventListener(n.rootElement,"mousedown",n.acArrowListener),n.addHookOnce("afterDestroy",function(){d.clear()})}};e.AutocompleteRenderer=n,e.renderers.AutocompleteRenderer=n,e.renderers.registerRenderer("autocomplete",n)}(t),function(e){var t=document.createElement("INPUT");t.className="htCheckboxRendererInput",t.type="checkbox",t.setAttribute("autocomplete","off");var o=function(o,n,i,r,s,a,l){var c=e.eventManager(o);"undefined"==typeof l.checkedTemplate&&(l.checkedTemplate=!0),"undefined"==typeof l.uncheckedTemplate&&(l.uncheckedTemplate=!1),e.Dom.empty(n);var u=t.cloneNode(!1);
a===l.checkedTemplate||a===e.helper.stringify(l.checkedTemplate)?(u.checked=!0,n.appendChild(u)):a===l.uncheckedTemplate||a===e.helper.stringify(l.uncheckedTemplate)?n.appendChild(u):null===a?(u.className+=" noValue",n.appendChild(u)):e.Dom.fastInnerText(n,"#bad value#"),l.readOnly?c.addEventListener(u,"click",function(e){e.preventDefault()}):(c.addEventListener(u,"mousedown",function(t){e.helper.stopPropagation(t)}),c.addEventListener(u,"mouseup",function(t){e.helper.stopPropagation(t)}),c.addEventListener(u,"change",function(){this.checked?o.setDataAtRowProp(i,s,l.checkedTemplate):o.setDataAtRowProp(i,s,l.uncheckedTemplate)})),o.CheckboxRenderer&&o.CheckboxRenderer.beforeKeyDownHookBound||(o.CheckboxRenderer={beforeKeyDownHookBound:!0},o.addHook("beforeKeyDown",function(t){if(e.Dom.enableImmediatePropagation(t),t.keyCode==e.helper.keyCode.SPACE||t.keyCode==e.helper.keyCode.ENTER)for(var n,i,r,s=o.getSelectedRange(),a=s.getTopLeftCorner(),l=s.getBottomRightCorner(),u=a.row;u<=l.row;u++)for(var h=a.col;h<=l.col;h++)if(n=o.getCell(u,h),r=o.getCellMeta(u,h),i=n.querySelectorAll("input[type=checkbox]"),i.length>0&&!r.readOnly){t.isImmediatePropagationStopped()||(t.stopImmediatePropagation(),t.preventDefault());for(var d=0,f=i.length;f>d;d++)i[d].checked=!i[d].checked,c.fireEvent(i[d],"change")}}))};e.CheckboxRenderer=o,e.renderers.CheckboxRenderer=o,e.renderers.registerRenderer("checkbox",o)}(t),function(e){var t=function(t,o,n,i,r,s,a){e.helper.isNumeric(s)&&("undefined"!=typeof a.language&&numeral.language(a.language),s=numeral(s).format(a.format||"0"),e.Dom.addClass(o,"htNumeric")),e.renderers.TextRenderer(t,o,n,i,r,s,a)};e.NumericRenderer=t,e.renderers.NumericRenderer=t,e.renderers.registerRenderer("numeric",t)}(t),function(e){var t=function(t,o,n,i,r,s,a){e.renderers.TextRenderer.apply(this,arguments),s=o.innerHTML;var l,c=a.hashLength||s.length,u=a.hashSymbol||"*";for(l="";l.split(u).length-1<c;l+=u);e.Dom.fastInnerHTML(o,l)};e.PasswordRenderer=t,e.renderers.PasswordRenderer=t,e.renderers.registerRenderer("password",t)}(t),function(e){function t(t,o,n,i,r,s,a){e.renderers.cellDecorator.apply(this,arguments),e.Dom.fastInnerHTML(o,s)}e.renderers.registerRenderer("html",t),e.renderers.HtmlRenderer=t}(t),function(e){function t(t){this.instance=t,this.state=e.EditorState.VIRGIN,this._opened=!1,this._closeCallback=null,this.init()}e.EditorState={VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"},t.prototype._fireCallbacks=function(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)},t.prototype.init=function(){},t.prototype.getValue=function(){throw Error("Editor getValue() method unimplemented")},t.prototype.setValue=function(e){throw Error("Editor setValue() method unimplemented")},t.prototype.open=function(){throw Error("Editor open() method unimplemented")},t.prototype.close=function(){throw Error("Editor close() method unimplemented")},t.prototype.prepare=function(t,o,n,i,r,s){this.TD=i,this.row=t,this.col=o,this.prop=n,this.originalValue=r,this.cellProperties=s,this.state=e.EditorState.VIRGIN},t.prototype.extend=function(){function e(){o.apply(this,arguments)}function t(e,t){function o(){}return o.prototype=t.prototype,e.prototype=new o,e.prototype.constructor=e,e}var o=this.constructor;return t(e,o)},t.prototype.saveValue=function(e,t){var o,n;t?(o=this.instance.getSelected(),o[0]>o[2]&&(n=o[0],o[0]=o[2],o[2]=n),o[1]>o[3]&&(n=o[1],o[1]=o[3],o[3]=n),this.instance.populateFromArray(o[0],o[1],e,o[2],o[3],"edit")):this.instance.populateFromArray(this.row,this.col,e,null,null,"edit")},t.prototype.beginEditing=function(t,o){this.state==e.EditorState.VIRGIN&&(this.instance.view.scrollViewport(new h(this.row,this.col)),this.instance.view.render(),this.state=e.EditorState.EDITING,t="string"==typeof t?t:this.originalValue,this.setValue(e.helper.stringify(t)),this.open(o),this._opened=!0,this.focus(),this.instance.view.render())},t.prototype.finishEditing=function(t,o,n){var i,r=this;if(n){var s=this._closeCallback;this._closeCallback=function(e){s&&s(e),n(e)}}if(!this.isWaiting()){if(this.state==e.EditorState.VIRGIN)return void this.instance._registerTimeout(setTimeout(function(){r._fireCallbacks(!0)},0));if(this.state==e.EditorState.EDITING){if(t)return this.cancelChanges(),void this.instance.view.render();i=this.instance.getSettings().trimWhitespace?[["string"==typeof this.getValue()?String.prototype.trim.call(this.getValue()||""):this.getValue()]]:[[this.getValue()]],this.state=e.EditorState.WAITING,this.saveValue(i,o),this.instance.getCellValidator(this.cellProperties)?this.instance.addHookOnce("postAfterValidate",function(t){r.state=e.EditorState.FINISHED,r.discardEditor(t)}):(this.state=e.EditorState.FINISHED,this.discardEditor(!0))}}},t.prototype.cancelChanges=function(){this.state=e.EditorState.FINISHED,this.discardEditor()},t.prototype.discardEditor=function(t){this.state===e.EditorState.FINISHED&&(t===!1&&this.cellProperties.allowInvalid!==!0?(this.instance.selectCell(this.row,this.col),this.focus(),this.state=e.EditorState.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this.state=e.EditorState.VIRGIN,this._fireCallbacks(!0)))},t.prototype.isOpened=function(){return this._opened},t.prototype.isWaiting=function(){return this.state===e.EditorState.WAITING},e.editors.BaseEditor=t}(t),function(e){var t=e.editors.BaseEditor.prototype.extend();t.prototype.init=function(){var t=this;this.createElements(),this.eventManager=new e.eventManager(this),this.bindEvents(),this.autoResize=L(),this.instance.addHook("afterDestroy",function(){t.destroy()})},t.prototype.getValue=function(){return this.TEXTAREA.value},t.prototype.setValue=function(e){this.TEXTAREA.value=e};var o=function(t){var o,n,i=this,r=i.getActiveEditor();if(o=e.helper.keyCode,n=(t.ctrlKey||t.metaKey)&&!t.altKey,e.Dom.enableImmediatePropagation(t),t.target===r.TEXTAREA&&!t.isImmediatePropagationStopped()){if(17===t.keyCode||224===t.keyCode||91===t.keyCode||93===t.keyCode)return void t.stopImmediatePropagation();switch(t.keyCode){case o.ARROW_RIGHT:e.Dom.getCaretPosition(r.TEXTAREA)!==r.TEXTAREA.value.length&&t.stopImmediatePropagation();break;case o.ARROW_LEFT:0!==e.Dom.getCaretPosition(r.TEXTAREA)&&t.stopImmediatePropagation();break;case o.ENTER:var s=r.instance.getSelected(),a=!(s[0]===s[2]&&s[1]===s[3]);if(n&&!a||t.altKey){if(r.isOpened()){var l=e.Dom.getCaretPosition(r.TEXTAREA),c=r.getValue(),u=c.slice(0,l)+"\n"+c.slice(l);r.setValue(u),e.Dom.setCaretPosition(r.TEXTAREA,l+1)}else r.beginEditing(r.originalValue+"\n");t.stopImmediatePropagation()}t.preventDefault();break;case o.A:case o.X:case o.C:case o.V:n&&t.stopImmediatePropagation();break;case o.BACKSPACE:case o.DELETE:case o.HOME:case o.END:t.stopImmediatePropagation()}r.autoResize.resize(String.fromCharCode(t.keyCode))}};t.prototype.open=function(){this.refreshDimensions(),this.instance.addHook("beforeKeyDown",o)},t.prototype.close=function(){this.textareaParentStyle.display="none",this.autoResize.unObserve(),document.activeElement===this.TEXTAREA&&this.instance.listen(),this.instance.removeHook("beforeKeyDown",o)},t.prototype.focus=function(){this.TEXTAREA.focus(),e.Dom.setCaretPosition(this.TEXTAREA,this.TEXTAREA.value.length)},t.prototype.createElements=function(){this.TEXTAREA=document.createElement("TEXTAREA"),e.Dom.addClass(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.TEXTAREA_PARENT=document.createElement("DIV"),e.Dom.addClass(this.TEXTAREA_PARENT,"handsontableInputHolder"),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.textareaParentStyle.top=0,this.textareaParentStyle.left=0,this.textareaParentStyle.display="none",this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.instance.rootElement.appendChild(this.TEXTAREA_PARENT);var t=this;this.instance._registerTimeout(setTimeout(function(){t.refreshDimensions()},0))},t.prototype.checkEditorSection=function(){return this.row<this.instance.getSettings().fixedRowsTop?this.col<this.instance.getSettings().fixedColumnsLeft?"corner":"top":this.col<this.instance.getSettings().fixedColumnsLeft?"left":void 0},t.prototype.getEditedCell=function(){var e,t=this.checkEditorSection();switch(t){case"top":e=this.instance.view.wt.wtScrollbars.vertical.clone.wtTable.getCell({row:this.row,col:this.col}),this.textareaParentStyle.zIndex=101;break;case"corner":e=this.instance.view.wt.wtScrollbars.corner.clone.wtTable.getCell({row:this.row,col:this.col}),this.textareaParentStyle.zIndex=103;break;case"left":e=this.instance.view.wt.wtScrollbars.horizontal.clone.wtTable.getCell({row:this.row,col:this.col}),this.textareaParentStyle.zIndex=102;break;default:e=this.instance.getCell(this.row,this.col),this.textareaParentStyle.zIndex=""}return-1!=e&&-2!=e?e:void 0},t.prototype.refreshDimensions=function(){if(this.state===e.EditorState.EDITING&&(this.TD=this.getEditedCell(),this.TD)){var t,o=e.Dom.offset(this.TD),n=e.Dom.offset(this.instance.rootElement),i=o.top-n.top-1,r=o.left-n.left-1,s=this.instance.getSettings(),a=s.rowHeaders?1:0,l=s.colHeaders?1:0,c=this.checkEditorSection();switch(c){case"top":t=e.Dom.getCssTransform(this.instance.view.wt.wtScrollbars.vertical.clone.wtTable.holder.parentNode);break;case"left":t=e.Dom.getCssTransform(this.instance.view.wt.wtScrollbars.horizontal.clone.wtTable.holder.parentNode);break;case"corner":t=e.Dom.getCssTransform(this.instance.view.wt.wtScrollbars.corner.clone.wtTable.holder.parentNode)}0>i&&(i=0),0>r&&(r=0),l&&0===this.instance.getSelected()[0]&&(i+=1),t&&-1!=t?this.textareaParentStyle[t[0]]=t[1]:e.Dom.resetCssTransform(this.textareaParentStyle),this.textareaParentStyle.top=i+"px",this.textareaParentStyle.left=r+"px";var u=this.TD.offsetTop-this.instance.view.wt.wtScrollbars.vertical.getScrollPosition(),h=this.TD.offsetLeft-this.instance.view.wt.wtScrollbars.horizontal.getScrollPosition(),d=e.Dom.innerWidth(this.TD)-8,f=this.instance.view.maximumVisibleElementWidth(h)-8,p=this.TD.scrollHeight+1,m=this.instance.view.maximumVisibleElementHeight(u)-2;parseInt(this.TD.style.borderTopWidth,10)>0&&(p-=1),parseInt(this.TD.style.borderLeftWidth,10)>0&&a>0&&(d-=1),this.TEXTAREA.style.fontSize=e.Dom.getComputedStyle(this.TD).fontSize,this.TEXTAREA.style.fontFamily=e.Dom.getComputedStyle(this.TD).fontFamily,this.autoResize.init(this.TEXTAREA,{minHeight:Math.min(p,m),maxHeight:m,minWidth:Math.min(d,f),maxWidth:f},!0),this.textareaParentStyle.display="block"}},t.prototype.bindEvents=function(){var t=this;this.eventManager.addEventListener(this.TEXTAREA,"cut",function(t){e.helper.stopPropagation(t)}),this.eventManager.addEventListener(this.TEXTAREA,"paste",function(t){e.helper.stopPropagation(t)}),this.instance.addHook("afterScrollVertically",function(){t.refreshDimensions()}),this.instance.addHook("afterColumnResize",function(){t.refreshDimensions(),t.focus()}),this.instance.addHook("afterRowResize",function(){t.refreshDimensions(),t.focus()}),this.instance.addHook("afterDestroy",function(){t.eventManager.clear()})},t.prototype.destroy=function(){this.eventManager.clear()},e.editors.TextEditor=t,e.editors.registerEditor("text",e.editors.TextEditor)}(t),function(t){var o=t.editors.BaseEditor.prototype.extend(),n={},i=function(){this.controls={},this.controls.leftButton=document.createElement("DIV"),this.controls.leftButton.className="leftButton",this.controls.rightButton=document.createElement("DIV"),this.controls.rightButton.className="rightButton",this.controls.upButton=document.createElement("DIV"),this.controls.upButton.className="upButton",this.controls.downButton=document.createElement("DIV"),this.controls.downButton.className="downButton";for(var e in this.controls)this.controls.hasOwnProperty(e)&&this.positionControls.appendChild(this.controls[e])};o.prototype.valueChanged=function(){return this.initValue!=this.getValue()},o.prototype.init=function(){var e=this;this.eventManager=new t.eventManager(this.instance),this.createElements(),this.bindEvents(),this.instance.addHook("afterDestroy",function(){e.destroy()})},o.prototype.getValue=function(){return this.TEXTAREA.value},o.prototype.setValue=function(e){this.initValue=e,this.TEXTAREA.value=e},o.prototype.createElements=function(){this.editorContainer=document.createElement("DIV"),this.editorContainer.className="htMobileEditorContainer",this.cellPointer=document.createElement("DIV"),this.cellPointer.className="cellPointer",this.moveHandle=document.createElement("DIV"),this.moveHandle.className="moveHandle",this.inputPane=document.createElement("DIV"),this.inputPane.className="inputs",this.positionControls=document.createElement("DIV"),this.positionControls.className="positionControls",this.TEXTAREA=document.createElement("TEXTAREA"),t.Dom.addClass(this.TEXTAREA,"handsontableInput"),this.inputPane.appendChild(this.TEXTAREA),this.editorContainer.appendChild(this.cellPointer),this.editorContainer.appendChild(this.moveHandle),this.editorContainer.appendChild(this.inputPane),this.editorContainer.appendChild(this.positionControls),i.call(this),document.body.appendChild(this.editorContainer)},o.prototype.onBeforeKeyDown=function(e){var o=this,n=o.getActiveEditor();if(t.Dom.enableImmediatePropagation(e),e.target===n.TEXTAREA&&!e.isImmediatePropagationStopped()){var i=t.helper.keyCode;switch(e.keyCode){case i.ENTER:n.close(),e.preventDefault();break;case i.BACKSPACE:e.stopImmediatePropagation()}}},o.prototype.open=function(){this.instance.addHook("beforeKeyDown",this.onBeforeKeyDown),t.Dom.addClass(this.editorContainer,"active"),t.Dom.removeClass(this.cellPointer,"hidden"),this.updateEditorPosition()},o.prototype.focus=function(){this.TEXTAREA.focus(),t.Dom.setCaretPosition(this.TEXTAREA,this.TEXTAREA.value.length)},o.prototype.close=function(){this.TEXTAREA.blur(),this.instance.removeHook("beforeKeyDown",this.onBeforeKeyDown),t.Dom.removeClass(this.editorContainer,"active")},o.prototype.scrollToView=function(){var e=this.instance.getSelectedRange().highlight;this.instance.view.scrollViewport(e)},o.prototype.hideCellPointer=function(){t.Dom.hasClass(this.cellPointer,"hidden")||t.Dom.addClass(this.cellPointer,"hidden")},o.prototype.updateEditorPosition=function(o,i){if(o&&i)o=parseInt(o,10),i=parseInt(i,10),this.editorContainer.style.top=i+"px",this.editorContainer.style.left=o+"px";else{var r=this.instance.getSelected(),s=this.instance.getCell(r[0],r[1]);if(n.cellPointer||(n.cellPointer={height:t.Dom.outerHeight(this.cellPointer),width:t.Dom.outerWidth(this.cellPointer)}),n.editorContainer||(n.editorContainer={width:t.Dom.outerWidth(this.editorContainer)}),void 0!==s){var a=this.instance.view.wt.wtScrollbars.horizontal.scrollHandler==e?0:t.Dom.getScrollLeft(this.instance.view.wt.wtScrollbars.horizontal.scrollHandler),l=this.instance.view.wt.wtScrollbars.vertical.scrollHandler==e?0:t.Dom.getScrollTop(this.instance.view.wt.wtScrollbars.vertical.scrollHandler),c=t.Dom.offset(s),u=t.Dom.outerWidth(s),h={x:a,y:l};this.editorContainer.style.top=parseInt(c.top+t.Dom.outerHeight(s)-h.y+n.cellPointer.height,10)+"px",this.editorContainer.style.left=parseInt(e.innerWidth/2-n.editorContainer.width/2,10)+"px",c.left+u/2>parseInt(this.editorContainer.style.left,10)+n.editorContainer.width?this.editorContainer.style.left=e.innerWidth-n.editorContainer.width+"px":c.left+u/2<parseInt(this.editorContainer.style.left,10)+20&&(this.editorContainer.style.left="0px"),this.cellPointer.style.left=parseInt(c.left-n.cellPointer.width/2-t.Dom.offset(this.editorContainer).left+u/2-h.x,10)+"px"}}},o.prototype.updateEditorData=function(){var e=this.instance.getSelected(),t=this.instance.getDataAtCell(e[0],e[1]);this.row=e[0],this.col=e[1],this.setValue(t),this.updateEditorPosition()},o.prototype.prepareAndSave=function(){var e;return this.valueChanged()?(e=this.instance.getSettings().trimWhitespace?[[String.prototype.trim.call(this.getValue())]]:[[this.getValue()]],void this.saveValue(e)):!0},o.prototype.bindEvents=function(){var o=this;this.eventManager.addEventListener(this.controls.leftButton,"touchend",function(e){o.prepareAndSave(),o.instance.selection.transformStart(0,-1,null,!0),o.updateEditorData(),e.preventDefault()}),this.eventManager.addEventListener(this.controls.rightButton,"touchend",function(e){o.prepareAndSave(),o.instance.selection.transformStart(0,1,null,!0),o.updateEditorData(),e.preventDefault()}),this.eventManager.addEventListener(this.controls.upButton,"touchend",function(e){o.prepareAndSave(),o.instance.selection.transformStart(-1,0,null,!0),o.updateEditorData(),e.preventDefault()}),this.eventManager.addEventListener(this.controls.downButton,"touchend",function(e){o.prepareAndSave(),o.instance.selection.transformStart(1,0,null,!0),o.updateEditorData(),e.preventDefault()}),this.eventManager.addEventListener(this.moveHandle,"touchstart",function(e){if(1==e.touches.length){var t=e.touches[0],n={x:o.editorContainer.offsetLeft,y:o.editorContainer.offsetTop},i={x:t.pageX-n.x,y:t.pageY-n.y};o.eventManager.addEventListener(this,"touchmove",function(e){var t=e.touches[0];o.updateEditorPosition(t.pageX-i.x,t.pageY-i.y),o.hideCellPointer(),e.preventDefault()})}}),this.eventManager.addEventListener(document.body,"touchend",function(e){t.Dom.isChildOf(e.target,o.editorContainer)||t.Dom.isChildOf(e.target,o.instance.rootElement)||o.close()}),this.eventManager.addEventListener(this.instance.view.wt.wtScrollbars.horizontal.scrollHandler,"scroll",function(t){o.instance.view.wt.wtScrollbars.horizontal.scrollHandler!=e&&o.hideCellPointer()}),this.eventManager.addEventListener(this.instance.view.wt.wtScrollbars.vertical.scrollHandler,"scroll",function(t){o.instance.view.wt.wtScrollbars.vertical.scrollHandler!=e&&o.hideCellPointer()})},o.prototype.destroy=function(){this.eventManager.clear(),this.editorContainer.parentNode.removeChild(this.editorContainer)},t.editors.MobileTextEditor=o,t.editors.registerEditor("mobile",t.editors.MobileTextEditor)}(t),function(e){var t=e.editors.BaseEditor.prototype.extend();t.prototype.beginEditing=function(){var e=this.TD.querySelector('input[type="checkbox"]');e&&e.click()},t.prototype.finishEditing=function(){},t.prototype.init=function(){},t.prototype.open=function(){},t.prototype.close=function(){},t.prototype.getValue=function(){},t.prototype.setValue=function(){},t.prototype.focus=function(){},e.editors.CheckboxEditor=t,e.editors.registerEditor("checkbox",t)}(t),function(t){var o=t.editors.TextEditor.prototype.extend();o.prototype.init=function(){if("function"!=typeof moment)throw new Error("You need to include moment.js to your project.");if("function"!=typeof Pikaday)throw new Error("You need to include Pikaday to your project.");t.editors.TextEditor.prototype.init.apply(this,arguments),this.isCellEdited=!1;var e=this;this.instance.addHook("afterDestroy",function(){e.parentDestroyed=!0,e.destroyElements()})},o.prototype.createElements=function(){var e=this;t.editors.TextEditor.prototype.createElements.apply(this,arguments),this.defaultDateFormat="DD/MM/YYYY",this.datePicker=document.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,t.Dom.addClass(this.datePicker,"htDatepickerHolder"),document.body.appendChild(this.datePicker);var o=this.TEXTAREA,n={format:e.defaultDateFormat,field:o,trigger:o,container:e.datePicker,reposition:!1,bound:!1,onSelect:function(t){isNaN(t.getTime())||(t=moment(t).format(e.cellProperties.dateFormat||e.defaultDateFormat)),e.setValue(t),e.hideDatepicker()},onClose:function(){e.parentDestroyed||e.finishEditing(!1)}};this.$datePicker=new Pikaday(n);var i=t.eventManager(this);i.addEventListener(this.datePicker,"mousedown",function(e){t.helper.stopPropagation(e)}),this.hideDatepicker()},o.prototype.destroyElements=function(){this.$datePicker.destroy()},o.prototype.prepare=function(){this._opened=!1,t.editors.TextEditor.prototype.prepare.apply(this,arguments)},o.prototype.open=function(e){t.editors.TextEditor.prototype.open.call(this),this.showDatepicker(e)},o.prototype.close=function(){var e=this;this._opened=!1,this.instance._registerTimeout(setTimeout(function(){e.instance.selection.refreshBorders()},0)),t.editors.TextEditor.prototype.close.apply(this,arguments)},o.prototype.finishEditing=function(e,o){if(e){var n=this.originalValue;void 0!==n&&this.setValue(n)}this.hideDatepicker(),t.editors.TextEditor.prototype.finishEditing.apply(this,arguments)},o.prototype.showDatepicker=function(o){var n,i=this.TD.getBoundingClientRect(),r=this.cellProperties.dateFormat||this.defaultDateFormat,s=this.$datePicker.config(),a=this.instance.view.isMouseDown(),l=o?t.helper.isMetaKey(o.keyCode):!1;this.datePickerStyle.top=e.pageYOffset+i.top+t.Dom.outerHeight(this.TD)+"px",this.datePickerStyle.left=e.pageXOffset+i.left+"px",this.$datePicker._onInputFocus=function(){},s.format=r,this.originalValue?(n=this.originalValue,moment(n,r,!0).isValid()&&this.$datePicker.setMoment(moment(n,r),!0),l||a||this.setValue("")):this.cellProperties.defaultDate&&(n=this.cellProperties.defaultDate,s.defaultDate=n,moment(n,r,!0).isValid()&&this.$datePicker.setMoment(moment(n,r),!0),l||a||this.setValue("")),this.datePickerStyle.display="block",this.$datePicker.show()},o.prototype.hideDatepicker=function(){this.datePickerStyle.display="none",this.$datePicker.hide()},t.editors.DateEditor=o,t.editors.registerEditor("date",o)}(t),function(e){var t=e.editors.TextEditor.prototype.extend();t.prototype.createElements=function(){e.editors.TextEditor.prototype.createElements.apply(this,arguments);var t=document.createElement("DIV");t.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(t),this.htContainer=t,this.htEditor=new e(t),this.assignHooks()},t.prototype.prepare=function(t,o,n,i,r,s){e.editors.TextEditor.prototype.prepare.apply(this,arguments);var a=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,cells:function(){return{readOnly:!0}},fillHandle:!1,afterOnCellMouseDown:function(){var e=this.getValue();void 0!==e&&a.setValue(e),a.instance.destroyEditor()}};this.cellProperties.handsontable&&e.helper.extend(l,s.handsontable),this.htEditor&&this.htEditor.destroy(),this.htEditor=new e(this.htContainer,l)};var o=function(t){if(null!=t&&null==t.isImmediatePropagationEnabled&&(t.stopImmediatePropagation=function(){this.isImmediatePropagationEnabled=!1,this.cancelBubble=!0},t.isImmediatePropagationEnabled=!0,t.isImmediatePropagationStopped=function(){return!this.isImmediatePropagationEnabled}),!t.isImmediatePropagationStopped()){var o,n=this.getActiveEditor(),i=n.htEditor.getInstance();if(t.keyCode==e.helper.keyCode.ARROW_DOWN)if(i.getSelected()){var r=i.getSelected()[0],s=i.countRows()-1;o=Math.min(s,r+1)}else o=0;else if(t.keyCode==e.helper.keyCode.ARROW_UP&&i.getSelected()){var r=i.getSelected()[0];o=r-1}void 0!==o&&(0>o?i.deselectCell():i.selectCell(o,0),t.preventDefault(),t.stopImmediatePropagation(),n.instance.listen(),n.TEXTAREA.focus())}};t.prototype.open=function(){this.instance.addHook("beforeKeyDown",o),e.editors.TextEditor.prototype.open.apply(this,arguments),this.htEditor.render(),this.cellProperties.strict?(this.htEditor.selectCell(0,0),this.TEXTAREA.style.visibility="hidden"):(this.htEditor.deselectCell(),this.TEXTAREA.style.visibility="visible"),e.Dom.setCaretPosition(this.TEXTAREA,0,this.TEXTAREA.value.length)},t.prototype.close=function(){this.instance.removeHook("beforeKeyDown",o),this.instance.listen(),e.editors.TextEditor.prototype.close.apply(this,arguments)},t.prototype.focus=function(){this.instance.listen(),e.editors.TextEditor.prototype.focus.apply(this,arguments)},t.prototype.beginEditing=function(t){var o=this.instance.getSettings().onBeginEditing;o&&o()===!1||e.editors.TextEditor.prototype.beginEditing.apply(this,arguments)},t.prototype.finishEditing=function(t,o){if(this.htEditor.isListening()&&this.instance.listen(),this.htEditor.getSelected()){var n=this.htEditor.getInstance().getValue();void 0!==n&&this.setValue(n)}return e.editors.TextEditor.prototype.finishEditing.apply(this,arguments)},t.prototype.assignHooks=function(){var e=this;this.instance.addHook("afterDestroy",function(){e.htEditor&&e.htEditor.destroy()})},e.editors.HandsontableEditor=t,e.editors.registerEditor("handsontable",t)}(t),function(t){var o=t.editors.HandsontableEditor.prototype.extend();o.prototype.init=function(){t.editors.HandsontableEditor.prototype.init.apply(this,arguments);var e=this.htEditor.getInstance();e.updateSettings({height:1}),this.query=null,this.choices=[]},o.prototype.createElements=function(){t.editors.HandsontableEditor.prototype.createElements.apply(this,arguments);var o=function(){return-1!=e.navigator.platform.indexOf("Mac")?"htMacScroll":""};t.Dom.addClass(this.htContainer,"autocompleteEditor"),t.Dom.addClass(this.htContainer,o())};var n=!1,i=function(e){n=!1;var o=this.getActiveEditor(),i=t.helper.keyCode;if(t.helper.isPrintableChar(e.keyCode)||e.keyCode===i.BACKSPACE||e.keyCode===i.DELETE||e.keyCode===i.INSERT){var r=0;if(e.keyCode===i.C&&(e.ctrlKey||e.metaKey))return;o.isOpened()||(r+=10),o.instance._registerTimeout(setTimeout(function(){o.queryChoices(o.TEXTAREA.value),n=!0},r))}};o.prototype.prepare=function(){this.instance.addHook("beforeKeyDown",i),t.editors.HandsontableEditor.prototype.prepare.apply(this,arguments)},o.prototype.open=function(){t.editors.HandsontableEditor.prototype.open.apply(this,arguments),this.TEXTAREA.style.visibility="visible",this.focus(),this.htContainer.style.overflow="hidden";var e=this.htEditor.getInstance(),o=this;e.updateSettings({colWidths:[t.Dom.outerWidth(this.TEXTAREA)-2],afterRenderer:function(e,t,n,i,r){var s=this.getCellMeta(t,n).filteringCaseSensitive===!0;if(r){var a=s?r.indexOf(this.query):r.toLowerCase().indexOf(o.query.toLowerCase());if(-1!=a){var l=r.substr(a,o.query.length);e.innerHTML=r.replace(l,"<strong>"+l+"</strong>")}}}}),n&&(n=!1),o.instance._registerTimeout(setTimeout(function(){o.queryChoices(o.TEXTAREA.value),o.htContainer.style.overflow="auto"},0))},o.prototype.close=function(){t.editors.HandsontableEditor.prototype.close.apply(this,arguments)},o.prototype.queryChoices=function(e){if(this.query=e,"function"==typeof this.cellProperties.source){var t=this;this.cellProperties.source(e,function(e){t.updateChoicesList(e)})}else if(Array.isArray(this.cellProperties.source)){var o;if(e&&this.cellProperties.filter!==!1){var n=this.cellProperties.filteringCaseSensitive===!0,i=e.toLowerCase();o=this.cellProperties.source.filter(function(t){return n?-1!=t.indexOf(e):-1!=t.toLowerCase().indexOf(i)})}else o=this.cellProperties.source;this.updateChoicesList(o)}else this.updateChoicesList([])},o.prototype.updateChoicesList=function(e){var n,i=t.Dom.getCaretPosition(this.TEXTAREA),r=t.Dom.getSelectionEndPosition(this.TEXTAREA),s=o.sortByRelevance(this.getValue(),e,this.cellProperties.filteringCaseSensitive);if(0!=this.cellProperties.filter){for(var a=[],l=0,c=s.length;c>l;l++)a.push(e[s[l]]);n=0,e=a}else n=s[0];this.choices=e,this.htEditor.loadData(t.helper.pivot([e])),this.htEditor.updateSettings({height:this.getDropdownHeight()}),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(n),this.instance.listen(),this.TEXTAREA.focus(),t.Dom.setCaretPosition(this.TEXTAREA,i,i!=r?r:void 0)},o.prototype.finishEditing=function(e){e||this.instance.removeHook("beforeKeyDown",i),t.editors.HandsontableEditor.prototype.finishEditing.apply(this,arguments)},o.prototype.highlightBestMatchingChoice=function(e){"number"==typeof e?this.htEditor.selectCell(e,0):this.htEditor.deselectCell()},o.sortByRelevance=function(e,t,o){var n,i,r,s,a,l=[],c=e.length,u=[];if(0===c){for(s=0,a=t.length;a>s;s++)u.push(s);return u}for(s=0,a=t.length;a>s;s++)n=t[s],i=o?n.indexOf(e):n.toLowerCase().indexOf(e.toLowerCase()),-1!=i&&(r=n.length-i-c,l.push({baseIndex:s,index:i,charsLeft:r,value:n}));for(l.sort(function(e,t){return-1===t.index?-1:-1===e.index?1:e.index<t.index?-1:t.index<e.index?1:e.index===t.index?e.charsLeft<t.charsLeft?-1:e.charsLeft>t.charsLeft?1:0:void 0}),s=0,a=l.length;a>s;s++)u.push(l[s].baseIndex);return u},o.prototype.getDropdownHeight=function(){var e=this.htEditor.getInstance().getRowHeight(0)||23;return this.choices.length>=10?10*e:this.choices.length*e+8},t.editors.AutocompleteEditor=o,t.editors.registerEditor("autocomplete",o)}(t),function(e){var t=e.editors.TextEditor.prototype.extend();t.prototype.createElements=function(){e.editors.TextEditor.prototype.createElements.apply(this,arguments),this.TEXTAREA=document.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,e.Dom.empty(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)},e.editors.PasswordEditor=t,e.editors.registerEditor("password",t)}(t),function(e){var t=e.editors.BaseEditor.prototype.extend();t.prototype.init=function(){this.select=document.createElement("SELECT"),e.Dom.addClass(this.select,"htSelectEditor"),this.select.style.display="none",this.instance.rootElement.appendChild(this.select)},t.prototype.prepare=function(){e.editors.BaseEditor.prototype.prepare.apply(this,arguments);var t,o=this.cellProperties.selectOptions;t="function"==typeof o?this.prepareOptions(o(this.row,this.col,this.prop)):this.prepareOptions(o),e.Dom.empty(this.select);for(var n in t)if(t.hasOwnProperty(n)){var i=document.createElement("OPTION");i.value=n,e.Dom.fastInnerHTML(i,t[n]),this.select.appendChild(i)}},t.prototype.prepareOptions=function(e){var t={};if(Array.isArray(e))for(var o=0,n=e.length;n>o;o++)t[e[o]]=e[o];else"object"==typeof e&&(t=e);return t},t.prototype.getValue=function(){return this.select.value},t.prototype.setValue=function(e){this.select.value=e};var o=function(t){var o=this,n=o.getActiveEditor();switch(t.keyCode){case e.helper.keyCode.ARROW_UP:var i=n.select.find("option:selected").prev();1==i.length&&i.prop("selected",!0),t.stopImmediatePropagation(),t.preventDefault();break;case e.helper.keyCode.ARROW_DOWN:var r=n.select.find("option:selected").next();1==r.length&&r.prop("selected",!0),t.stopImmediatePropagation(),t.preventDefault()}};t.prototype.checkEditorSection=function(){return this.row<this.instance.getSettings().fixedRowsTop?this.col<this.instance.getSettings().fixedColumnsLeft?"corner":"top":this.col<this.instance.getSettings().fixedColumnsLeft?"left":void 0},t.prototype.open=function(){var t,n=e.Dom.outerWidth(this.TD),i=e.Dom.outerHeight(this.TD),r=e.Dom.offset(this.instance.rootElement),s=e.Dom.offset(this.TD),a=this.checkEditorSection();switch(a){case"top":t=e.Dom.getCssTransform(this.instance.view.wt.wtScrollbars.vertical.clone.wtTable.holder.parentNode);break;case"left":t=e.Dom.getCssTransform(this.instance.view.wt.wtScrollbars.horizontal.clone.wtTable.holder.parentNode);break;case"corner":t=e.Dom.getCssTransform(this.instance.view.wt.wtScrollbars.corner.clone.wtTable.holder.parentNode)}var l=this.select.style;t&&-1!=t?l[t[0]]=t[1]:e.Dom.resetCssTransform(this.select),l.height=i+"px",l.minWidth=n+"px",l.top=s.top-r.top+"px",l.left=s.left-r.left+"px",l.margin="0px",l.display="",this.instance.addHook("beforeKeyDown",o)},t.prototype.close=function(){this.select.style.display="none",this.instance.removeHook("beforeKeyDown",o)},t.prototype.focus=function(){this.select.focus()},e.editors.SelectEditor=t,e.editors.registerEditor("select",t)}(t),function(e){var t=e.editors.AutocompleteEditor.prototype.extend();t.prototype.prepare=function(){e.editors.AutocompleteEditor.prototype.prepare.apply(this,arguments),this.cellProperties.filter=!1,this.cellProperties.strict=!0},e.editors.DropdownEditor=t,e.editors.registerEditor("dropdown",t)}(t),function(e){var t=e.editors.TextEditor.prototype.extend();t.prototype.beginEditing=function(t){var o=e.editors.TextEditor.prototype;if("undefined"==typeof t&&this.originalValue){var n=""+this.originalValue;"undefined"!=typeof this.cellProperties.language&&numeral.language(this.cellProperties.language);var i=numeral.languageData().delimiters.decimal;n=n.replace(".",i),o.beginEditing.apply(this,[n])}else o.beginEditing.apply(this,arguments)},e.editors.NumericEditor=t,e.editors.registerEditor("numeric",t)}(t),t.NumericValidator=function(e,t){null===e&&(e=""),t(/^-?\d*(\.|\,)?\d*$/.test(e))},t.DateValidator=function(e,o){var n=null,i=!0,r=t.editors.getEditor("date",this.instance);null===e&&(e="");var s=moment(new Date(e)).isValid(),a=moment(e,this.dateFormat||r.defaultDateFormat,!0).isValid();s||(i=!1),!s&&a&&(i=!0),s&&!a&&(this.correctFormat===!0?(n=N(e,this.dateFormat),this.instance.setDataAtCell(this.row,this.col,n,"dateValidator"),
i=!0):i=!1),o(i)};var N=function(e,t){return e=moment(new Date(e)).format(t)},M=function(e,t){var o=e,n="string"==typeof o?o.toLowerCase():null;return function(e){for(var i=!1,r=0,s=e.length;s>r;r++){if(o===e[r]){i=!0;break}if(n===e[r].toLowerCase()){i=!0;break}}t(i)}};t.AutocompleteValidator=function(e,t){this.strict&&this.source?"function"==typeof this.source?this.source(e,M(e,t)):M(e,t)(this.source):t(!0)},t.mobileBrowser=t.helper.isMobileBrowser(),t.AutocompleteCell={editor:t.editors.AutocompleteEditor,renderer:t.renderers.AutocompleteRenderer,validator:t.AutocompleteValidator},t.CheckboxCell={editor:t.editors.CheckboxEditor,renderer:t.renderers.CheckboxRenderer},t.TextCell={editor:t.mobileBrowser?t.editors.MobileTextEditor:t.editors.TextEditor,renderer:t.renderers.TextRenderer},t.NumericCell={editor:t.editors.NumericEditor,renderer:t.renderers.NumericRenderer,validator:t.NumericValidator,dataType:"number"},t.DateCell={editor:t.editors.DateEditor,validator:t.DateValidator,renderer:t.renderers.AutocompleteRenderer},t.HandsontableCell={editor:t.editors.HandsontableEditor,renderer:t.renderers.AutocompleteRenderer},t.PasswordCell={editor:t.editors.PasswordEditor,renderer:t.renderers.PasswordRenderer,copyable:!1},t.DropdownCell={editor:t.editors.DropdownEditor,renderer:t.renderers.AutocompleteRenderer,validator:t.AutocompleteValidator},t.cellTypes={text:t.TextCell,date:t.DateCell,numeric:t.NumericCell,checkbox:t.CheckboxCell,autocomplete:t.AutocompleteCell,handsontable:t.HandsontableCell,password:t.PasswordCell,dropdown:t.DropdownCell},t.cellLookup={validator:{numeric:t.NumericValidator,autocomplete:t.AutocompleteValidator}};/**
 * autoResize - resizes a DOM element to the width and height of another DOM element
 *
 * Copyright 2014, Marcin Warpechowski
 * Licensed under the MIT license
 */
var L=function(){var o,n={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},i=document.body,r=document.createTextNode(""),s=document.createElement("SPAN"),a=function(t,o,n){e.attachEvent?t.attachEvent("on"+o,n):t.addEventListener(o,n,!1)},l=function(t,o,n){e.removeEventListener?t.removeEventListener(o,n,!1):t.detachEvent("on"+o,n)},c=function(e){var a,l;e?/^[a-zA-Z \.,\\\/\|0-9]$/.test(e)||(e="."):e="",void 0!==r.textContent?r.textContent=o.value+e:r.data=o.value+e,s.style.fontSize=t.Dom.getComputedStyle(o).fontSize,s.style.fontFamily=t.Dom.getComputedStyle(o).fontFamily,s.style.whiteSpace="pre",i.appendChild(s),a=s.clientWidth+2,i.removeChild(s),o.style.height=n.minHeight+"px",n.minWidth>a?o.style.width=n.minWidth+"px":a>n.maxWidth?o.style.width=n.maxWidth+"px":o.style.width=a+"px",l=o.scrollHeight?o.scrollHeight-1:0,n.minHeight>l?o.style.height=n.minHeight+"px":n.maxHeight<l?(o.style.height=n.maxHeight+"px",o.style.overflowY="visible"):o.style.height=l+"px"},u=function(){e.setTimeout(c,0)},h=function(e){if(e&&e.minHeight)if("inherit"==e.minHeight)n.minHeight=o.clientHeight;else{var t=parseInt(e.minHeight);isNaN(t)||(n.minHeight=t)}if(e&&e.maxHeight)if("inherit"==e.maxHeight)n.maxHeight=o.clientHeight;else{var i=parseInt(e.maxHeight);isNaN(i)||(n.maxHeight=i)}if(e&&e.minWidth)if("inherit"==e.minWidth)n.minWidth=o.clientWidth;else{var a=parseInt(e.minWidth);isNaN(a)||(n.minWidth=a)}if(e&&e.maxWidth)if("inherit"==e.maxWidth)n.maxWidth=o.clientWidth;else{var l=parseInt(e.maxWidth);isNaN(l)||(n.maxWidth=l)}s.firstChild||(s.className="autoResize",s.style.display="inline-block",s.appendChild(r))},d=function(e,t,i){o=e,h(t),"TEXTAREA"==o.nodeName&&(o.style.resize="none",o.style.overflowY="",o.style.height=n.minHeight+"px",o.style.minWidth=n.minWidth+"px",o.style.maxWidth=n.maxWidth+"px",o.style.overflowY="hidden"),i&&(a(o,"change",c),a(o,"cut",u),a(o,"paste",u),a(o,"drop",u),a(o,"keydown",u)),c()};return{init:function(e,t,o){d(e,t,o)},unObserve:function(){l(o,"change",c),l(o,"cut",u),l(o,"paste",u),l(o,"drop",u),l(o,"keydown",u)},resize:c}};/**
 * SheetClip - Spreadsheet Clipboard Parser
 * version 0.2
 *
 * This tiny library transforms JavaScript arrays to strings that are pasteable by LibreOffice, OpenOffice,
 * Google Docs and Microsoft Excel.
 *
 * Copyright 2012, Marcin Warpechowski
 * Licensed under the MIT license.
 * http://github.com/warpech/sheetclip/
 */
!function(e){function t(e){return e.split('"').length-1}e.SheetClip={parse:function(e){var o,n,i,r,s,a,l,c=[],u=0;for(i=e.split("\n"),i.length>1&&""===i[i.length-1]&&i.pop(),o=0,n=i.length;n>o;o+=1){for(i[o]=i[o].split("	"),r=0,s=i[o].length;s>r;r+=1)c[u]||(c[u]=[]),a&&0===r?(l=c[u].length-1,c[u][l]=c[u][l]+"\n"+i[o][0],a&&1&t(i[o][0])&&(a=!1,c[u][l]=c[u][l].substring(0,c[u][l].length-1).replace(/""/g,'"'))):r===s-1&&0===i[o][r].indexOf('"')?(c[u].push(i[o][r].substring(1).replace(/""/g,'"')),a=!0):(c[u].push(i[o][r].replace(/""/g,'"')),a=!1);a||(u+=1)}return c},stringify:function(e){var t,o,n,i,r,s="";for(t=0,o=e.length;o>t;t+=1){for(i=e[t].length,n=0;i>n;n+=1)n>0&&(s+="	"),r=e[t][n],s+="string"==typeof r?r.indexOf("\n")>-1?'"'+r.replace(/"/g,'""')+'"':r:null===r||void 0===r?"":r;s+="\n"}return s}}}(e);var I=function(){var e;return{getInstance:function(){return e?e.hasBeenDestroyed()&&e.init():e=new o,e.refCounter++,e}}}();o.prototype.init=function(){var e,o;this.copyCallbacks=[],this.cutCallbacks=[],this.pasteCallbacks=[],this._eventManager=t.eventManager(this),o=document.body,document.getElementById("CopyPasteDiv")?(this.elDiv=document.getElementById("CopyPasteDiv"),this.elTextarea=this.elDiv.firstChild):(this.elDiv=document.createElement("DIV"),this.elDiv.id="CopyPasteDiv",e=this.elDiv.style,e.position="fixed",e.top="-10000px",e.left="-10000px",o.appendChild(this.elDiv),this.elTextarea=document.createElement("TEXTAREA"),this.elTextarea.className="copyPaste",this.elTextarea.onpaste=function(e){return"WebkitAppearance"in document.documentElement.style?(this.value=e.clipboardData.getData("Text"),!1):void 0},e=this.elTextarea.style,e.width="10000px",e.height="10000px",e.overflow="hidden",this.elDiv.appendChild(this.elTextarea),"undefined"!=typeof e.opacity&&(e.opacity=0)),this.keyDownRemoveEvent=this._eventManager.addEventListener(document.documentElement,"keydown",this.onKeyDown.bind(this),!1)},o.prototype.onKeyDown=function(e){var t=this,o=!1;if(e.metaKey?o=!0:e.ctrlKey&&-1===navigator.userAgent.indexOf("Mac")&&(o=!0),o){if(document.activeElement!==this.elTextarea&&(""!==this.getSelectionText()||-1!==["INPUT","SELECT","TEXTAREA"].indexOf(document.activeElement.nodeName)))return;this.selectNodeText(this.elTextarea),setTimeout(function(){t.selectNodeText(t.elTextarea)},0)}!o||67!==e.keyCode&&86!==e.keyCode&&88!==e.keyCode||(88===e.keyCode?setTimeout(function(){t.triggerCut(e)},0):86===e.keyCode&&setTimeout(function(){t.triggerPaste(e)},0))},o.prototype.selectNodeText=function(e){e&&e.select()},o.prototype.getSelectionText=function(){var t="";return e.getSelection?t=e.getSelection().toString():document.selection&&"Control"!=document.selection.type&&(t=document.selection.createRange().text),t},o.prototype.copyable=function(e){if("string"!=typeof e&&void 0===e.toString)throw new Error("copyable requires string parameter");this.elTextarea.value=e},o.prototype.onCut=function(e){this.cutCallbacks.push(e)},o.prototype.onPaste=function(e){this.pasteCallbacks.push(e)},o.prototype.removeCallback=function(e){var t,o;for(t=0,o=this.copyCallbacks.length;o>t;t++)if(this.copyCallbacks[t]===e)return this.copyCallbacks.splice(t,1),!0;for(t=0,o=this.cutCallbacks.length;o>t;t++)if(this.cutCallbacks[t]===e)return this.cutCallbacks.splice(t,1),!0;for(t=0,o=this.pasteCallbacks.length;o>t;t++)if(this.pasteCallbacks[t]===e)return this.pasteCallbacks.splice(t,1),!0;return!1},o.prototype.triggerCut=function(e){var t=this;t.cutCallbacks&&setTimeout(function(){for(var o=0,n=t.cutCallbacks.length;n>o;o++)t.cutCallbacks[o](e)},50)},o.prototype.triggerPaste=function(e,t){var o=this;o.pasteCallbacks&&setTimeout(function(){for(var n=t||o.elTextarea.value,i=0,r=o.pasteCallbacks.length;r>i;i++)o.pasteCallbacks[i](n,e)},50)},o.prototype.destroy=function(){this.hasBeenDestroyed()||0!==--this.refCounter||(this.elDiv&&this.elDiv.parentNode&&(this.elDiv.parentNode.removeChild(this.elDiv),this.elDiv=null,this.elTextarea=null),this.keyDownRemoveEvent())},o.prototype.hasBeenDestroyed=function(){return!this.refCounter};var W;!function(t){function o(e){return-1===e.indexOf("/")&&-1===e.indexOf("~")?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function n(e,t){var i;for(var r in e)if(e.hasOwnProperty(r)){if(e[r]===t)return o(r)+"/";if("object"==typeof e[r]&&(i=n(e[r],t),""!=i))return o(r)+"/"+i}return""}function i(e,t){if(e===t)return"/";var o=n(e,t);if(""===o)throw new Error("Object not found in root");return"/"+o}function r(e){for(var t=0,o=v.length;o>t;t++)if(v[t].obj===e)return v[t]}function s(e,t){for(var o=0,n=e.observers.length;n>o;o++)if(e.observers[o].callback===t)return e.observers[o].observer}function a(e,t){for(var o=0,n=e.observers.length;n>o;o++)if(e.observers[o].observer===t)return void e.observers.splice(o,1)}function l(e,t){d(t),Object.observe?h(t,e):clearTimeout(t.next);var o=r(e);a(o,t)}function c(t,o){var n,a=[],l=t,c=r(t);if(c?n=s(c,o):(c=new C(t),v.push(c)),n)return n;if(Object.observe)n=function(e){h(n,t),u(n,t);for(var r=0,s=e.length;s>r;){if(("length"!==e[r].name||!R(e[r].object))&&"__Jasmine_been_here_before__"!==e[r].name){var c=e[r].type;switch(c){case"new":c="add";break;case"deleted":c="delete";break;case"updated":c="update"}w[c].call(e[r],a,i(l,e[r].object))}r++}a&&o&&o(a),n.patches=a,a=[]};else if(n={},c.value=JSON.parse(JSON.stringify(t)),o){n.callback=o,n.next=null;var f=this.intervals||[100,1e3,1e4,6e4],p=0,m=function(){d(n)},g=function(){clearTimeout(n.next),n.next=setTimeout(function(){m(),p=0,n.next=setTimeout(b,f[p++])},0)},b=function(){m(),p==f.length&&(p=f.length-1),n.next=setTimeout(b,f[p++])};"undefined"!=typeof e&&(e.addEventListener?(e.addEventListener("mousedown",g),e.addEventListener("mouseup",g),e.addEventListener("keydown",g)):(e.attachEvent("onmousedown",g),e.attachEvent("onmouseup",g),e.attachEvent("onkeydown",g))),n.next=setTimeout(b,f[p++])}return n.patches=a,n.object=t,c.observers.push(new y(o,n)),u(n,t)}function u(e,t){if(Object.observe){Object.observe(t,e);for(var o in t)if(t.hasOwnProperty(o)){var n=t[o];n&&"object"==typeof n&&u(e,n)}}return e}function h(e,t){if(Object.observe){Object.unobserve(t,e);for(var o in t)if(t.hasOwnProperty(o)){var n=t[o];n&&"object"==typeof n&&h(e,n)}}return e}function d(e){if(Object.observe)Object.deliverChangeRecords(e);else{for(var t,o=0,n=v.length;n>o;o++)if(v[o].obj===e.object){t=v[o];break}f(t.value,e.object,e.patches,"")}var i=e.patches;return i.length>0&&(e.patches=[],e.callback&&e.callback(i)),i}function f(e,t,n,i){for(var r=b(t),s=b(e),a=!1,l=!1,c=s.length-1;c>=0;c--){var u=s[c],h=e[u];if(t.hasOwnProperty(u)){var d=t[u];h instanceof Object?f(h,d,n,i+"/"+o(u)):h!=d&&(a=!0,n.push({op:"replace",path:i+"/"+o(u),value:d}),e[u]=d)}else n.push({op:"remove",path:i+"/"+o(u)}),delete e[u],l=!0}if(l||r.length!=s.length)for(var c=0;c<r.length;c++){var u=r[c];e.hasOwnProperty(u)||(n.push({op:"add",path:i+"/"+o(u),value:t[u]}),e[u]=JSON.parse(JSON.stringify(t[u])))}}function p(e,t){for(var o,n=!1,i=0,r=t.length;r>i;){o=t[i];for(var s=o.path.split("/"),a=e,l=1,c=s.length;;)if(R(a)){var u=parseInt(s[l],10);if(l++,l>=c){n=g[o.op].call(o,a,u,e);break}a=a[u]}else{var h=s[l];if(-1!=h.indexOf("~")&&(h=h.replace(/~1/g,"/").replace(/~0/g,"~")),l++,l>=c){n=m[o.op].call(o,a,h,e);break}a=a[h]}i++}return n}var m={add:function(e,t){return e[t]=this.value,!0},remove:function(e,t){return delete e[t],!0},replace:function(e,t){return e[t]=this.value,!0},move:function(e,t,o){var n={op:"_get",path:this.from};return p(o,[n]),p(o,[{op:"remove",path:this.from}]),p(o,[{op:"add",path:this.path,value:n.value}]),!0},copy:function(e,t,o){var n={op:"_get",path:this.from};return p(o,[n]),p(o,[{op:"add",path:this.path,value:n.value}]),!0},test:function(e,t){return JSON.stringify(e[t])===JSON.stringify(this.value)},_get:function(e,t){this.value=e[t]}},g={add:function(e,t){return e.splice(t,0,this.value),!0},remove:function(e,t){return e.splice(t,1),!0},replace:function(e,t){return e[t]=this.value,!0},move:m.move,copy:m.copy,test:m.test,_get:m._get},w={add:function(e,t){var n={op:"add",path:t+o(this.name),value:this.object[this.name]};e.push(n)},"delete":function(e,t){var n={op:"remove",path:t+o(this.name)};e.push(n)},update:function(e,t){var n={op:"replace",path:t+o(this.name),value:this.object[this.name]};e.push(n)}},v=[];t.intervals;var C=function(){function e(e){this.observers=[],this.obj=e}return e}(),y=function(){function e(e,t){this.callback=e,this.observer=t}return e}();t.unobserve=l,t.observe=c,t.generate=d;var b;b=Object.keys?Object.keys:function(e){var t=[];for(var o in e)e.hasOwnProperty(o)&&t.push(o);return t};var R;R=Array.isArray?Array.isArray:function(e){return e.push&&"number"==typeof e.length},t.apply=p}(W||(W={})),"undefined"!=typeof exports&&(exports.apply=W.apply,exports.observe=W.observe,exports.unobserve=W.unobserve,exports.generate=W.generate),t.PluginHookClass=function(){function e(){this.hooks=t(),this.globalBucket={},this.legacy=o}var t=function(){return{beforeInitWalkontable:[],beforeInit:[],beforeRender:[],beforeSetRangeEnd:[],beforeDrawBorders:[],beforeChange:[],beforeChangeRender:[],beforeRemoveCol:[],beforeRemoveRow:[],beforeValidate:[],beforeGetCellMeta:[],beforeAutofill:[],beforeKeyDown:[],beforeOnCellMouseDown:[],beforeTouchScroll:[],afterInit:[],afterLoadData:[],afterUpdateSettings:[],afterRender:[],afterRenderer:[],afterChange:[],afterValidate:[],afterGetCellMeta:[],afterSetCellMeta:[],afterGetColHeader:[],afterGetRowHeader:[],afterDestroy:[],afterRemoveRow:[],afterCreateRow:[],afterRemoveCol:[],afterCreateCol:[],afterDeselect:[],afterSelection:[],afterSelectionByProp:[],afterSelectionEnd:[],afterSelectionEndByProp:[],afterOnCellMouseDown:[],afterOnCellMouseOver:[],afterOnCellCornerMouseDown:[],afterScrollVertically:[],afterScrollHorizontally:[],afterCellMetaReset:[],afterIsMultipleSelectionCheck:[],afterDocumentKeyDown:[],afterMomentumScroll:[],beforeCellAlignment:[],modifyColWidth:[],modifyRowHeight:[],modifyRow:[],modifyCol:[]}},o={onBeforeChange:"beforeChange",onChange:"afterChange",onCreateRow:"afterCreateRow",onCreateCol:"afterCreateCol",onSelection:"afterSelection",onCopyLimit:"afterCopyLimit",onSelectionEnd:"afterSelectionEnd",onSelectionByProp:"afterSelectionByProp",onSelectionEndByProp:"afterSelectionEndByProp"};return e.prototype.getBucket=function(e){return e?(e.pluginHookBucket||(e.pluginHookBucket={}),e.pluginHookBucket):this.globalBucket},e.prototype.add=function(e,t,n){if(Array.isArray(t))for(var i=0,r=t.length;r>i;i++)this.add(e,t[i]);else{e in o&&(e=o[e]);var s=this.getBucket(n);"undefined"==typeof s[e]&&(s[e]=[]),t.skip=!1,-1==s[e].indexOf(t)&&s[e].push(t)}return this},e.prototype.once=function(e,t,o){if(Array.isArray(t))for(var n=0,i=t.length;i>n;n++)t[n].runOnce=!0,this.add(e,t[n],o);else t.runOnce=!0,this.add(e,t,o)},e.prototype.remove=function(e,t,n){var i=!1;e in o&&(e=o[e]);var r=this.getBucket(n);if("undefined"!=typeof r[e])for(var s=0,a=r[e].length;a>s;s++)if(r[e][s]==t){r[e][s].skip=!0,i=!0;break}return i},e.prototype.run=function(e,t,n,i,r,s,a,l){return t in o&&(t=o[t]),n=this._runBucket(this.globalBucket,e,t,n,i,r,s,a,l),n=this._runBucket(this.getBucket(e),e,t,n,i,r,s,a,l)},e.prototype._runBucket=function(e,t,o,n,i,r,s,a,l){var c,u,h,d=e[o];if(d)for(u=0,h=d.length;h>u;u++)d[u].skip||(c=d[u].call(t,n,i,r,s,a,l),void 0!==c&&(n=c),d[u].runOnce&&this.remove(o,d[u],e===this.globalBucket?null:t));return n},e.prototype.destroy=function(e){var t=this.getBucket(e);for(var o in t)if(t.hasOwnProperty(o))for(var n=0,i=t[o].length;i>n;n++)this.remove(o,t[o],e)},e.prototype.register=function(e){this.isRegistered(e)||(this.hooks[e]=[])},e.prototype.deregister=function(e){delete this.hooks[e]},e.prototype.isRegistered=function(e){return"undefined"!=typeof this.hooks[e]},e.prototype.getRegistered=function(){return Object.keys(this.hooks)},e}(),t.hooks=new t.PluginHookClass,t.PluginHooks=t.hooks,function(e){function t(){function t(e){var t=document,o=this;o.table=t.createElement("table"),o.theadTh=t.createElement("th"),o.table.appendChild(t.createElement("thead")).appendChild(t.createElement("tr")).appendChild(o.theadTh),o.tableStyle=o.table.style,o.tableStyle.tableLayout="auto",o.tableStyle.width="auto",o.tbody=t.createElement("tbody"),o.table.appendChild(o.tbody),o.container=t.createElement("div"),o.container.className=e.rootElement.className+" hidden",o.containerStyle=o.container.style,o.container.appendChild(o.table)}var n=this,i=5;this.beforeInit=function(){var e=this;e.autoColumnWidths=[],e.getSettings().autoColumnSize!==!1?e.autoColumnSizeTmp||(e.autoColumnSizeTmp={table:null,tableStyle:null,theadTh:null,tbody:null,container:null,containerStyle:null,determineBeforeNextRender:!0},e.addHook("beforeRender",o.determineIfChanged),e.addHook("modifyColWidth",o.modifyColWidth),e.addHook("afterDestroy",o.afterDestroy),e.determineColumnWidth=n.determineColumnWidth):e.autoColumnSizeTmp&&(e.removeHook("beforeRender",o.determineIfChanged),e.removeHook("modifyColWidth",o.modifyColWidth),e.removeHook("afterDestroy",o.afterDestroy),delete e.determineColumnWidth,n.afterDestroy.call(e))},this.determineIfChanged=function(e){e&&o.determineColumnsWidth.apply(this,arguments)},this.determineColumnWidth=function(o){var n=this,r=n.autoColumnSizeTmp;r.container||t.call(r,n),r.container.className=n.rootElement.className+" htAutoColumnSize",r.table.className=n.table.className;for(var s=n.countRows(),a={},l=0,c=0;s>c;c++){var u=e.helper.stringify(n.getDataAtCell(c,o)),h=u.length;h>l&&(l=h),a[h]||(a[h]={needed:i,strings:[]}),a[h].needed&&(a[h].strings.push({value:u,row:c}),a[h].needed--)}var d=n.getSettings();d.colHeaders&&n.view.appendColHeader(o,r.theadTh),e.Dom.empty(r.tbody);for(var f in a)if(a.hasOwnProperty(f))for(var p=0,m=a[f].strings.length;m>p;p++){var g=a[f].strings[p].row,w=n.getCellMeta(g,o);w.col=o,w.row=g;var v=n.getCellRenderer(w),C=document.createElement("tr"),y=document.createElement("td");v(n,y,g,o,n.colToProp(o),a[f].strings[p].value,w),c++,C.appendChild(y),r.tbody.appendChild(C)}var b=n.rootElement.parentNode;b.appendChild(r.container);var R=e.Dom.outerWidth(r.table);return b.removeChild(r.container),R},this.determineColumnsWidth=function(){var e=this,t=this.getSettings();if(t.autoColumnSize||!t.colWidths)for(var o=this.countCols(),i=0;o>i;i++)e._getColWidthFromSettings(i)||(this.autoColumnWidths[i]=n.determineColumnWidth.call(e,i))},this.modifyColWidth=function(e,t){return this.autoColumnWidths[t]&&this.autoColumnWidths[t]>e?this.autoColumnWidths[t]:e},this.afterDestroy=function(){var e=this;e.autoColumnSizeTmp&&e.autoColumnSizeTmp.container&&e.autoColumnSizeTmp.container.parentNode&&e.autoColumnSizeTmp.container.parentNode.removeChild(e.autoColumnSizeTmp.container),e.autoColumnSizeTmp=null}}var o=new t;e.hooks.add("beforeInit",o.beforeInit),e.hooks.add("afterUpdateSettings",o.beforeInit)}(t);var B=new n;t.hooks.add("afterInit",function(){B.init.call(this,"afterInit")}),t.hooks.add("afterUpdateSettings",function(){B.init.call(this,"afterUpdateSettings")}),t.hooks.add("modifyRow",B.translateRow),t.hooks.add("afterGetColHeader",B.getColHeader),t.hooks.register("beforeColumnSort"),t.hooks.register("afterColumnSort"),function(e){function t(e,t){return-1!=e.indexOf(t)?e:(e=e.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ",""),e+=" "+t)}function o(e,t){return-1!=e.indexOf(t)?e:(e=e.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ",""),e+=" "+t)}function n(e){for(var t={},o=e.from.row;o<=e.to.row;o++)for(var n=e.from.col;n<=e.to.col;n++)t[o]||(t[o]=[]),t[o][n]=this.getCellMeta(o,n).className;return t}function i(e,n,i,r){var s=this.getCellMeta(e,n),a=r;s.className&&(a="vertical"===i?t(s.className,r):o(s.className,r)),this.setCellMeta(e,n,"className",a)}function r(e,t,o){var r=n.call(this,e);if(this.runHooks("beforeCellAlignment",r,e,t,o),e.from.row==e.to.row&&e.from.col==e.to.col)i.call(this,e.from.row,e.from.col,t,o);else for(var s=e.from.row;s<=e.to.row;s++)for(var a=e.from.col;a<=e.to.col;a++)i.call(this,s,a,t,o);this.render()}function s(t,o){this.instance=t;var n=this;if(n.menus=[],n.htMenus={},n.triggerRows=[],n.eventManager=e.eventManager(n),this.enabled=!0,this.instance.addHook("afterDestroy",function(){n.destroy()}),this.defaultOptions={items:[{key:"row_above",name:"Insert row above",callback:function(e,t){this.alter("insert_row",t.start.row)},disabled:function(){var e=this.getSelected(),t=[0,e[1],this.countRows()-1,e[1]],o=t.join(",")==e.join(",");return e[0]<0||this.countRows()>=this.getSettings().maxRows||o}},{key:"row_below",name:"Insert row below",callback:function(e,t){this.alter("insert_row",t.end.row+1)},disabled:function(){var e=this.getSelected(),t=[0,e[1],this.countRows()-1,e[1]],o=t.join(",")==e.join(",");return this.getSelected()[0]<0||this.countRows()>=this.getSettings().maxRows||o}},s.SEPARATOR,{key:"col_left",name:"Insert column on the left",callback:function(e,t){this.alter("insert_col",t.start.col)},disabled:function(){var e=this.getSelected(),t=[e[0],0,e[0],this.countCols()-1],o=t.join(",")==e.join(",");return this.getSelected()[1]<0||this.countCols()>=this.getSettings().maxCols||o}},{key:"col_right",name:"Insert column on the right",callback:function(e,t){this.alter("insert_col",t.end.col+1)},disabled:function(){var e=this.getSelected(),t=[e[0],0,e[0],this.countCols()-1],o=t.join(",")==e.join(",");return e[1]<0||this.countCols()>=this.getSettings().maxCols||o}},s.SEPARATOR,{key:"remove_row",name:"Remove row",callback:function(e,t){var o=t.end.row-t.start.row+1;this.alter("remove_row",t.start.row,o)},disabled:function(){var e=this.getSelected(),t=[0,e[1],this.countRows()-1,e[1]],o=t.join(",")==e.join(",");return e[0]<0||o}},{key:"remove_col",name:"Remove column",callback:function(e,t){var o=t.end.col-t.start.col+1;this.alter("remove_col",t.start.col,o)},disabled:function(){var e=this.getSelected(),t=[e[0],0,e[0],this.countCols()-1],o=t.join(",")==e.join(",");return e[1]<0||o}},s.SEPARATOR,{key:"undo",name:"Undo",callback:function(){this.undo()},disabled:function(){return this.undoRedo&&!this.undoRedo.isUndoAvailable()}},{key:"redo",name:"Redo",callback:function(){this.redo()},disabled:function(){return this.undoRedo&&!this.undoRedo.isRedoAvailable()}},s.SEPARATOR,{key:"make_read_only",name:function(){var e="Read only",t=n.checkSelectionReadOnlyConsistency(this);return t&&(e=n.markSelected(e)),e},callback:function(){var e=n.checkSelectionReadOnlyConsistency(this),t=this;this.getSelectedRange().forAll(function(o,n){t.getCellMeta(o,n).readOnly=e?!1:!0}),this.render()}},s.SEPARATOR,{key:"alignment",name:"Alignment",submenu:{items:[{name:function(){var e="Left",t=n.checkSelectionAlignment(this,"htLeft");return t&&(e=n.markSelected(e)),e},callback:function(){r.call(this,this.getSelectedRange(),"horizontal","htLeft")},disabled:!1},{name:function(){var e="Center",t=n.checkSelectionAlignment(this,"htCenter");return t&&(e=n.markSelected(e)),e},callback:function(){r.call(this,this.getSelectedRange(),"horizontal","htCenter")},disabled:!1},{name:function(){var e="Right",t=n.checkSelectionAlignment(this,"htRight");return t&&(e=n.markSelected(e)),e},callback:function(){r.call(this,this.getSelectedRange(),"horizontal","htRight")},disabled:!1},{name:function(){var e="Justify",t=n.checkSelectionAlignment(this,"htJustify");return t&&(e=n.markSelected(e)),e},callback:function(){r.call(this,this.getSelectedRange(),"horizontal","htJustify")},disabled:!1},s.SEPARATOR,{name:function(){var e="Top",t=n.checkSelectionAlignment(this,"htTop");return t&&(e=n.markSelected(e)),e},callback:function(){r.call(this,this.getSelectedRange(),"vertical","htTop")},disabled:!1},{name:function(){var e="Middle",t=n.checkSelectionAlignment(this,"htMiddle");return t&&(e=n.markSelected(e)),e},callback:function(){r.call(this,this.getSelectedRange(),"vertical","htMiddle")},disabled:!1},{name:function(){var e="Bottom",t=n.checkSelectionAlignment(this,"htBottom");return t&&(e=n.markSelected(e)),e},callback:function(){r.call(this,this.getSelectedRange(),"vertical","htBottom")},disabled:!1}]}}]},n.options={},e.helper.extend(n.options,this.options),this.bindMouseEvents(),this.markSelected=function(e){return"<span class='selected'>"+String.fromCharCode(10003)+"</span>"+e},this.checkSelectionAlignment=function(e,t){var o=!1;return e.getSelectedRange().forAll(function(n,i){var r=e.getCellMeta(n,i).className;return r&&-1!=r.indexOf(t)?(o=!0,!1):void 0}),o},!this.instance.getSettings().allowInsertRow){var i=l(this.defaultOptions.items,"row_above");this.defaultOptions.items.splice(i,1);var a=l(this.defaultOptions.items,"row_above");this.defaultOptions.items.splice(a,1),this.defaultOptions.items.splice(a,1)}if(!this.instance.getSettings().allowInsertColumn){var c=l(this.defaultOptions.items,"col_left");this.defaultOptions.items.splice(c,1);var u=l(this.defaultOptions.items,"col_right");this.defaultOptions.items.splice(u,1),this.defaultOptions.items.splice(u,1)}var h,d,f=!1,p=!1;this.instance.getSettings().allowRemoveRow||(h=l(this.defaultOptions.items,"remove_row"),this.defaultOptions.items.splice(h,1),f=!0),this.instance.getSettings().allowRemoveColumn||(d=l(this.defaultOptions.items,"remove_col"),this.defaultOptions.items.splice(d,1),p=!0),f&&p&&this.defaultOptions.items.splice(d,1),this.checkSelectionReadOnlyConsistency=function(e){var t=!1;return e.getSelectedRange().forAll(function(o,n){return e.getCellMeta(o,n).readOnly?(t=!0,!1):void 0}),t},e.hooks.run(t,"afterContextMenuDefaultOptions",this.defaultOptions)}function a(e,t){for(var o=0,n=e.length;n>o;o++)if(e[o].key===t)return e[o]}function l(e,t){for(var o=0,n=e.length;n>o;o++)if(e[o].key===t)return o}function c(){if(!this.rootElement.className.indexOf("htContextMenu")){for(var e=0,t=0,o=this.getSettings().data.length,n=0;o>n;n++)this.getSettings().data[n].name==s.SEPARATOR.name?e+=2:t+=26;this.view.wt.wtScrollbars.vertical.fixedContainer.style.height=t+e+"px"}}function u(){var t=this,o=t.getSettings().contextMenu,n=e.helper.isObject(o)?o:{};o?(t.contextMenu||(t.contextMenu=new s(t,n)),t.contextMenu.enable()):t.contextMenu&&(t.contextMenu.destroy(),delete t.contextMenu)}s.prototype.createMenu=function(t,o){t&&(t=t.replace(/ /g,"_"),t="htContextSubMenu_"+t);var n;return n=t?document.querySelector(".htContextMenu."+t):document.querySelector(".htContextMenu"),n||(n=document.createElement("DIV"),e.Dom.addClass(n,"htContextMenu"),t&&e.Dom.addClass(n,t),document.getElementsByTagName("body")[0].appendChild(n)),this.menus.indexOf(n)<0&&(this.menus.push(n),o=o||0,this.triggerRows.push(o)),n},s.prototype.bindMouseEvents=function(){function t(t){var o=this.instance.getSettings();this.closeAll(),t.preventDefault(),e.helper.stopPropagation(t);var n=this.instance.getSettings().rowHeaders,i=this.instance.getSettings().colHeaders;if(n||i){if(n&&i){var r=t.target.parentNode.querySelectorAll(".cornerHeader").length>0;if(r)return}}else if(!("TD"==t.target.nodeName||e.Dom.hasClass(t.target,"current")&&e.Dom.hasClass(t.target,"wtBorder")))return;var a=this.createMenu(),l=this.getItems(o.contextMenu);this.show(a,l),this.setMenuPosition(t,a),this.eventManager.addEventListener(document.documentElement,"mousedown",e.helper.proxy(s.prototype.closeAll,this))}var o=e.eventManager(this.instance);o.addEventListener(this.instance.rootElement,"contextmenu",e.helper.proxy(t,this))},s.prototype.bindTableEvents=function(){this._afterScrollCallback=function(){},this.instance.addHook("afterScrollVertically",this._afterScrollCallback),this.instance.addHook("afterScrollHorizontally",this._afterScrollCallback)},s.prototype.unbindTableEvents=function(){this._afterScrollCallback&&(this.instance.removeHook("afterScrollVertically",this._afterScrollCallback),this.instance.removeHook("afterScrollHorizontally",this._afterScrollCallback),this._afterScrollCallback=null)},s.prototype.performAction=function(e,t){var o=this,n=t.getSelected()[0],i=t.getData()[n];if(i.disabled!==!0&&("function"!=typeof i.disabled||i.disabled.call(this.instance)!==!0)&&!i.hasOwnProperty("submenu")){if("function"!=typeof i.callback)return;var r=this.instance.getSelectedRange(),a=s.utils.normalizeSelection(r);i.callback.call(this.instance,i.key,a,e),o.closeAll()}},s.prototype.unbindMouseEvents=function(){this.eventManager.clear();var t=e.eventManager(this.instance);t.removeEventListener(this.instance.rootElement,"contextmenu")},s.prototype.show=function(t,o){var n=this;t.removeAttribute("style"),t.style.display="block";var i={data:o,colHeaders:!1,colWidths:[200],readOnly:!0,copyPaste:!1,columns:[{data:"name",renderer:e.helper.proxy(this.renderer,this)}],renderAllRows:!0,beforeKeyDown:function(e){n.onBeforeKeyDown(e,r)},afterOnCellMouseOver:function(e,t,o){n.onCellMouseOver(e,t,o,r)}},r=new e(t,i);this.eventManager.removeEventListener(t,"mousedown"),this.eventManager.addEventListener(t,"mousedown",function(e){n.performAction(e,r)}),this.bindTableEvents(),r.listen(),this.htMenus[r.guid]=r},s.prototype.close=function(e){this.hide(e),this.eventManager.clear(),this.unbindTableEvents(),this.instance.listen()},s.prototype.closeAll=function(){for(;this.menus.length>0;){var e=this.menus.pop();e&&this.close(e)}this.triggerRows=[]},s.prototype.closeLastOpenedSubMenu=function(){var e=this.menus.pop();e&&this.hide(e)},s.prototype.hide=function(e){e.style.display="none";var t=this.htMenus[e.id];t.destroy(),delete this.htMenus[e.id]},s.prototype.renderer=function(t,o,n,i,r,a){function l(e){return e.hasOwnProperty("submenu")}function c(e){return new RegExp(s.SEPARATOR.name,"i").test(e.name)}function u(e){return e.disabled===!0||"function"==typeof e.disabled&&e.disabled.call(h.instance)===!0}var h=this,d=t.getData()[n],f=document.createElement("DIV");"function"==typeof a&&(a=a.call(this.instance)),e.Dom.empty(o),o.appendChild(f),c(d)?e.Dom.addClass(o,"htSeparator"):e.Dom.fastInnerHTML(f,a),u(d)?(e.Dom.addClass(o,"htDisabled"),this.eventManager.addEventListener(f,"mouseenter",function(){t.deselectCell()})):l(d)?(e.Dom.addClass(o,"htSubmenu"),this.eventManager.addEventListener(f,"mouseenter",function(){t.selectCell(n,i)})):(e.Dom.removeClass(o,"htSubmenu"),e.Dom.removeClass(o,"htDisabled"),this.eventManager.addEventListener(f,"mouseenter",function(){t.selectCell(n,i)}))},s.prototype.onCellMouseOver=function(e,t,o,n){var i=this.menus.length;if(i>0){var r=this.menus[i-1];r.id!=n.guid&&this.closeLastOpenedSubMenu()}else this.closeLastOpenedSubMenu();if(-1!=o.className.indexOf("htSubmenu")){var s=n.getData()[t.row],a=this.getItems(s.submenu),l=this.createMenu(s.name,t.row),c=o.getBoundingClientRect();this.show(l,a),this.setSubMenuPosition(c,l)}},s.prototype.onBeforeKeyDown=function(t,o){function n(e){var t=e.getCell(0,0);s.utils.isSeparator(t)||s.utils.isDisabled(t)?r(0,0,e):e.selectCell(0,0)}function i(e){var t=e.countRows()-1,o=e.getCell(t,0);s.utils.isSeparator(o)||s.utils.isDisabled(o)?a(t,0,e):e.selectCell(t,0)}function r(e,t,o){var n=e+1,i=n<o.countRows()?o.getCell(n,t):null;i&&(s.utils.isSeparator(i)||s.utils.isDisabled(i)?r(n,t,o):o.selectCell(n,t))}function a(e,t,o){var n=e-1,i=n>=0?o.getCell(n,t):null;i&&(s.utils.isSeparator(i)||s.utils.isDisabled(i)?a(n,t,o):o.selectCell(n,t))}function l(e,t,o,n){var i=e.getData()[n],r=t.getItems(i.submenu),s=t.createMenu(i.name,n),a=o.getBoundingClientRect(),l=t.show(s,r);t.setSubMenuPosition(a,s),l.selectCell(0,0)}e.Dom.enableImmediatePropagation(t);var c=this,u=o.getSelected();switch(t.keyCode){case e.helper.keyCode.ESCAPE:c.closeAll(),t.preventDefault(),t.stopImmediatePropagation();break;case e.helper.keyCode.ENTER:u&&c.performAction(t,o);break;case e.helper.keyCode.ARROW_DOWN:u?r(u[0],u[1],o,c):n(o,c),t.preventDefault(),t.stopImmediatePropagation();break;case e.helper.keyCode.ARROW_UP:u?a(u[0],u[1],o,c):i(o,c),t.preventDefault(),t.stopImmediatePropagation();break;case e.helper.keyCode.ARROW_RIGHT:if(u){var h=u[0],d=o.getCell(u[0],0);s.utils.hasSubMenu(d)&&l(o,c,d,h)}t.preventDefault(),t.stopImmediatePropagation();break;case e.helper.keyCode.ARROW_LEFT:if(u){if(-1!=o.rootElement.className.indexOf("htContextSubMenu_")){c.closeLastOpenedSubMenu();var f=c.menus.length;if(f>0){var p=c.menus[f-1],m=c.triggerRows.pop();o=this.htMenus[p.id],o.selectCell(m,0)}}t.preventDefault(),t.stopImmediatePropagation()}}},s.prototype.getItems=function(t){function o(t){"string"==typeof t?this.name=t:e.helper.extend(this,t)}var n,i;o.prototype=t,t&&t.items&&(t=t.items),t===!0&&(t=this.defaultOptions.items),n=[];for(var r in t)t.hasOwnProperty(r)&&(i="string"==typeof t[r]?a(this.defaultOptions.items,t[r]):a(this.defaultOptions.items,r),i||(i=t[r]),i=new o(i),"object"==typeof t[r]&&e.helper.extend(i,t[r]),i.key||(i.key=r),n.push(i));return n},s.prototype.setSubMenuPosition=function(t,o){var n=e.Dom.getWindowScrollTop(),i=e.Dom.getWindowScrollLeft(),r={top:n+t.top,topRelative:t.top,left:t.left,leftRelative:t.left-i,scrollTop:n,scrollLeft:i,cellHeight:t.height,cellWidth:t.width};this.menuFitsBelowCursor(r,o,document.body.clientWidth)?this.positionMenuBelowCursor(r,o,!0):this.menuFitsAboveCursor(r,o)?this.positionMenuAboveCursor(r,o,!0):this.positionMenuBelowCursor(r,o,!0),this.menuFitsOnRightOfCursor(r,o,document.body.clientWidth)?this.positionMenuOnRightOfCursor(r,o,!0):this.positionMenuOnLeftOfCursor(r,o,!0)},s.prototype.setMenuPosition=function(t,o){var n=e.Dom.getWindowScrollTop(),i=e.Dom.getWindowScrollLeft(),r=t.pageY||t.clientY+n,s=t.pageX||t.clientX+i,a={top:r,topRelative:r-n,left:s,leftRelative:s-i,scrollTop:n,scrollLeft:i,cellHeight:t.target.clientHeight,cellWidth:t.target.clientWidth};this.menuFitsBelowCursor(a,o,document.body.clientHeight)?this.positionMenuBelowCursor(a,o):this.menuFitsAboveCursor(a,o)?this.positionMenuAboveCursor(a,o):this.positionMenuBelowCursor(a,o),this.menuFitsOnRightOfCursor(a,o,document.body.clientWidth)?this.positionMenuOnRightOfCursor(a,o):this.positionMenuOnLeftOfCursor(a,o)},s.prototype.menuFitsAboveCursor=function(e,t){return e.topRelative>=t.offsetHeight},s.prototype.menuFitsBelowCursor=function(e,t,o){return e.topRelative+t.offsetHeight<=o},s.prototype.menuFitsOnRightOfCursor=function(e,t,o){return e.leftRelative+t.offsetWidth<=o},s.prototype.positionMenuBelowCursor=function(e,t){t.style.top=e.top+"px"},s.prototype.positionMenuAboveCursor=function(e,t,o){o?t.style.top=e.top+e.cellHeight-t.offsetHeight+"px":t.style.top=e.top-t.offsetHeight+"px"},s.prototype.positionMenuOnRightOfCursor=function(e,t,o){o?t.style.left=1+e.left+e.cellWidth+"px":t.style.left=1+e.left+"px"},s.prototype.positionMenuOnLeftOfCursor=function(e,t,o){o?t.style.left=e.left-t.offsetWidth+"px":t.style.left=e.left-t.offsetWidth+"px"},s.utils={},s.utils.normalizeSelection=function(e){return{start:e.getTopLeftCorner(),end:e.getBottomRightCorner()}},s.utils.isSeparator=function(t){return e.Dom.hasClass(t,"htSeparator")},s.utils.hasSubMenu=function(t){return e.Dom.hasClass(t,"htSubmenu")},s.utils.isDisabled=function(t){return e.Dom.hasClass(t,"htDisabled")},s.prototype.enable=function(){this.enabled||(this.enabled=!0,this.bindMouseEvents())},s.prototype.disable=function(){this.enabled&&(this.enabled=!1,this.closeAll(),this.unbindMouseEvents(),this.unbindTableEvents())},s.prototype.destroy=function(){for(this.closeAll();this.menus.length>0;){var e=this.menus.pop();this.triggerRows.pop(),e&&(this.close(e),this.isMenuEnabledByOtherHotInstance()||this.removeMenu(e))}this.unbindMouseEvents(),this.unbindTableEvents()},s.prototype.isMenuEnabledByOtherHotInstance=function(){for(var e=document.querySelectorAll(".handsontable"),t=!1,o=0,n=e.length;n>o;o++){var i=this.htMenus[e[o].id];if(i&&i.getSettings().contextMenu){t=!0;break}}return t},s.prototype.removeMenu=function(e){e.parentNode&&this.menu.parentNode.removeChild(e)},s.prototype.align=function(e,t,o){r.call(this,e,t,o)},s.SEPARATOR={name:"---------"},e.hooks.add("afterInit",u),e.hooks.add("afterUpdateSettings",u),e.hooks.add("afterInit",c),e.PluginHooks.register("afterContextMenuDefaultOptions"),e.ContextMenu=s}(t);var V=function(){var e=this,o=e.getSettings().comments;o&&(t.Comments=new i(e),t.Comments.init())},_=function(e,o,n,i,r,s){s.comment&&t.Dom.addClass(e,s.commentedCellClassName)},F=function(e){var o=this;o.getSettings().comments&&(e.items.push(t.ContextMenu.SEPARATOR),e.items.push({key:"commentsAddEdit",name:function(){var e=t.Comments.checkSelectionCommentsConsistency();return e?"Edit Comment":"Add Comment"},callback:function(e,o,n){t.Comments.showComment(this.getSelectedRange())},disabled:function(){return!1}}),e.items.push({key:"commentsRemove",name:function(){return"Delete Comment"},callback:function(e,o,n){t.Comments.removeComment(o.start.row,o.start.col)},disabled:function(){var e=t.Comments.checkSelectionCommentsConsistency();return!e}}))};t.hooks.add("beforeInit",V),t.hooks.add("afterContextMenuDefaultOptions",F),
t.hooks.add("afterRenderer",_),function(t){function o(){function o(e){d=this,f=e;var t=this.view.wt.wtTable.getCoords(e).col;if(t>=0){h=t;var o=f.getBoundingClientRect();u=o.left,p.style.top=o.top+"px",p.style.left=u+"px",d.rootElement.appendChild(p)}}function n(e,t){var o=e.getBoundingClientRect(),n=6;t>0?p.style.left=o.left+o.width-n+"px":p.style.left=o.left+"px"}function i(){var e=this;t.Dom.addClass(p,"active"),t.Dom.addClass(m,"active");var o=f.getBoundingClientRect();m.style.width=o.width+"px",m.style.height=e.view.maximumVisibleElementHeight(0)+"px",m.style.top=p.style.top,m.style.left=u+"px",e.rootElement.appendChild(m)}function r(e){m.style.left=u+e+"px"}function s(){t.Dom.removeClass(p,"active"),t.Dom.removeClass(m,"active")}var a,l,c,u,h,d,f,p=document.createElement("DIV"),m=document.createElement("DIV"),g=t.eventManager(this);p.className="manualColumnMover",m.className="manualColumnMoverGuide";var w=function(){var e=this;t.hooks.run(e,"persistentStateSave","manualColumnPositions",e.manualColumnPositions)},v=function(){var e=this,o={};return t.hooks.run(e,"persistentStateLoad","manualColumnPositions",o),o.value},C=function(e){return"BODY"!=e.tagName?"THEAD"==e.parentNode.tagName?!0:(e=e.parentNode,C(e)):!1},y=function(e){return"TABLE"!=e.tagName?"TH"==e.tagName?e:y(e.parentNode):null},b=function(){var u,d=this;g.addEventListener(d.rootElement,"mouseover",function(e){if(C(e.target)){var t=y(e.target);if(t)if(u){var i=d.view.wt.wtTable.getCoords(t).col;i>=0&&(l=i,n(e.target,l-a))}else o.call(d,t)}}),g.addEventListener(d.rootElement,"mousedown",function(e){t.Dom.hasClass(e.target,"manualColumnMover")&&(c=t.helper.pageX(e),i.call(d),u=d,a=h,l=h)}),g.addEventListener(e,"mousemove",function(e){u&&r(t.helper.pageX(e)-c)}),g.addEventListener(e,"mouseup",function(e){u&&(s(),u=!1,S(d.manualColumnPositions,d.countCols()),d.manualColumnPositions.splice(l,0,d.manualColumnPositions.splice(a,1)[0]),d.forceFullRender=!0,d.view.render(),w.call(d),t.hooks.run(d,"afterColumnMove",a,l),o.call(d,f))}),d.addHook("afterDestroy",R)},R=function(){g.clear()},S=function(e,t){if(e.length<t)for(var o=e.length;t>o;o++)e[o]=o};this.beforeInit=function(){this.manualColumnPositions=[]},this.init=function(e){var t=this,o=!!this.getSettings().manualColumnMove;if(o){var n=this.getSettings().manualColumnMove,i=v.call(t);"undefined"!=typeof i?this.manualColumnPositions=i:Array.isArray(n)?this.manualColumnPositions=n:this.manualColumnPositions=[],"afterInit"==e&&("undefined"!=typeof t.manualColumnPositionsPluginUsages?t.manualColumnPositionsPluginUsages.push("manualColumnMove"):t.manualColumnPositionsPluginUsages=["manualColumnMove"],b.call(this),this.manualColumnPositions.length>0&&(this.forceFullRender=!0,this.render()))}else{var r=t.manualColumnPositionsPluginUsages?t.manualColumnPositionsPluginUsages.indexOf("manualColumnMove"):-1;r>-1&&(R.call(this),this.manualColumnPositions=[],t.manualColumnPositionsPluginUsages[r]=void 0)}},this.modifyCol=function(e){return this.getSettings().manualColumnMove?("undefined"==typeof this.manualColumnPositions[e]&&S(this.manualColumnPositions,e+1),this.manualColumnPositions[e]):e},this.afterRemoveCol=function(e,t){if(this.getSettings().manualColumnMove){var o,n=this.manualColumnPositions;o=n.splice(e,t),n=n.map(function(e){var t,n=e;for(t=0;t<o.length;t++)e>o[t]&&n--;return n}),this.manualColumnPositions=n}},this.afterCreateCol=function(e,t){if(this.getSettings().manualColumnMove){var o=this.manualColumnPositions;if(o.length){for(var n=[],i=0;t>i;i++)n.push(e+i);e>=o.length?o.concat(n):(o=o.map(function(o){return o>=e?o+t:o}),o.splice.apply(o,[e,0].concat(n))),this.manualColumnPositions=o}}}}var n=new o;t.hooks.add("beforeInit",n.beforeInit),t.hooks.add("afterInit",function(){n.init.call(this,"afterInit")}),t.hooks.add("afterUpdateSettings",function(){n.init.call(this,"afterUpdateSettings")}),t.hooks.add("modifyCol",n.modifyCol),t.hooks.add("afterRemoveCol",n.afterRemoveCol),t.hooks.add("afterCreateCol",n.afterCreateCol),t.hooks.register("afterColumnMove")}(t),function(t){function o(){function o(e){u=this,a=e;var t=this.view.wt.wtTable.getCoords(e).col;if(t>=0){l=t;var o=a.getBoundingClientRect();p=o.left-6,f=parseInt(o.width,10),m.style.top=o.top+"px",m.style.left=p+f+"px",u.rootElement.appendChild(m)}}function n(){m.style.left=p+c+"px"}function i(){var e=this;t.Dom.addClass(m,"active"),t.Dom.addClass(g,"active"),g.style.top=m.style.top,g.style.left=m.style.left,g.style.height=e.view.maximumVisibleElementHeight(0)+"px",e.rootElement.appendChild(g)}function r(){g.style.left=m.style.left}function s(){t.Dom.removeClass(m,"active"),t.Dom.removeClass(g,"active")}var a,l,c,u,h,d,f,p,m=document.createElement("DIV"),g=document.createElement("DIV"),w=t.eventManager(this);m.className="manualColumnResizer",g.className="manualColumnResizerGuide";var v=function(){var e=this;t.hooks.run(e,"persistentStateSave","manualColumnWidths",e.manualColumnWidths)},C=function(){var e=this,o={};return t.hooks.run(e,"persistentStateLoad","manualColumnWidths",o),o.value},y=function(e){return"BODY"!=e.tagName?"THEAD"==e.parentNode.tagName?!0:(e=e.parentNode,y(e)):!1},b=function(e){return"TABLE"!=e.tagName?"TH"==e.tagName?e:b(e.parentNode):null},R=function(){var u,p=this,m=0,g=null;w.addEventListener(p.rootElement,"mouseover",function(e){if(y(e.target)){var t=b(e.target);t&&(u||o.call(p,t))}}),w.addEventListener(p.rootElement,"mousedown",function(e){t.Dom.hasClass(e.target,"manualColumnResizer")&&(i.call(p),u=p,null==g&&(g=setTimeout(function(){m>=2&&(h=p.determineColumnWidth.call(p,l),E(l,h),p.forceFullRender=!0,p.view.render(),t.hooks.run(p,"afterColumnResize",l,h)),m=0,g=null},500),p._registerTimeout(g)),m++,d=t.helper.pageX(e),h=f)}),w.addEventListener(e,"mousemove",function(e){u&&(c=f+(t.helper.pageX(e)-d),h=E(l,c),n(),r())}),w.addEventListener(e,"mouseup",function(){u&&(s(),u=!1,h!=f&&(p.forceFullRender=!0,p.view.render(),v.call(p),t.hooks.run(p,"afterColumnResize",l,h)),o.call(p,a))}),p.addHook("afterDestroy",S)},S=function(){w.clear()};this.beforeInit=function(){this.manualColumnWidths=[]},this.init=function(e){var t=this,o=!!this.getSettings().manualColumnResize;if(o){var n=this.getSettings().manualColumnResize,i=C.call(t);"undefined"!=typeof t.manualColumnWidthsPluginUsages?t.manualColumnWidthsPluginUsages.push("manualColumnResize"):t.manualColumnWidthsPluginUsages=["manualColumnResize"],"undefined"!=typeof i?this.manualColumnWidths=i:Array.isArray(n)?this.manualColumnWidths=n:this.manualColumnWidths=[],"afterInit"==e&&(R.call(this),this.manualColumnWidths.length>0&&(this.forceFullRender=!0,this.render()))}else{var r=t.manualColumnWidthsPluginUsages?t.manualColumnWidthsPluginUsages.indexOf("manualColumnResize"):-1;r>-1&&(S.call(this),this.manualColumnWidths=[])}};var E=function(e,o){return o=Math.max(o,20),e=t.hooks.run(u,"modifyCol",e),u.manualColumnWidths[e]=o,o};this.modifyColWidth=function(e,t){return t=this.runHooks("modifyCol",t),this.getSettings().manualColumnResize&&this.manualColumnWidths[t]?this.manualColumnWidths[t]:e}}var n=new o;t.hooks.add("beforeInit",n.beforeInit),t.hooks.add("afterInit",function(){n.init.call(this,"afterInit")}),t.hooks.add("afterUpdateSettings",function(){n.init.call(this,"afterUpdateSettings")}),t.hooks.add("modifyColWidth",n.modifyColWidth),t.hooks.register("afterColumnResize")}(t),function(t){function o(){function o(e){u=this,a=e;var t=this.view.wt.wtTable.getCoords(e).row;if(t>=0){l=t;var o=a.getBoundingClientRect();p=o.top-6,f=parseInt(o.height,10),m.style.left=o.left+"px",m.style.top=p+f+"px",u.rootElement.appendChild(m)}}function n(){m.style.top=p+c+"px"}function i(){var e=this;t.Dom.addClass(m,"active"),t.Dom.addClass(g,"active"),g.style.top=m.style.top,g.style.left=m.style.left,g.style.width=e.view.maximumVisibleElementWidth(0)+"px",e.rootElement.appendChild(g)}function r(){g.style.top=m.style.top}function s(){t.Dom.removeClass(m,"active"),t.Dom.removeClass(g,"active")}var a,l,c,u,h,d,f,p,m=document.createElement("DIV"),g=document.createElement("DIV"),w=t.eventManager(this);m.className="manualRowResizer",g.className="manualRowResizerGuide";var v=function(){var e=this;t.hooks.run(e,"persistentStateSave","manualRowHeights",e.manualRowHeights)},C=function(){var e=this,o={};return t.hooks.run(e,"persistentStateLoad","manualRowHeights",o),o.value},y=function(e){return"BODY"!=e.tagName?"TBODY"==e.parentNode.tagName?!0:(e=e.parentNode,y(e)):!1},b=function(e){return"TABLE"!=e.tagName?"TH"==e.tagName?e:b(e.parentNode):null},R=function(){var u,p=this,m=0,g=null;w.addEventListener(p.rootElement,"mouseover",function(e){if(y(e.target)){var t=b(e.target);t&&(u||o.call(p,t))}}),w.addEventListener(p.rootElement,"mousedown",function(e){t.Dom.hasClass(e.target,"manualRowResizer")&&(i.call(p),u=p,null==g&&(g=setTimeout(function(){m>=2&&(E(l,null),p.forceFullRender=!0,p.view.render(),t.hooks.run(p,"afterRowResize",l,h)),m=0,g=null},500),p._registerTimeout(g)),m++,d=t.helper.pageY(e),h=f)}),w.addEventListener(e,"mousemove",function(e){u&&(c=f+(t.helper.pageY(e)-d),h=E(l,c),n(),r())}),w.addEventListener(e,"mouseup",function(e){u&&(s(),u=!1,h!=f&&(p.forceFullRender=!0,p.view.render(),v.call(p),t.hooks.run(p,"afterRowResize",l,h)),o.call(p,a))}),p.addHook("afterDestroy",S)},S=function(){w.clear()};this.beforeInit=function(){this.manualRowHeights=[]},this.init=function(e){var t=this,o=!!this.getSettings().manualRowResize;if(o){var n=this.getSettings().manualRowResize,i=C.call(t);"undefined"!=typeof t.manualRowHeightsPluginUsages?t.manualRowHeightsPluginUsages.push("manualRowResize"):t.manualRowHeightsPluginUsages=["manualRowResize"],"undefined"!=typeof i?this.manualRowHeights=i:Array.isArray(n)?this.manualRowHeights=n:this.manualRowHeights=[],"afterInit"===e?(R.call(this),this.manualRowHeights.length>0&&(this.forceFullRender=!0,this.render())):(this.forceFullRender=!0,this.render())}else{var r=t.manualRowHeightsPluginUsages?t.manualRowHeightsPluginUsages.indexOf("manualRowResize"):-1;r>-1&&(S.call(this),this.manualRowHeights=[],t.manualRowHeightsPluginUsages[r]=void 0)}};var E=function(e,o){return e=t.hooks.run(u,"modifyRow",e),u.manualRowHeights[e]=o,o};this.modifyRowHeight=function(e,t){return this.getSettings().manualRowResize&&(t=this.runHooks("modifyRow",t),void 0!==this.manualRowHeights[t])?this.manualRowHeights[t]:e}}var n=new o;t.hooks.add("beforeInit",n.beforeInit),t.hooks.add("afterInit",function(){n.init.call(this,"afterInit")}),t.hooks.add("afterUpdateSettings",function(){n.init.call(this,"afterUpdateSettings")}),t.hooks.add("modifyRowHeight",n.modifyRowHeight),t.hooks.register("afterRowResize")}(t),function(){function e(){var e=this,t=e.getSettings().observeChanges;t?(e.observer&&i.call(e),o.call(e),s.call(e)):t||i.call(e)}function o(){var e=this;e.observeChangesActive=!0,e.pauseObservingChanges=function(){e.observeChangesActive=!1},e.resumeObservingChanges=function(){e.observeChangesActive=!0},e.observedData=e.getData(),e.observer=W.observe(e.observedData,function(t){e.observeChangesActive&&(n.call(e,t),e.render()),e.runHooks("afterChangesObserved")})}function n(e){function t(e){var t;return t=n(e),t=o(t)}function o(e){var t=[];return e.filter(function(e){var o=i(e.path);if(-1!=["add","remove"].indexOf(e.op)&&!isNaN(o.col)){if(-1!=t.indexOf(o.col))return!1;t.push(o.col)}return!0})}function n(e){return e.filter(function(e){return!/[/]length/gi.test(e.path)})}function i(e){var t=e.match(/^\/(\d+)\/?(.*)?$/);return{row:parseInt(t[1],10),col:/^\d*$/.test(t[2])?parseInt(t[2],10):t[2]}}for(var r=this,s=t(e),a=0,l=s.length;l>a;a++){var c=s[a],u=i(c.path);switch(c.op){case"add":isNaN(u.col)?r.runHooks("afterCreateRow",u.row):r.runHooks("afterCreateCol",u.col);break;case"remove":isNaN(u.col)?r.runHooks("afterRemoveRow",u.row,1):r.runHooks("afterRemoveCol",u.col,1);break;case"replace":r.runHooks("afterChange",[u.row,u.col,null,c.value],"external")}}}function i(){var e=this;e.observer&&(r.call(e),a.call(e))}function r(){var e=this;W.unobserve(e.observedData,e.observer),delete e.observeChangesActive,delete e.pauseObservingChanges,delete e.resumeObservingChanges}function s(){var e=this;e.addHook("afterDestroy",i),e.addHook("afterCreateRow",l),e.addHook("afterRemoveRow",l),e.addHook("afterCreateCol",l),e.addHook("afterRemoveCol",l),e.addHook("afterChange",function(e,t){"loadData"!=t&&l.call(this)})}function a(){var e=this;e.removeHook("afterDestroy",i),e.removeHook("afterCreateRow",l),e.removeHook("afterRemoveRow",l),e.removeHook("afterCreateCol",l),e.removeHook("afterRemoveCol",l),e.removeHook("afterChange",l)}function l(){var e=this;e.pauseObservingChanges(),e.addHookOnce("afterChangesObserved",function(){e.resumeObservingChanges()})}t.hooks.add("afterLoadData",e),t.hooks.add("afterUpdateSettings",e),t.hooks.register("afterChangesObserved")}(),function(e){function o(){function o(){var e=this;for(var t in r)r.hasOwnProperty(t)&&e.addHook(t,r[t])}function n(){var e=this;for(var t in r)r.hasOwnProperty(t)&&e.removeHook(t,r[t])}var i=this;this.init=function(){var t=this,r=t.getSettings().persistentState;return i.enabled=!!r,i.enabled?(t.storage||(t.storage=new e(t.rootElement.id)),t.resetState=i.resetValue,void o.call(t)):void n.call(t)},this.saveValue=function(e,t){var o=this;o.storage.saveValue(e,t)},this.loadValue=function(e,t){var o=this;t.value=o.storage.loadValue(e)},this.resetValue=function(e){var t=this;"undefined"!=typeof e?t.storage.reset(e):t.storage.resetAll()};var r={persistentStateSave:i.saveValue,persistentStateLoad:i.loadValue,persistentStateReset:i.resetValue};for(var s in r)r.hasOwnProperty(s)&&t.hooks.register(s)}var n=new o;t.hooks.add("beforeInit",n.init),t.hooks.add("afterUpdateSettings",n.init)}(r),function(e){e.UndoRedo=function(t){var o=this;this.instance=t,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,t.addHook("afterChange",function(t,n){if(t){var i=new e.UndoRedo.ChangeAction(t);o.done(i)}}),t.addHook("afterCreateRow",function(t,n,i){if(!i){var r=new e.UndoRedo.CreateRowAction(t,n);o.done(r)}}),t.addHook("beforeRemoveRow",function(t,n){var i=o.instance.getData();t=(i.length+t)%i.length;var r=i.slice(t,t+n),s=new e.UndoRedo.RemoveRowAction(t,r);o.done(s)}),t.addHook("afterCreateCol",function(t,n,i){if(!i){var r=new e.UndoRedo.CreateColumnAction(t,n);o.done(r)}}),t.addHook("beforeRemoveCol",function(n,i){var r=o.instance.getData();n=(o.instance.countCols()+n)%o.instance.countCols();for(var s=[],a=0,l=r.length;l>a;a++)s[a]=r[a].slice(n,n+i);var c;Array.isArray(t.getSettings().colHeaders)&&(c=t.getSettings().colHeaders.slice(n,n+s.length));var u=new e.UndoRedo.RemoveColumnAction(n,s,c);o.done(u)}),t.addHook("beforeCellAlignment",function(t,n,i,r){var s=new e.UndoRedo.CellAlignmentAction(t,n,i,r);o.done(s)})},e.UndoRedo.prototype.done=function(e){this.ignoreNewActions||(this.doneActions.push(e),this.undoneActions.length=0)},e.UndoRedo.prototype.undo=function(){if(this.isUndoAvailable()){var e=this.doneActions.pop();this.ignoreNewActions=!0;var t=this;e.undo(this.instance,function(){t.ignoreNewActions=!1,t.undoneActions.push(e)})}},e.UndoRedo.prototype.redo=function(){if(this.isRedoAvailable()){var e=this.undoneActions.pop();this.ignoreNewActions=!0;var t=this;e.redo(this.instance,function(){t.ignoreNewActions=!1,t.doneActions.push(e)})}},e.UndoRedo.prototype.isUndoAvailable=function(){return this.doneActions.length>0},e.UndoRedo.prototype.isRedoAvailable=function(){return this.undoneActions.length>0},e.UndoRedo.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0},e.UndoRedo.Action=function(){},e.UndoRedo.Action.prototype.undo=function(){},e.UndoRedo.Action.prototype.redo=function(){},e.UndoRedo.ChangeAction=function(e){this.changes=e},e.helper.inherit(e.UndoRedo.ChangeAction,e.UndoRedo.Action),e.UndoRedo.ChangeAction.prototype.undo=function(t,o){for(var n=e.helper.deepClone(this.changes),i=t.countEmptyRows(!0),r=t.countEmptyCols(!0),s=0,a=n.length;a>s;s++)n[s].splice(3,1);t.addHookOnce("afterChange",o),t.setDataAtRowProp(n,null,null,"undo");for(var s=0,a=n.length;a>s;s++)t.getSettings().minSpareRows&&n[s][0]+1+t.getSettings().minSpareRows===t.countRows()&&i==t.getSettings().minSpareRows&&(t.alter("remove_row",parseInt(n[s][0]+1,10),t.getSettings().minSpareRows),t.undoRedo.doneActions.pop()),t.getSettings().minSpareCols&&n[s][1]+1+t.getSettings().minSpareCols===t.countCols()&&r==t.getSettings().minSpareCols&&(t.alter("remove_col",parseInt(n[s][1]+1,10),t.getSettings().minSpareCols),t.undoRedo.doneActions.pop())},e.UndoRedo.ChangeAction.prototype.redo=function(t,o){for(var n=e.helper.deepClone(this.changes),i=0,r=n.length;r>i;i++)n[i].splice(2,1);t.addHookOnce("afterChange",o),t.setDataAtRowProp(n,null,null,"redo")},e.UndoRedo.CreateRowAction=function(e,t){this.index=e,this.amount=t},e.helper.inherit(e.UndoRedo.CreateRowAction,e.UndoRedo.Action),e.UndoRedo.CreateRowAction.prototype.undo=function(e,t){var o=e.countRows(),n=e.getSettings().minSpareRows;this.index>=o&&this.index-n<o&&(this.index-=n),e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.amount)},e.UndoRedo.CreateRowAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateRow",t),e.alter("insert_row",this.index+1,this.amount)},e.UndoRedo.RemoveRowAction=function(e,t){this.index=e,this.data=t},e.helper.inherit(e.UndoRedo.RemoveRowAction,e.UndoRedo.Action),e.UndoRedo.RemoveRowAction.prototype.undo=function(e,t){var o=[this.index,0];Array.prototype.push.apply(o,this.data),Array.prototype.splice.apply(e.getData(),o),e.addHookOnce("afterRender",t),e.render()},e.UndoRedo.RemoveRowAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.data.length)},e.UndoRedo.CreateColumnAction=function(e,t){this.index=e,this.amount=t},e.helper.inherit(e.UndoRedo.CreateColumnAction,e.UndoRedo.Action),e.UndoRedo.CreateColumnAction.prototype.undo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount)},e.UndoRedo.CreateColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateCol",t),e.alter("insert_col",this.index+1,this.amount)},e.UndoRedo.CellAlignmentAction=function(e,t,o,n){this.stateBefore=e,this.range=t,this.type=o,this.alignment=n},e.UndoRedo.CellAlignmentAction.prototype.undo=function(e,t){if(e.contextMenu){for(var o=this.range.from.row;o<=this.range.to.row;o++)for(var n=this.range.from.col;n<=this.range.to.col;n++)e.setCellMeta(o,n,"className",this.stateBefore[o][n]||" htLeft");e.addHookOnce("afterRender",t),e.render()}},e.UndoRedo.CellAlignmentAction.prototype.redo=function(e,t){if(e.contextMenu){for(var o=this.range.from.row;o<=this.range.to.row;o++)for(var n=this.range.from.col;n<=this.range.to.col;n++)e.contextMenu.align.call(e,this.range,this.type,this.alignment);e.addHookOnce("afterRender",t),e.render()}},e.UndoRedo.RemoveColumnAction=function(e,t,o){this.index=e,this.data=t,this.amount=this.data[0].length,this.headers=o},e.helper.inherit(e.UndoRedo.RemoveColumnAction,e.UndoRedo.Action),e.UndoRedo.RemoveColumnAction.prototype.undo=function(e,t){for(var o,n,i=0,r=e.getData().length;r>i;i++)o=e.getSourceDataAtRow(i),n=[this.index,0],Array.prototype.push.apply(n,this.data[i]),Array.prototype.splice.apply(o,n);"undefined"!=typeof this.headers&&(n=[this.index,0],Array.prototype.push.apply(n,this.headers),Array.prototype.splice.apply(e.getSettings().colHeaders,n)),e.addHookOnce("afterRender",t),e.render()},e.UndoRedo.RemoveColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount)}}(t),function(e){function t(){var t=this,s="undefined"==typeof t.getSettings().undo||t.getSettings().undo;s?t.undoRedo||(t.undoRedo=new e.UndoRedo(t),i(t),t.addHook("beforeKeyDown",o),t.addHook("afterChange",n)):t.undoRedo&&(delete t.undoRedo,r(t),t.removeHook("beforeKeyDown",o),t.removeHook("afterChange",n))}function o(e){var t=this,o=(e.ctrlKey||e.metaKey)&&!e.altKey;o&&(89===e.keyCode||e.shiftKey&&90===e.keyCode?(t.undoRedo.redo(),e.stopImmediatePropagation()):90===e.keyCode&&(t.undoRedo.undo(),e.stopImmediatePropagation()))}function n(e,t){var o=this;return"loadData"==t?o.undoRedo.clear():void 0}function i(e){e.undo=function(){return e.undoRedo.undo()},e.redo=function(){return e.undoRedo.redo()},e.isUndoAvailable=function(){return e.undoRedo.isUndoAvailable()},e.isRedoAvailable=function(){return e.undoRedo.isRedoAvailable()},e.clearUndo=function(){return e.undoRedo.clear()}}function r(e){delete e.undo,delete e.redo,delete e.isUndoAvailable,delete e.isRedoAvailable,delete e.clearUndo}e.hooks.add("afterInit",t),e.hooks.add("afterUpdateSettings",t)}(t),s.prototype.setBoundaries=function(e){this.boundaries=e},s.prototype.setCallback=function(e){this.callback=e},s.prototype.check=function(e,t){var o=0,n=0;t<this.boundaries.top?n=t-this.boundaries.top:t>this.boundaries.bottom&&(n=t-this.boundaries.bottom),e<this.boundaries.left?o=e-this.boundaries.left:e>this.boundaries.right&&(o=e-this.boundaries.right),this.callback(o,n)};var z,G;if("undefined"!=typeof t){var U=function(t){t.dragToScrollListening=!1;var o=t.view.wt.wtScrollbars.vertical.scrollHandler;z=new s,o!==e&&(z.setBoundaries(o.getBoundingClientRect()),z.setCallback(function(e,t){0>e?o.scrollLeft-=50:e>0&&(o.scrollLeft+=50),0>t?o.scrollTop-=20:t>0&&(o.scrollTop+=20)}),t.dragToScrollListening=!0)};t.hooks.add("afterInit",function(){var e=this,o=t.eventManager(this);o.addEventListener(document,"mouseup",function(){e.dragToScrollListening=!1}),o.addEventListener(document,"mousemove",function(t){e.dragToScrollListening&&z.check(t.clientX,t.clientY)})}),t.hooks.add("afterDestroy",function(){var e=t.eventManager(this);e.clear()}),t.hooks.add("afterOnCellMouseDown",function(){U(this)}),t.hooks.add("afterOnCellCornerMouseDown",function(){U(this)}),t.plugins.DragToScroll=s}if(function(e,t,o){function n(n){function i(){n.isListening()&&n.selection.empty()}function r(e){var t,i,r,s,a,l,c,u,f,p;n.isListening()&&n.selection.isSelected()&&(t=e,i=o.parse(t),r=n.getSelected(),s=new h(r[0],r[1]),a=new h(r[2],r[3]),l=new d(s,s,a),c=l.getTopLeftCorner(),u=l.getBottomRightCorner(),f=c,p=new h(Math.max(u.row,i.length-1+c.row),Math.max(u.col,i[0].length-1+c.col)),n.addHookOnce("afterChange",function(e,t){e&&e.length&&this.selectCell(f.row,f.col,p.row,p.col)}),n.populateFromArray(f.row,f.col,i,p.row,p.col,"paste",n.getSettings().pasteMode))}function s(t){var o;if(n.getSelected()){if(e.helper.isCtrlKey(t.keyCode))return a.setCopyableText(),void t.stopImmediatePropagation();o=(t.ctrlKey||t.metaKey)&&!t.altKey,t.keyCode==e.helper.keyCode.A&&o&&n._registerTimeout(setTimeout(e.helper.proxy(a.setCopyableText,a),0))}}var a=this;this.copyPasteInstance=t.getInstance(),this.copyPasteInstance.onCut(i),this.copyPasteInstance.onPaste(r),n.addHook("beforeKeyDown",s),this.destroy=function(){this.copyPasteInstance.removeCallback(i),this.copyPasteInstance.removeCallback(r),this.copyPasteInstance.destroy(),n.removeHook("beforeKeyDown",s)},n.addHook("afterDestroy",e.helper.proxy(this.destroy,this)),this.triggerPaste=e.helper.proxy(this.copyPasteInstance.triggerPaste,this.copyPasteInstance),this.triggerCut=e.helper.proxy(this.copyPasteInstance.triggerCut,this.copyPasteInstance),this.setCopyableText=function(){var t=n.getSettings(),o=t.copyRowsLimit,i=t.copyColsLimit,r=n.getSelectedRange(),s=r.getTopLeftCorner(),a=r.getBottomRightCorner(),l=s.row,c=s.col,u=a.row,h=a.col,d=Math.min(u,l+o-1),f=Math.min(h,c+i-1);n.copyPaste.copyPasteInstance.copyable(n.getCopyableData(l,c,d,f)),(u!==d||h!==f)&&e.hooks.run(n,"afterCopyLimit",u-l+1,h-c+1,o,i)}}function i(){var e=this,t=e.getSettings().copyPaste!==!1;t&&!e.copyPaste?e.copyPaste=new n(e):!t&&e.copyPaste&&(e.copyPaste.destroy(),delete e.copyPaste)}e.hooks.add("afterInit",i),e.hooks.add("afterUpdateSettings",i),e.hooks.register("afterCopyLimit")}(t,I,SheetClip),function(e){function t(){var t=this,o=!!t.getSettings().search;o?t.search=new e.Search(t):delete t.search}e.Search=function(t){this.query=function(o,n,i){var r=t.countRows(),s=t.countCols(),a=[];n||(n=e.Search.global.getDefaultCallback()),i||(i=e.Search.global.getDefaultQueryMethod());for(var l=0;r>l;l++)for(var c=0;s>c;c++){var u=t.getDataAtCell(l,c),h=t.getCellMeta(l,c),d=h.search.callback||n,f=h.search.queryMethod||i,p=f(o,u);if(p){var m={row:l,col:c,data:u};a.push(m)}d&&d(t,l,c,u,p)}return a}},e.Search.DEFAULT_CALLBACK=function(e,t,o,n,i){e.getCellMeta(t,o).isSearchResult=i},e.Search.DEFAULT_QUERY_METHOD=function(e,t){return"undefined"!=typeof e&&null!=e&&e.toLowerCase&&0!==e.length?"undefined"==typeof t||null==t?!1:-1!=t.toString().toLowerCase().indexOf(e.toLowerCase()):!1},e.Search.DEFAULT_SEARCH_RESULT_CLASS="htSearchResult",e.Search.global=function(){var t=e.Search.DEFAULT_CALLBACK,o=e.Search.DEFAULT_QUERY_METHOD,n=e.Search.DEFAULT_SEARCH_RESULT_CLASS;return{getDefaultCallback:function(){return t},setDefaultCallback:function(e){t=e},getDefaultQueryMethod:function(){return o},setDefaultQueryMethod:function(e){o=e},getDefaultSearchResultClass:function(){return n},setDefaultSearchResultClass:function(e){n=e}}}(),e.SearchCellDecorator=function(t,o,n,i,r,s,a){var l="object"==typeof a.search&&a.search.searchResultClass||e.Search.global.getDefaultSearchResultClass();a.isSearchResult?e.Dom.addClass(o,l):e.Dom.removeClass(o,l)};var o=e.renderers.cellDecorator;e.renderers.cellDecorator=function(t,n,i,r,s,a,l){o.apply(this,arguments),e.SearchCellDecorator.apply(this,arguments)},e.hooks.add("afterInit",t),e.hooks.add("afterUpdateSettings",t)}(t),l.prototype.canMergeRange=function(e){return!e.isSingle()},l.prototype.mergeRange=function(e){if(this.canMergeRange(e)){var t=e.getTopLeftCorner(),o=e.getBottomRightCorner(),n={};n.row=t.row,n.col=t.col,n.rowspan=o.row-t.row+1,n.colspan=o.col-t.col+1,this.mergedCellInfoCollection.setInfo(n)}},l.prototype.mergeOrUnmergeSelection=function(e){var t=this.mergedCellInfoCollection.getInfo(e.from.row,e.from.col);t?this.unmergeSelection(e.from):this.mergeSelection(e)},l.prototype.mergeSelection=function(e){this.mergeRange(e)},l.prototype.unmergeSelection=function(e){var t=this.mergedCellInfoCollection.getInfo(e.row,e.col);this.mergedCellInfoCollection.removeInfo(t.row,t.col)},l.prototype.applySpanProperties=function(e,t,o){var n=this.mergedCellInfoCollection.getInfo(t,o);n?n.row===t&&n.col===o?(e.setAttribute("rowspan",n.rowspan),e.setAttribute("colspan",n.colspan)):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="none"):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"))},l.prototype.modifyTransform=function(e,t,o){var n=function(e,t){return t.row>=e.row&&t.row<=e.row+e.rowspan-1?!0:!1},i=function(e,t){return t.col>=e.col&&t.col<=e.col+e.colspan-1?!0:!1},r=function(e){return new h(t.to.row+e.row,t.to.col+e.col)},s={row:o.row,col:o.col};if("modifyTransformStart"==e){this.lastDesiredCoords||(this.lastDesiredCoords=new h(null,null));for(var a,l=new h(t.highlight.row,t.highlight.col),c=this.mergedCellInfoCollection.getInfo(l.row,l.col),u=0,f=this.mergedCellInfoCollection.length;f>u;u++){var p=this.mergedCellInfoCollection[u];if(p=new h(p.row+p.rowspan-1,p.col+p.colspan-1),t.includes(p)){a=!0;break}}if(c){var m=new h(c.row,c.col),g=new h(c.row+c.rowspan-1,c.col+c.colspan-1),w=new d(m,m,g);w.includes(this.lastDesiredCoords)||(this.lastDesiredCoords=new h(null,null)),s.row=this.lastDesiredCoords.row?this.lastDesiredCoords.row-l.row:s.row,s.col=this.lastDesiredCoords.col?this.lastDesiredCoords.col-l.col:s.col,o.row>0?s.row=c.row+c.rowspan-1-l.row+o.row:o.row<0&&(s.row=l.row-c.row+o.row),o.col>0?s.col=c.col+c.colspan-1-l.col+o.col:o.col<0&&(s.col=l.col-c.col+o.col)}var v=new h(t.highlight.row+s.row,t.highlight.col+s.col),C=this.mergedCellInfoCollection.getInfo(v.row,v.col);C&&(this.lastDesiredCoords=v,s={row:C.row-l.row,col:C.col-l.col})}else if("modifyTransformEnd"==e)for(var u=0,f=this.mergedCellInfoCollection.length;f>u;u++){var y=this.mergedCellInfoCollection[u],m=new h(y.row,y.col),g=new h(y.row+y.rowspan-1,y.col+y.colspan-1),b=new d(m,m,g),R=t.getBordersSharedWith(b);if(b.isEqual(t))t.setDirection("NW-SE");else if(R.length>0){var S=t.highlight.isEqual(b.from);R.indexOf("top")>-1?t.to.isSouthEastOf(b.from)&&S?t.setDirection("NW-SE"):t.to.isSouthWestOf(b.from)&&S&&t.setDirection("NE-SW"):R.indexOf("bottom")>-1&&(t.to.isNorthEastOf(b.from)&&S?t.setDirection("SW-NE"):t.to.isNorthWestOf(b.from)&&S&&t.setDirection("SE-NW"))}var v=r(s),E=n(y,v),T=i(y,v);t.includesRange(b)&&(b.includes(v)||E||T)&&(E&&(s.row<0?s.row-=y.rowspan-1:s.row>0&&(s.row+=y.rowspan-1)),T&&(s.col<0?s.col-=y.colspan-1:s.col>0&&(s.col+=y.colspan-1)))}0!==s.row&&(o.row=s.row),0!==s.col&&(o.col=s.col)},"undefined"==typeof t)throw new Error("Handsontable is not defined");var j=function(){var e=this,t=e.getSettings().mergeCells;t&&(e.mergeCells||(e.mergeCells=new l(t)))},X=function(){var e=this;e.mergeCells&&(e.view.wt.wtTable.getCell=function(t){if(e.getSettings().mergeCells){var o=e.mergeCells.mergedCellInfoCollection.getInfo(t.row,t.col);o&&(t=o)}return k.prototype.getCell.call(this,t)})},K=function(e){if(this.mergeCells){var t=(e.ctrlKey||e.metaKey)&&!e.altKey;t&&77===e.keyCode&&(this.mergeCells.mergeOrUnmergeSelection(this.getSelectedRange()),this.render(),e.stopImmediatePropagation())}},Y=function(e){this.getSettings().mergeCells&&(e.items.push(t.ContextMenu.SEPARATOR),e.items.push({key:"mergeCells",name:function(){var e=this.getSelected(),t=this.mergeCells.mergedCellInfoCollection.getInfo(e[0],e[1]);return t?"Unmerge cells":"Merge cells"},callback:function(){this.mergeCells.mergeOrUnmergeSelection(this.getSelectedRange()),this.render()},disabled:function(){return!1}}))},_=function(e,t,o,n,i,r){this.mergeCells&&this.mergeCells.applySpanProperties(e,t,o)},q=function(e){return function(t){var o=this.getSettings().mergeCells;if(o){var n=this.getSelectedRange();if(this.mergeCells.modifyTransform(e,n,t),"modifyTransformEnd"===e){var i=this.countRows(),r=this.countCols();n.from.row<0?n.from.row=0:n.from.row>0&&n.from.row>=i&&(n.from.row=n.from-1),n.from.col<0?n.from.col=0:n.from.col>0&&n.from.col>=r&&(n.from.col=r-1)}}}},$=function(e){this.lastDesiredCoords=null;var t=this.getSettings().mergeCells;if(t){var o=this.getSelectedRange();o.highlight=new h(o.highlight.row,o.highlight.col),o.to=e;var n=!1;do{n=!1;for(var i=0,r=this.mergeCells.mergedCellInfoCollection.length;r>i;i++){var s=this.mergeCells.mergedCellInfoCollection[i],a=new h(s.row,s.col),l=new h(s.row+s.rowspan-1,s.col+s.colspan-1),c=new d(a,a,l);o.expandByRange(c)&&(e.row=o.to.row,e.col=o.to.col,n=!0)}}while(n)}},Q=function(e,t){if(t&&"area"==t){var o=this.getSettings().mergeCells;if(o)for(var n=this.getSelectedRange(),i=new d(n.from,n.from,n.from),r=new d(n.to,n.to,n.to),s=0,a=this.mergeCells.mergedCellInfoCollection.length;a>s;s++){var l=this.mergeCells.mergedCellInfoCollection[s],c=new h(l.row,l.col),u=new h(l.row+l.rowspan-1,l.col+l.colspan-1),f=new d(c,c,u);i.expandByRange(f)&&(e[0]=i.from.row,e[1]=i.from.col),r.expandByRange(f)&&(e[2]=r.from.row,e[3]=r.from.col)}}},J=function(e,t,o){var n=this.getSettings().mergeCells;if(n){var i=this.mergeCells.mergedCellInfoCollection.getInfo(e,t);!i||i.row==e&&i.col==t||(o.copyable=!1)}},Z=function(e){var t=this.getSettings().mergeCells;if(t)for(var o,n=this.countCols(),i=0;n>i;i++){if(o=this.mergeCells.mergedCellInfoCollection.getInfo(e.startRow,i),o&&o.row<e.startRow)return e.startRow=o.row,Z.call(this,e);if(o=this.mergeCells.mergedCellInfoCollection.getInfo(e.endRow,i)){var r=o.row+o.rowspan-1;if(r>e.endRow)return e.endRow=r,Z.call(this,e)}}},ee=function(e){var t=this.getSettings().mergeCells;if(t)for(var o,n=this.countRows(),i=0;n>i;i++){if(o=this.mergeCells.mergedCellInfoCollection.getInfo(i,e.startColumn),o&&o.col<e.startColumn)return e.startColumn=o.col,ee.call(this,e);if(o=this.mergeCells.mergedCellInfoCollection.getInfo(i,e.endColumn)){var r=o.col+o.colspan-1;if(r>e.endColumn)return e.endColumn=r,ee.call(this,e)}}},te=function(e){if(e&&this.mergeCells){var t=this.mergeCells.mergedCellInfoCollection,o=this.getSelectedRange();for(var n in t)if(o.highlight.row==t[n].row&&o.highlight.col==t[n].col&&o.to.row==t[n].row+t[n].rowspan-1&&o.to.col==t[n].col+t[n].colspan-1)return!1}return e};t.hooks.add("beforeInit",j),t.hooks.add("afterInit",X),t.hooks.add("beforeKeyDown",K),t.hooks.add("modifyTransformStart",q("modifyTransformStart")),t.hooks.add("modifyTransformEnd",q("modifyTransformEnd")),t.hooks.add("beforeSetRangeEnd",$),t.hooks.add("beforeDrawBorders",Q),t.hooks.add("afterIsMultipleSelection",te),t.hooks.add("afterRenderer",_),t.hooks.add("afterContextMenuDefaultOptions",Y),t.hooks.add("afterGetCellMeta",J),t.hooks.add("afterViewportRowCalculatorOverride",Z),t.hooks.add("afterViewportColumnCalculatorOverride",ee),t.MergeCells=l,
function(){function e(){}var o,n=function(e){return"boolean"==typeof e&&e===!0?!0:"object"==typeof e&&e.length>0?!0:!1},i=function(){n(this.getSettings().customBorders)&&(this.customBorders||(o=this,this.customBorders=new e))},r=function(e){for(var t=0;t<o.view.wt.selections.length;t++)if(o.view.wt.selections[t].settings.className==e)return t;return-1},s=function(e){var t={row:e.row,col:e.col},n=new T(e,new d(t,t,t)),i=r(e.className);i>=0?o.view.wt.selections[i]=n:o.view.wt.selections.push(n)},a=function(e,t,o){var n=p(e,t);n=m(n,o),this.setCellMeta(e,t,"borders",n),s(n)},l=function(e){for(var t=e.range,o=t.from.row;o<=t.to.row;o++)for(var n=t.from.col;n<=t.to.col;n++){var i=p(o,n),r=0;o==t.from.row&&(r++,e.hasOwnProperty("top")&&(i.top=e.top)),o==t.to.row&&(r++,e.hasOwnProperty("bottom")&&(i.bottom=e.bottom)),n==t.from.col&&(r++,e.hasOwnProperty("left")&&(i.left=e.left)),n==t.to.col&&(r++,e.hasOwnProperty("right")&&(i.right=e.right)),r>0&&(this.setCellMeta(o,n,"borders",i),s(i))}},c=function(e,t){return"border_row"+e+"col"+t},u=function(){return{width:1,color:"#000"}},h=function(){return{hide:!0}},f=function(){return{width:1,color:"#000",cornerVisible:!1}},p=function(e,t){return{className:c(e,t),border:f(),row:e,col:t,top:h(),right:h(),bottom:h(),left:h()}},m=function(e,t){return t.hasOwnProperty("border")&&(e.border=t.border),t.hasOwnProperty("top")&&(e.top=t.top),t.hasOwnProperty("right")&&(e.right=t.right),t.hasOwnProperty("bottom")&&(e.bottom=t.bottom),t.hasOwnProperty("left")&&(e.left=t.left),e},g=function(e){for(var t=document.querySelectorAll("."+e),o=0;o<t.length;o++)if(t[o]&&"TD"!=t[o].nodeName){var n=t[o].parentNode;n.parentNode&&n.parentNode.removeChild(n)}},w=function(e,t){var o=c(e,t);g(o),this.removeCellMeta(e,t,"borders")},v=function(e,t,o,n){var i=this.getCellMeta(e,t).borders;i&&void 0!=i.border||(i=p(e,t)),n?i[o]=h():i[o]=u(),this.setCellMeta(e,t,"borders",i);var r=c(e,t);g(r),s(i),this.render()},C=function(e,t,o){if(e.from.row==e.to.row&&e.from.col==e.to.col)"noBorders"==t?w.call(this,e.from.row,e.from.col):v.call(this,e.from.row,e.from.col,t,o);else switch(t){case"noBorders":for(var n=e.from.col;n<=e.to.col;n++)for(var i=e.from.row;i<=e.to.row;i++)w.call(this,i,n);break;case"top":for(var r=e.from.col;r<=e.to.col;r++)v.call(this,e.from.row,r,t,o);break;case"right":for(var s=e.from.row;s<=e.to.row;s++)v.call(this,s,e.to.col,t);break;case"bottom":for(var a=e.from.col;a<=e.to.col;a++)v.call(this,e.to.row,a,t);break;case"left":for(var l=e.from.row;l<=e.to.row;l++)v.call(this,l,e.from.col,t)}},y=function(e,t){var o=!1;return e.getSelectedRange().forAll(function(n,i){var r=e.getCellMeta(n,i).borders;if(r){if(!t)return o=!0,!1;if(!r[t].hasOwnProperty("hide"))return o=!0,!1}}),o},b=function(e){return"<span class='selected'>"+String.fromCharCode(10003)+"</span>"+e},R=function(e){this.getSettings().customBorders&&(e.items.push(t.ContextMenu.SEPARATOR),e.items.push({key:"borders",name:"Borders",submenu:{items:{top:{name:function(){var e="Top",t=y(this,"top");return t&&(e=b(e)),e},callback:function(){var e=y(this,"top");C.call(this,this.getSelectedRange(),"top",e)},disabled:!1},right:{name:function(){var e="Right",t=y(this,"right");return t&&(e=b(e)),e},callback:function(){var e=y(this,"right");C.call(this,this.getSelectedRange(),"right",e)},disabled:!1},bottom:{name:function(){var e="Bottom",t=y(this,"bottom");return t&&(e=b(e)),e},callback:function(){var e=y(this,"bottom");C.call(this,this.getSelectedRange(),"bottom",e)},disabled:!1},left:{name:function(){var e="Left",t=y(this,"left");return t&&(e=b(e)),e},callback:function(){var e=y(this,"left");C.call(this,this.getSelectedRange(),"left",e)},disabled:!1},remove:{name:"Remove border(s)",callback:function(){C.call(this,this.getSelectedRange(),"noBorders")},disabled:function(){return!y(this)}}}}}))};t.hooks.add("beforeInit",i),t.hooks.add("afterContextMenuDefaultOptions",R),t.hooks.add("afterInit",function(){var e=this.getSettings().customBorders;if(e){for(var t=0;t<e.length;t++)e[t].range?l.call(this,e[t]):a.call(this,e[t].row,e[t].col,e[t]);this.render(),this.view.wt.draw(!0)}}),t.CustomBorders=e}(),function(t){function o(){function o(e){G=this,d=e;var t=this.view.wt.wtTable.getCoords(e).row;if(t>=0){h=t;var o=d.getBoundingClientRect();u=o.top,f.style.top=u+"px",f.style.left=o.left+"px",G.rootElement.appendChild(f)}}function n(e,t){var o=e.getBoundingClientRect(),n=6;t>0?f.style.top=o.top+o.height-n+"px":f.style.top=o.top+"px"}function i(){var e=this;t.Dom.addClass(f,"active"),t.Dom.addClass(p,"active");var o=d.getBoundingClientRect();p.style.width=e.view.maximumVisibleElementWidth(0)+"px",p.style.height=o.height+"px",p.style.top=u+"px",p.style.left=f.style.left,e.rootElement.appendChild(p)}function r(e){p.style.top=u+e+"px"}function s(){t.Dom.removeClass(f,"active"),t.Dom.removeClass(p,"active")}var a,l,c,u,h,d,f=document.createElement("DIV"),p=document.createElement("DIV"),m=t.eventManager(this);f.className="manualRowMover",p.className="manualRowMoverGuide";var g=function(){var e=this;t.hooks.run(e,"persistentStateSave","manualRowPositions",e.manualRowPositions)},w=function(){var e=this,o={};return t.hooks.run(e,"persistentStateLoad","manualRowPositions",o),o.value},v=function(e){return"BODY"!=e.tagName?"TBODY"==e.parentNode.tagName?!0:(e=e.parentNode,v(e)):!1},C=function(e){return"TABLE"!=e.tagName?"TH"==e.tagName?e:C(e.parentNode):null},y=function(){var u,f=this;m.addEventListener(f.rootElement,"mouseover",function(e){if(v(e.target)){var t=C(e.target);t&&(u?(l=f.view.wt.wtTable.getCoords(t).row,n(t,l-a)):o.call(f,t))}}),m.addEventListener(f.rootElement,"mousedown",function(e){t.Dom.hasClass(e.target,"manualRowMover")&&(c=t.helper.pageY(e),i.call(f),u=f,a=h,l=h)}),m.addEventListener(e,"mousemove",function(e){u&&r(t.helper.pageY(e)-c)}),m.addEventListener(e,"mouseup",function(e){u&&(s(),u=!1,R(f.manualRowPositions,f.countRows()),f.manualRowPositions.splice(l,0,f.manualRowPositions.splice(a,1)[0]),f.forceFullRender=!0,f.view.render(),g.call(f),t.hooks.run(f,"afterRowMove",a,l),o.call(f,d))}),f.addHook("afterDestroy",b)},b=function(){m.clear()},R=function(e,t){if(e.length<t)for(var o=e.length;t>o;o++)e[o]=o};this.beforeInit=function(){this.manualRowPositions=[]},this.init=function(e){var t=this,o=!!t.getSettings().manualRowMove;if(o){var n=t.getSettings().manualRowMove,i=w.call(t);"undefined"!=typeof t.manualRowPositionsPluginUsages?t.manualRowPositionsPluginUsages.push("manualColumnMove"):t.manualRowPositionsPluginUsages=["manualColumnMove"],"undefined"!=typeof i?this.manualRowPositions=i:Array.isArray(n)?this.manualRowPositions=n:this.manualRowPositions=[],"afterInit"===e&&(y.call(this),this.manualRowPositions.length>0&&(t.forceFullRender=!0,t.render()))}else{var r=t.manualRowPositionsPluginUsages?t.manualRowPositionsPluginUsages.indexOf("manualColumnMove"):-1;r>-1&&(b.call(this),t.manualRowPositions=[],t.manualRowPositionsPluginUsages[r]=void 0)}},this.modifyRow=function(e){var t=this;return t.getSettings().manualRowMove?("undefined"==typeof t.manualRowPositions[e]&&R(this.manualRowPositions,e+1),t.manualRowPositions[e]):e}}var n=new o;t.hooks.add("beforeInit",n.beforeInit),t.hooks.add("afterInit",function(){n.init.call(this,"afterInit")}),t.hooks.add("afterUpdateSettings",function(){n.init.call(this,"afterUpdateSettings")}),t.hooks.add("modifyRow",n.modifyRow),t.hooks.register("afterRowMove")}(t),function(t){function o(o){this.instance=o,this.addingStarted=!1;var n,i,r=!1,s=this,a=t.eventManager(o),l=function(e){return o.autofill?void(o.autofill.handle&&o.autofill.handle.isDragged&&(o.autofill.handle.isDragged>1&&o.autofill.apply(),o.autofill.handle.isDragged=0,r=!1)):!0};a.addEventListener(document,"mouseup",function(e){l(e)}),a.addEventListener(document,"mousemove",function(o){if(!s.instance.autofill)return 0;var n=t.Dom.offset(s.instance.table).top-(e.pageYOffset||document.documentElement.scrollTop)+t.Dom.outerHeight(s.instance.table),i=t.Dom.offset(s.instance.table).left-(e.pageXOffset||document.documentElement.scrollLeft)+t.Dom.outerWidth(s.instance.table);s.addingStarted===!1&&s.instance.autofill.handle.isDragged>0&&o.clientY>n&&o.clientX<=i?(this.mouseDragOutside=!0,s.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&setTimeout(function(){s.addingStarted=!1,s.instance.alter("insert_row")},200)}),n=this.instance.view.wt.wtSettings.settings.onCellCornerMouseDown,this.instance.view.wt.wtSettings.settings.onCellCornerMouseDown=function(e){o.autofill.handle.isDragged=1,r=!0,n(e)},i=this.instance.view.wt.wtSettings.settings.onCellMouseOver,this.instance.view.wt.wtSettings.settings.onCellMouseOver=function(e,t,n,s){o.autofill&&r&&!o.view.isMouseDown()&&o.autofill.handle&&o.autofill.handle.isDragged&&(o.autofill.handle.isDragged++,o.autofill.showBorder(t),o.autofill.checkIfNewRowNeeded()),i(e,t,n,s)},this.instance.view.wt.wtSettings.settings.onCellCornerDblClick=function(){o.autofill.selectAdjacent()}}o.prototype.init=function(){this.handle={}},o.prototype.disable=function(){this.handle.disabled=!0},o.prototype.selectAdjacent=function(){var e,t,o,n,i;e=this.instance.selection.isMultiple()?this.instance.view.wt.selections.area.getCorners():this.instance.view.wt.selections.current.getCorners(),t=this.instance.getData();e:for(o=e[2]+1;o<this.instance.countRows();o++){for(i=e[1];i<=e[3];i++)if(t[o][i])break e;(t[o][e[1]-1]||t[o][e[3]+1])&&(n=o)}n&&(this.instance.view.wt.selections.fill.clear(),this.instance.view.wt.selections.fill.add(new h(e[0],e[1])),this.instance.view.wt.selections.fill.add(new h(n,e[3])),this.apply())},o.prototype.apply=function(){var e,o,n,i,r;if(this.handle.isDragged=0,e=this.instance.view.wt.selections.fill.getCorners()){var s=function(e,t,o,n){var i,r,s,a=o.length,l=o?o[0].length:0,c=[],u=t.row-e.row,h=t.col-e.col,d=[];if(-1!==["down","up"].indexOf(n)){for(var f=0;h>=f;f++)i=parseInt(o[0][f],10),r=parseInt(o[a-1][f],10),s=("down"===n?r-i:i-r)/(a-1)||0,d.push(s);c.push(d)}if(-1!==["right","left"].indexOf(n))for(var p=0;u>=p;p++)i=parseInt(o[p][0],10),r=parseInt(o[p][l-1],10),s=("right"===n?r-i:i-r)/(l-1)||0,d=[],d.push(s),c.push(d);return c};this.instance.view.wt.selections.fill.clear(),o=this.instance.selection.isMultiple()?this.instance.view.wt.selections.area.getCorners():this.instance.view.wt.selections.current.getCorners();var a;if(e[0]===o[0]&&e[1]<o[1]?(a="left",n=new h(e[0],e[1]),i=new h(e[2],o[1]-1)):e[0]===o[0]&&e[3]>o[3]?(a="right",n=new h(e[0],o[3]+1),i=new h(e[2],e[3])):e[0]<o[0]&&e[1]===o[1]?(a="up",n=new h(e[0],e[1]),i=new h(o[0]-1,e[3])):e[2]>o[2]&&e[1]===o[1]&&(a="down",n=new h(o[2]+1,e[1]),i=new h(e[2],e[3])),n&&n.row>-1&&n.col>-1){var l={from:this.instance.getSelectedRange().from,to:this.instance.getSelectedRange().to};r=this.instance.getData(l.from.row,l.from.col,l.to.row,l.to.col);var c=s(n,i,r,a);t.hooks.run(this.instance,"beforeAutofill",n,i,r),this.instance.populateFromArray(n.row,n.col,r,i.row,i.col,"autofill",null,a,c),this.instance.selection.setRangeStart(new h(e[0],e[1])),this.instance.selection.setRangeEnd(new h(e[2],e[3]))}else this.instance.selection.refreshBorders()}},o.prototype.showBorder=function(e){var t=this.instance.getSelectedRange().getTopLeftCorner(),o=this.instance.getSelectedRange().getBottomRightCorner();if("horizontal"!==this.instance.getSettings().fillHandle&&(o.row<e.row||t.row>e.row))e=new h(e.row,o.col);else{if("vertical"===this.instance.getSettings().fillHandle)return;e=new h(o.row,e.col)}this.instance.view.wt.selections.fill.clear(),this.instance.view.wt.selections.fill.add(this.instance.getSelectedRange().from),this.instance.view.wt.selections.fill.add(this.instance.getSelectedRange().to),this.instance.view.wt.selections.fill.add(e),this.instance.view.render()},o.prototype.checkIfNewRowNeeded=function(){var e,t,o=this.instance.countRows(),n=this;this.instance.view.wt.selections.fill.cellRange&&this.addingStarted===!1&&(t=this.instance.getSelected(),e=this.instance.view.wt.selections.fill.getCorners(),t[2]<o-1&&e[2]===o-1&&(this.addingStarted=!0,this.instance._registerTimeout(setTimeout(function(){n.instance.alter("insert_row"),n.addingStarted=!1},200))))},t.hooks.add("afterInit",function(){var e=new o(this);"undefined"!=typeof this.getSettings().fillHandle&&(e.handle&&this.getSettings().fillHandle===!1?e.disable():e.handle||this.getSettings().fillHandle===!1||(this.autofill=e,this.autofill.init()))}),t.Autofill=o}(t);var oe=function(e){var o=[],n={rows:0,cols:0},i={rows:0,cols:0},r=[],s=[],a={groupIndicatorContainer:"htGroupIndicatorContainer",groupIndicator:function(e){return"ht"+e+"Group"},groupStart:"htGroupStart",collapseButton:"htCollapseButton",expandButton:"htExpandButton",collapseGroupId:function(e){return"htCollapse-"+e},collapseFromLevel:function(e,t){return"htCollapse"+e+"FromLevel-"+t},clickable:"clickable",levelTrigger:"htGroupLevelTrigger"},l=function(e,t){return function(o,n){return"undefined"==typeof t||"asc"===t?o[e]-n[e]:n[e]-o[e]}},c=function(e,t){for(var o=[];t>=e;)o.push(e++);return o},u=function(e,t,o){var n=[],i={row:null,col:null};if("cols"==e)for(;o>=t;)i={row:-1,col:t++},n.push(i);else for(;o>=t;)i={row:t++,col:-1},n.push(i);for(var r=d(n),s=0,a=0,l=0;l<r.length;l++)s+=r[l].filter(function(e){return e.rows}).length,a+=r[l].filter(function(e){return e.cols}).length;return{total:{rows:s,cols:a},groups:r}},d=function(e){for(var t=[],o=0;o<e.length;o++)t.push(f(e[o]));return t},f=function(e,t,n){for(var i=e.row,r=e.col,s=-1===i?0:i,a=-1===r?0:r,l=[],c=0;c<o.length;c++){var u=o[c],h=u.id,d=(u.level,u.rows||[]),f=u.cols||[];-1===l.indexOf(h)&&(-1!==d.indexOf(s)||-1!==f.indexOf(a))&&l.push(u)}-1===r?l=l.concat(w()):-1===i&&(l=l.concat(C())),t&&(l=l.filter(function(e){return e.level===t})),n&&("cols"===n?l=l.filter(function(e){return e.cols}):"rows"===n&&(l=l.filter(function(e){return e.rows})));var p=[];return l.filter(function(e){return-1===p.indexOf(e.id)?(p.push(e.id),e):void 0})},p=function(e){for(var t=0,n=o.length;n>t;t++)if(o[t].id==e)return o[t];return!1},m=function(e,t){for(var n=0,i=o.length;i>n;n++)if(o[n].level==t&&o[n].rows&&o[n].rows.indexOf(e)>-1)return o[n];return!1},g=function(e,t){for(var n=0,i=o.length;i>n;n++)if(o[n].level==t&&o[n].cols&&o[n].cols.indexOf(e)>-1)return o[n];return!1},w=function(){for(var e=[],t=0,n=o.length;n>t;t++)Array.isArray(o[t].cols)&&e.push(o[t]);return e},v=function(e){for(var t=[],n=0,i=o.length;i>n;n++)o[n].cols&&o[n].level===e&&t.push(o[n]);return t},C=function(){for(var e=[],t=0,n=o.length;n>t;t++)Array.isArray(o[t].rows)&&e.push(o[t]);return e},y=function(e){for(var t=[],n=0,i=o.length;i>n;n++)o[n].rows&&o[n].level===e&&t.push(o[n]);return t},b=function(e){var t=0;return e.length&&e.forEach(function(e){if(e=e.filter(function(e){return e.cols}),e.length){var o=e.sort(l("level","desc")),n=o[0].level;n>t&&(t=n)}}),t},R=function(e){var t=0;return e.length&&e.forEach(function(e){if(e=e.filter(function(e){return e.rows}),e.length){var o=e.sort(l("level","desc")),n=o[0].level;n>t&&(t=n)}}),t},S=function(e,t){var r=u("cols",e,t),s=b(r.groups);s===i.cols?i.cols++:s>i.cols&&(i.cols=s+1),n.cols||(n.cols=w().length),n.cols++,o.push({id:"c"+n.cols,level:s+1,cols:c(e,t),hidden:0})},E=function(e,t){var r=u("rows",e,t),s=R(r.groups);i.rows=Math.max(i.rows,s+1),n.rows||(n.rows=C().length),n.rows++,o.push({id:"r"+n.rows,level:s+1,rows:c(e,t),hidden:0})},T=function(e,t){for(var o,n=0,i=t.length;i>n;n++)if(t[n].hidden=e,o=t[n].level,r[o]||(r[o]=[]),s[o]||(s[o]=[]),t[n].rows)for(var a=0,l=t[n].rows.length;l>a;a++)e>0?r[o][t[n].rows[a]]=!0:r[o][t[n].rows[a]]=void 0;else if(t[n].cols)for(var a=0,c=t[n].cols.length;c>a;a++)e>0?s[o][t[n].cols[a]]=!0:s[o][t[n].cols[a]]=void 0},D=function(e,o,n,i){var r,s;switch(e){case"rows":r=m(o+1,n).id,s=t.Grouping.getGroupLevelsByRows();break;case"cols":r=g(o+1,n).id,s=t.Grouping.getGroupLevelsByCols()}return!!(s[o+1]&&s[o+1].indexOf(n)>-1&&i==r)},k=function(e,o,n,i){var r,s;switch(e){case"rows":r=m(o-1,n).id,s=t.Grouping.getGroupLevelsByRows();break;case"cols":r=g(o-1,n).id,s=t.Grouping.getGroupLevelsByCols()}return!!(s[o-1]&&s[o-1].indexOf(n)>-1&&i==r)},A=function(o,n,a,l){if(0===n)return!1;var c,u,h=k(o,n,a,l),d=D(o,n,a,l),f=!1;switch(o){case"rows":c=t.Grouping.getGroupLevelsByRows(),u=e.countRows();for(var p=0;p<=i.rows;p++)if(r[p]&&r[p][n+1]){f=!0;break}break;case"cols":c=t.Grouping.getGroupLevelsByCols(),u=e.countCols();for(var p=0;p<=i.cols;p++)if(s[p]&&s[p][n+1]){f=!0;break}}if(h){if(n==u-1)return!0;if(!d||d&&f)return!0;if(!c[n+1])return!0}return!1},H=function(t){var o;switch(t){case"rows":o=i.rows;for(var n=0;o>=n;n++)if(r[n]&&r[n][e.countRows()-1])return!0;break;case"cols":o=i.cols;for(var n=0;o>=n;n++)if(s[n]&&s[n][e.countCols()-1])return!0}return!1},x=function(o,n,a,l){var c,u,h,d=p(l),f=!1,m=function(e){for(var t=!1,o="rows"==e?r:s,a=0;a<=i[e];a++){for(h=n;d[e].indexOf(h)>-1;)t=!(!o[a]||!o[a][h]),h--;if(t)break}return t},g=k(o,n,a,l),w=D(o,n,a,l);switch(o){case"rows":c=t.Grouping.getGroupLevelsByRows(),u=e.countRows(),f=m(o);break;case"cols":c=t.Grouping.getGroupLevelsByCols(),u=e.countCols(),f=m(o)}if(n==u-1)return!1;if(0===n){if(w)return!0}else if(!g||g&&f){if(w)return!0}else if(!c[n-1]&&w)return!0;return!1},O=function(e,o,n,i,r){var s;switch(e){case"rows":s=m(o-1,n).id;break;case"cols":s=g(o-1,n).id}if(!s)return null;if(o>0&&k(e,o-1,n,s)&&s!=i){var l=document.createElement("DIV");return t.Dom.addClass(l,a.expandButton),l.id="htExpand-"+s,l.appendChild(document.createTextNode("+")),l.setAttribute("data-level",n),l.setAttribute("data-type",e),l.setAttribute("data-hidden","1"),r.appendChild(l),l}return null},P=function(e){for(var t=C(),o=w(),n=0,i=t.length;i>n;n++)if(t[n].rows.indexOf(e.row)>-1&&t[n].hidden)return!0;if(null===e.col)return!1;for(var n=0,r=o.length;r>n;n++)if(o[n].cols.indexOf(e.col)>-1&&o[n].hidden)return!0;return!1};return{getGroups:function(){return o},getLevels:function(){return i},instance:e,baseSpareRows:e.getSettings().minSpareRows,baseSpareCols:e.getSettings().minSpareCols,getRowGroups:C,getColGroups:w,init:function(){var o=e.getSettings().groups;o&&Array.isArray(o)&&t.Grouping.initGroups(o)},initGroups:function(e){o=[],e.forEach(function(e){var t=[],o=!1,n=!1;Array.isArray(e.rows)?(t=e.rows,o=!0):Array.isArray(e.cols)&&(t=e.cols,n=!0);var i=t[0],r=t[t.length-1];o?E(i,r):n&&S(i,r)})},resetGroups:function(){o=[],n={rows:0,cols:0},i={rows:0,cols:0};var e;for(var r in a)if("function"!=typeof a[r]){e=document.querySelectorAll("."+a[r]);for(var s=0,l=e.length;l>s;s++)t.Dom.removeClass(e[s],a[r])}for(var c=["htGroupColClosest","htGroupCol"],r=0,u=c.length;u>r;r++){e=document.querySelectorAll("."+c[r]);for(var s=0,l=e.length;l>s;s++)t.Dom.removeClass(e[s],c[r])}},updateGroups:function(){var e=this.getSettings().groups;t.Grouping.resetGroups(),t.Grouping.initGroups(e)},afterGetRowHeader:function(e,o){for(var n=!1,i=0,s=r.length;s>i;i++)r[i]&&r[i][e]===!0&&(n=!0);n?t.Dom.addClass(o.parentNode,"hidden"):!n&&t.Dom.hasClass(o.parentNode,"hidden")&&t.Dom.removeClass(o.parentNode,"hidden")},afterGetColHeader:function(o,n){var i=this.view.wt.wtSettings.getSetting("rowHeaders").length,r=e.rootElement.querySelectorAll("colgroup col:nth-child("+parseInt(o+i+1,10)+")");if(0!==r.length){for(var a=!1,l=0,c=s.length;c>l;l++)s[l]&&s[l][o]===!0&&(a=!0);if(a)for(var l=0,u=r.length;u>l;l++)t.Dom.addClass(r[l],"hidden");else if(!a&&t.Dom.hasClass(r[0],"hidden"))for(var l=0,u=r.length;u>l;l++)t.Dom.removeClass(r[l],"hidden")}},groupIndicatorsFactory:function(e,o){var r,s,l,c,u,h,d,f;switch(o){case"horizontal":r=t.Grouping.getGroupLevelsByCols(),s=function(e){return Array.prototype.indexOf.call(e.parentNode.parentNode.childNodes,e.parentNode)+1},l=function(e,t){return g(e,t).id},c="cols",u=function(e,t){return g(e-1,t)},h="columnHeaders",d=function(e){if(1===e.length){var o=e[0];e[0]=function(e,n,i){-1>e?w()(e,n,i):(t.Dom.removeClass(n,a.groupIndicatorContainer),o(e,n,i))}}return function(){return e}},f=!0;break;case"vertical":r=t.Grouping.getGroupLevelsByRows(),s=function(e){return t.Dom.index(e)+1},l=function(e,t){return m(e,t).id},c="rows",u=function(e,t){return m(e-1,t)},h="rowHeaders",d=function(e){return e}}var p=function(e){var o=document.createElement("div");return e.appendChild(o),{button:o,addClass:function(e){t.Dom.addClass(o,e)}}},w=function(){var e=o.charAt(0).toUpperCase()+o.slice(1);return function(o,n,i){i++;for(var s,h;s=n.lastChild;)n.removeChild(s);t.Dom.addClass(n,a.groupIndicatorContainer);var d=l(o,i);if(o>-1&&r[o]&&r[o].indexOf(i)>-1&&(h=p(n),h.addClass(a.groupIndicator(e)),x(c,o,i,d)&&h.addClass(a.groupStart),A(c,o,i,d)&&(h.button.appendChild(document.createTextNode("-")),h.addClass(a.collapseButton),h.button.id=a.collapseGroupId(d),h.button.setAttribute("data-level",i),h.button.setAttribute("data-type",c))),f){var m=t.Dom.index(n.parentNode);if(-1===o||-1>o&&m===t.Grouping.getLevels().cols+1||0===m&&0===t.Grouping.getLevels().cols)if(h=p(n),h.addClass(a.levelTrigger),-1===o)h.button.id=a.collapseFromLevel("Cols",i),h.button.appendChild(document.createTextNode(i));else if(-1>o&&m===t.Grouping.getLevels().cols+1||0===m&&0===t.Grouping.getLevels().cols){var g=t.Dom.index(n)+1;h.button.id=a.collapseFromLevel("Rows",g),h.button.appendChild(document.createTextNode(g))}}var w=O(c,o,i,d,n);if(o>0){var v=u(o-1,i);w&&v.hidden&&t.Dom.addClass(w,a.clickable)}ne()}};if(e=d(e),n[c]>0)for(var v=0;v<i[c]+1;v++)Array.isArray(e)||(e="function"==typeof e?e():new Array(e)),e.unshift(w())},getGroupLevelsByRows:function(){for(var e=C(),t=[],o=0,n=e.length;n>o;o++)if(e[o].rows)for(var i=0,r=e[o].rows.length;r>i;i++)t[e[o].rows[i]]||(t[e[o].rows[i]]=[]),t[e[o].rows[i]].push(e[o].level);return t},getGroupLevelsByCols:function(){for(var e=w(),t=[],o=0,n=e.length;n>o;o++)if(e[o].cols)for(var i=0,r=e[o].cols.length;r>i;i++)t[e[o].cols[i]]||(t[e[o].cols[i]]=[]),t[e[o].cols[i]].push(e[o].level);return t},toggleGroupVisibility:function(o,n,r){if(t.Dom.hasClass(o.target,a.expandButton)||t.Dom.hasClass(o.target,a.collapseButton)||t.Dom.hasClass(o.target,a.levelTrigger)){var s,l,c,u,h=o.target,d=h.id.split("-"),f=[],m=function(e){e&&(h=e),d=h.id.split("-"),s=d[1],l=parseInt(h.getAttribute("data-level"),10),c=h.getAttribute("data-type"),u=parseInt(h.getAttribute("data-hidden")),u=isNaN(u)?1:u?0:1,h.setAttribute("data-hidden",u.toString()),f.push(p(s))};if(h.className.indexOf(a.levelTrigger)>-1){for(var g,w=[],C=[],b=h.id.indexOf("Rows")>-1?"rows":"cols",R=1,S=i[b];S>=R;R++)if(g="rows"==b?y(R):v(R),R>=parseInt(d[1],10))for(var E=0,D=g.length;D>E;E++)C.push(g[E]);else for(var E=0,D=g.length;D>E;E++)w.push(g[E]);T(!0,C),T(!1,w)}else m(),T(u,f);c=c||b;var k=H(c),A=c.charAt(0).toUpperCase()+c.slice(1),x=t.Grouping["baseSpare"+A];k?0==x&&(e.alter("insert_"+c.slice(0,-1),e["count"+A]()),t.Grouping["dummy"+c.slice(0,-1)]=!0):0==x&&t.Grouping["dummy"+c.slice(0,-1)]&&(e.alter("remove_"+c.slice(0,-1),e["count"+A]()-1),t.Grouping["dummy"+c.slice(0,-1)]=!1),e.render(),o.stopImmediatePropagation()}},modifySelectionFactory:function(e){var t,o=this.instance,n=new h(0,0),i=function(e,t){var o=0;switch(e){case"down":for(;P(t);)o++,t.row+=1;break;case"up":for(;P(t);)o--,t.row-=1;break;case"right":for(;P(t);)o++,t.col+=1;break;case"left":for(;P(t);)o--,t.col-=1}return o},r=function(e,t){e.row>0?P(t)&&(e.row+=i("down",t)):e.row<0&&P(t)&&(e.row+=i("up",t)),e.col>0?P(t)&&(e.col+=i("right",t)):e.col<0&&P(t)&&(e.col+=i("left",t))};switch(e){case"start":return function(e){t=o.getSelected(),n.row=t[0]+e.row,n.col=t[1]+e.col,r(e,n)};case"end":return function(e){t=o.getSelected(),n.row=t[2]+e.row,n.col=t[3]+e.col,r(e,n)}}},modifyRowHeight:function(t,o){return e.view.wt.wtTable.rowFilter&&P({row:o,col:null})?0:void 0},validateGroups:function(){for(var t=function(e,t){return e[0]<t[0]&&e[1]<t[1]&&t[0]<=e[1]||e[0]>t[0]&&t[1]<e[1]&&e[0]<=t[1]?!0:void 0},o=e.getSettings().groups,n=[],i=[],r=0,s=o.length;s>r;r++)if(o[r].rows){if(1===o[r].rows.length)throw new Error("Grouping error:  Group {"+o[r].rows[0]+"} is invalid. Cannot define single-entry groups.");if(0===o[r].rows.length)throw new Error("Grouping error:  Cannot define empty groups.");i.push(o[r].rows);for(var a=0,l=i.length;l>a;a++)if(t(o[r].rows,i[a]))throw new Error("Grouping error:  ranges {"+o[r].rows[0]+", "+o[r].rows[1]+"} and {"+i[a][0]+", "+i[a][1]+"} are overlapping.")}else if(o[r].cols){if(1===o[r].cols.length)throw new Error("Grouping error:  Group {"+o[r].cols[0]+"} is invalid. Cannot define single-entry groups.");if(0===o[r].cols.length)throw new Error("Grouping error:  Cannot define empty groups.");n.push(o[r].cols);for(var a=0,c=n.length;c>a;a++)if(t(o[r].cols,n[a]))throw new Error("Grouping error:  ranges {"+o[r].cols[0]+", "+o[r].cols[1]+"} and {"+n[a][0]+", "+n[a][1]+"} are overlapping.")}return!0},afterGetRowHeaderRenderers:function(e){t.Grouping.groupIndicatorsFactory(e,"vertical")},afterGetColumnHeaderRenderers:function(e){t.Grouping.groupIndicatorsFactory(e,"horizontal")},hookProxy:function(o,n){return function(){return e.getSettings().groups?n?t.Grouping[o](n).apply(this,arguments):t.Grouping[o].apply(this,arguments):void 0}}}},V=function(){var e=this,o=!!e.getSettings().groups;if(o){var n={};t.Grouping=new oe(e),e.getSettings().rowHeaders||(n.rowHeaders=!0),e.getSettings().colHeaders||(n.colHeaders=!0),(n.colHeaders||n.rowHeaders)&&e.updateSettings(n);var i=t.Grouping.validateGroups();if(!i)return;e.addHook("beforeInit",t.Grouping.hookProxy("init")),e.addHook("afterUpdateSettings",t.Grouping.hookProxy("updateGroups")),e.addHook("afterGetColumnHeaderRenderers",t.Grouping.hookProxy("afterGetColumnHeaderRenderers")),e.addHook("afterGetRowHeaderRenderers",t.Grouping.hookProxy("afterGetRowHeaderRenderers")),e.addHook("afterGetRowHeader",t.Grouping.hookProxy("afterGetRowHeader")),e.addHook("afterGetColHeader",t.Grouping.hookProxy("afterGetColHeader")),e.addHook("beforeOnCellMouseDown",t.Grouping.hookProxy("toggleGroupVisibility")),e.addHook("modifyTransformStart",t.Grouping.hookProxy("modifySelectionFactory","start")),e.addHook("modifyTransformEnd",t.Grouping.hookProxy("modifySelectionFactory","end")),e.addHook("modifyRowHeight",t.Grouping.hookProxy("modifyRowHeight"))}},ne=function(){for(var e=document.querySelectorAll("colgroup"),o=0,n=e.length;n>o;o++){var i=e[o].querySelectorAll("col.rowHeader");if(0===i.length)return;for(var r=0,s=i.length+1;s>r;r++){if(2==s)return;r<t.Grouping.getLevels().rows+1&&(r==t.Grouping.getLevels().rows?t.Dom.addClass(i[r],"htGroupColClosest"):t.Dom.addClass(i[r],"htGroupCol"))}}};t.hooks.add("beforeInit",V),t.hooks.add("afterUpdateSettings",function(){this.getSettings().groups&&!t.Grouping?V.call(this,arguments):!this.getSettings().groups&&t.Grouping&&(t.Grouping.resetGroups(),t.Grouping=void 0)}),t.plugins.Grouping=oe,function(e){function t(){this.zeroClipboardInstance=null,this.instance=null}t.prototype.prepareZeroClipboard=function(){this.swfPath&&ZeroClipboard.config({swfPath:this.swfPath})},t.prototype.copy=function(){return this.instance.copyPaste.setCopyableText(),this.instance.copyPaste.copyPasteInstance.elTextarea.value},t.prototype.addToContextMenu=function(t){this.getSettings().contextMenuCopyPaste&&t.items.unshift({key:"copy",name:"Copy"},{key:"paste",name:"Paste",callback:function(){this.copyPaste.triggerPaste()}},e.ContextMenu.SEPARATOR)},t.prototype.setupZeroClipboard=function(t){var n=this;if(this.cmInstance=t,e.Dom.hasClass(this.cmInstance.rootElement,"htContextMenu"))for(var i=t.getData(),r=0,s=i.length;s>r;r++)if("copy"===i[r].key){this.zeroClipboardInstance=new ZeroClipboard(t.getCell(r,0)),this.zeroClipboardInstance.off(),this.zeroClipboardInstance.on("copy",function(e){var t=e.clipboardData;t.setData("text/plain",n.copy()),n.instance.getSettings().outsideClickDeselects=n.outsideClickDeselectsCache}),o.bindEvents();break}},t.prototype.bindEvents=function(){var t=this;if(t.cmInstance){var o=new e.eventManager(this.instance),n=function(o){var n=t.cmInstance.rootElement.querySelector("td.current");n&&e.Dom.removeClass(n,"current"),t.outsideClickDeselectsCache=t.instance.getSettings().outsideClickDeselects,t.instance.getSettings().outsideClickDeselects=!1},i=function(o){var n=t.cmInstance.rootElement.querySelector("td.zeroclipboard-is-hover");n&&e.Dom.removeClass(n,"zeroclipboard-is-hover"),t.instance.getSettings().outsideClickDeselects=t.outsideClickDeselectsCache};o.removeEventListener(document,"mouseenter",function(){n()}),o.addEventListener(document,"mouseenter",function(e){n()}),o.removeEventListener(document,"mouseleave",function(){i()}),o.addEventListener(document,"mouseleave",function(e){i()})}},t.prototype.init=function(){if(this.getSettings().contextMenuCopyPaste){if("object"==typeof this.getSettings().contextMenuCopyPaste&&(o.swfPath=this.getSettings().contextMenuCopyPaste.swfPath),"undefined"==typeof ZeroClipboard)throw new Error("To be able to use the Copy/Paste feature from the context menu, you need to manualy include ZeroClipboard.js file to your website.");try{new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(e){if("undefined"==typeof navigator.mimeTypes["application/x-shockwave-flash"])throw new Error("To be able to use the Copy/Paste feature from the context menu, your browser needs to have Flash Plugin installed.")}o.instance=this,o.prepareZeroClipboard()}};var o=new t;e.hooks.add("afterRender",function(){o.setupZeroClipboard(this)}),e.hooks.add("afterInit",o.init),e.hooks.add("afterContextMenuDefaultOptions",o.addToContextMenu),e.ContextMenuCopyPaste=t}(t),function(e){function t(t){this.instance=t,this.dragged=[],this.eventManager=e.eventManager(t),this.bindTouchEvents()}t.prototype.getCurrentRangeCoords=function(e,t,o,n,i){var r=e.getTopLeftCorner(),s=e.getBottomRightCorner(),a=e.getBottomLeftCorner(),l=e.getTopRightCorner(),c={start:null,end:null};switch(o){case"NE-SW":switch(n){case"NE-SW":case"NW-SE":c="topLeft"==i?{start:new h(t.row,e.highlight.col),end:new h(a.row,t.col)}:{start:new h(e.highlight.row,t.col),end:new h(t.row,r.col)};break;case"SE-NW":"bottomRight"==i&&(c={start:new h(s.row,t.col),end:new h(t.row,r.col)})}break;case"NW-SE":switch(n){case"NE-SW":"topLeft"==i?c={start:t,end:a}:c.end=t;break;case"NW-SE":"topLeft"==i?c={start:t,end:s}:c.end=t;break;case"SE-NW":"topLeft"==i?c={start:t,end:r}:c.end=t;break;case"SW-NE":"topLeft"==i?c={start:t,end:l}:c.end=t}break;case"SW-NE":switch(n){case"NW-SE":c="bottomRight"==i?{start:new h(t.row,r.col),end:new h(a.row,t.col)}:{start:new h(r.row,t.col),end:new h(t.row,s.col)};break;case"SW-NE":c="topLeft"==i?{start:new h(e.highlight.row,t.col),end:new h(t.row,s.col)}:{start:new h(t.row,r.col),end:new h(r.row,t.col)};break;case"SE-NW":"bottomRight"==i?c={start:new h(t.row,l.col),end:new h(r.row,t.col)}:"topLeft"==i&&(c={start:a,end:t})}break;case"SE-NW":switch(n){case"NW-SE":case"NE-SW":case"SW-NE":"topLeft"==i&&(c.end=t);break;case"SE-NW":"topLeft"==i?c.end=t:c={start:t,end:r}}}return c},t.prototype.bindTouchEvents=function(){var t=this,o=function(e){if(1==this.dragged.length)return this.dragged=[],!0;var t=this.dragged.indexOf(e);return-1==t?!1:void(0===t?this.dragged=this.dragged.slice(0,1):1==t&&(this.dragged=this.dragged.slice(-1)))};this.eventManager.addEventListener(this.instance.rootElement,"touchstart",function(o){if(e.Dom.hasClass(o.target,"topLeftSelectionHandle-HitArea")){t.dragged.push("topLeft");var n=t.instance.getSelectedRange();return t.touchStartRange={width:n.getWidth(),height:n.getHeight(),direction:n.getDirection()},o.preventDefault(),!1}if(e.Dom.hasClass(o.target,"bottomRightSelectionHandle-HitArea")){t.dragged.push("bottomRight");var n=t.instance.getSelectedRange();return t.touchStartRange={width:n.getWidth(),height:n.getHeight(),direction:n.getDirection()},o.preventDefault(),!1}}),this.eventManager.addEventListener(this.instance.rootElement,"touchend",function(n){return e.Dom.hasClass(n.target,"topLeftSelectionHandle-HitArea")?(o.call(t,"topLeft"),t.touchStartRange=void 0,n.preventDefault(),!1):e.Dom.hasClass(n.target,"bottomRightSelectionHandle-HitArea")?(o.call(t,"bottomRight"),t.touchStartRange=void 0,n.preventDefault(),!1):void 0}),this.eventManager.addEventListener(this.instance.rootElement,"touchmove",function(o){var n=e.Dom.getWindowScrollTop(),i=e.Dom.getWindowScrollLeft();if(t.dragged.length>0){var r=document.elementFromPoint(o.touches[0].screenX-i,o.touches[0].screenY-n);if(!r)return;if("TD"==r.nodeName||"TH"==r.nodeName){var s=t.instance.getCoords(r);-1==s.col&&(s.col=0);var a=t.instance.getSelectedRange(),l=a.getWidth(),c=a.getHeight(),u=a.getDirection();1==l&&1==c&&t.instance.selection.setRangeEnd(s);var h=t.getCurrentRangeCoords(a,s,t.touchStartRange.direction,u,t.dragged[0]);null!=h.start&&t.instance.selection.setRangeStart(h.start),t.instance.selection.setRangeEnd(h.end)}o.preventDefault()}})},t.prototype.isDragged=function(){
return 0===this.dragged.length?!1:!0};var o=function(){var o=this;e.plugins.multipleSelectionHandles=new t(o)};e.hooks.add("afterInit",o)}(t);var ie=function(e){function o(e){}return o.prototype.init=function(e){this.instance=e,this.bindEvents(),this.scrollbars=[this.instance.view.wt.wtScrollbars.vertical,this.instance.view.wt.wtScrollbars.horizontal,this.instance.view.wt.wtScrollbars.corner],this.clones=[this.instance.view.wt.wtScrollbars.vertical.clone.wtTable.holder.parentNode,this.instance.view.wt.wtScrollbars.horizontal.clone.wtTable.holder.parentNode,this.instance.view.wt.wtScrollbars.corner.clone.wtTable.holder.parentNode]},o.prototype.bindEvents=function(){var e=this;this.instance.addHook("beforeTouchScroll",function(){t.freezeOverlays=!0;for(var o=0,n=e.clones.length;n>o;o++)t.Dom.addClass(e.clones[o],"hide-tween")}),this.instance.addHook("afterMomentumScroll",function(){t.freezeOverlays=!1;for(var o=0,n=e.clones.length;n>o;o++)t.Dom.removeClass(e.clones[o],"hide-tween");for(var o=0,n=e.clones.length;n>o;o++)t.Dom.addClass(e.clones[o],"show-tween");setTimeout(function(){for(var o=0,n=e.clones.length;n>o;o++)t.Dom.removeClass(e.clones[o],"show-tween")},400);for(var o=0,n=e.scrollbars.length;n>o;o++)e.scrollbars[o].refresh(),e.scrollbars[o].resetFixedPosition()})},o}(),re=new ie;if(t.hooks.add("afterInit",function(){re.init.call(re,this)}),function(e){function t(t){function o(o){o.items.push(e.ContextMenu.SEPARATOR,{key:"freeze_column",name:function(){var e=t.getSelected()[1];return e>p-1?"Freeze this column":"Unfreeze this column"},disabled:function(){var e=t.getSelected();return e[1]!==e[3]},callback:function(){var e=t.getSelected()[1];e>p-1?c(e):u(e)}})}function n(){t.updateSettings({fixedColumnsLeft:p+1}),p++}function i(){t.updateSettings({fixedColumnsLeft:p-1}),p--}function r(e){t.manualColumnPositions&&0!==t.manualColumnPositions.length||t.manualColumnPositions||(t.manualColumnPositions=[]),e?t.manualColumnPositions[e]||s(e+1):s(t.countCols())}function s(e){if(t.manualColumnPositions.length<e)for(var o=t.manualColumnPositions.length;e>o;o++)t.manualColumnPositions[o]=o}function a(e,o,n,i){null==n&&(n=e),"freeze"===i?t.manualColumnPositions.splice(p,0,t.manualColumnPositions.splice(o,1)[0]):"unfreeze"===i&&t.manualColumnPositions.splice(n,0,t.manualColumnPositions.splice(o,1)[0])}function l(e){for(var t=p,o=h(t),n=h(e);n>o;)t++,o=h(t);return t-1}function c(e){if(!(p-1>=e)){var t=h(e)||e;r(t),a(t,e,null,"freeze"),n()}}function u(e){if(!(e>p-1)){var t=l(e),o=h(e)||e;r(o),a(o,e,t,"unfreeze"),i()}}function h(e){return t.manualColumnPositions[e]}function d(e){return this.manualColumnPositionsPluginUsages.length>1?e:h(e)}function f(){t.addHook("modifyCol",d),t.addHook("afterContextMenuDefaultOptions",o)}var p=t.getSettings().fixedColumnsLeft,m=function(){"undefined"!=typeof t.manualColumnPositionsPluginUsages?t.manualColumnPositionsPluginUsages.push("manualColumnFreeze"):t.manualColumnPositionsPluginUsages=["manualColumnFreeze"],f()};return{init:m,freezeColumn:c,unfreezeColumn:u,helpers:{addFixedColumn:n,removeFixedColumn:i,checkPositionData:r,modifyColumnOrder:a,getBestColumnReturnPosition:l}}}var o=function(){if(this.getSettings().manualColumnFreeze){var o;e.plugins.manualColumnFreeze=t,this.manualColumnFreeze=new t(this),o=this.manualColumnFreeze,o.init.call(this)}};e.hooks.add("beforeInit",o)}(t),c.prototype.init=function(){this.TABLE=this.instance.wtTable.TABLE,this.fixed=this.instance.wtTable.hider,this.fixedContainer=this.instance.wtTable.holder,this.scrollHandler=this.getScrollableElement(this.TABLE)},c.prototype.makeClone=function(e){var t=document.createElement("DIV");t.className="ht_clone_"+e+" handsontable",t.style.position="absolute",t.style.top=0,t.style.left=0,t.style.overflow="hidden";var o=document.createElement("TABLE");return o.className=this.instance.wtTable.TABLE.className,t.appendChild(o),this.instance.wtTable.holder.parentNode.appendChild(t),new m({cloneSource:this.instance,cloneOverlay:this,table:o})},c.prototype.getScrollableElement=function(t){for(var o=t.parentNode;o&&o.style&&document.body!==o;){if("visible"!==o.style.overflow&&""!==o.style.overflow)return o;if(e.getComputedStyle){var n=e.getComputedStyle(o);if("visible"!==n.getPropertyValue("overflow")&&""!==n.getPropertyValue("overflow"))return o}if(this instanceof R&&"visible"!==o.style.overflowX&&""!==o.style.overflowX)return o;o=o.parentNode}return e},c.prototype.refresh=function(e){this.clone&&this.clone.draw(e)},c.prototype.destroy=function(){var e=t.eventManager(this.clone);e.clear()},u.prototype.appear=function(e){var o,n,i,r,s,a,l,c,u,d,f,p;if(!this.disabled){var m,g,w,v,C,y,R,E=this.instance,T=function(){return!this.instance.selections.area.cellRange||w==this.instance.selections.area.cellRange.to.row&&v==this.instance.selections.area.cellRange.to.col?!1:!0},D=function(e,t,o,n){var i=parseInt(this.selectionHandles.styles.topLeft.width,10),r=parseInt(this.selectionHandles.styles.topLeftHitArea.width,10);this.selectionHandles.styles.topLeft.top=parseInt(e-i,10)+"px",this.selectionHandles.styles.topLeft.left=parseInt(t-i,10)+"px",this.selectionHandles.styles.topLeftHitArea.top=parseInt(e-r/4*3,10)+"px",this.selectionHandles.styles.topLeftHitArea.left=parseInt(t-r/4*3,10)+"px",this.selectionHandles.styles.bottomRight.top=parseInt(e+n,10)+"px",this.selectionHandles.styles.bottomRight.left=parseInt(t+o,10)+"px",this.selectionHandles.styles.bottomRightHitArea.top=parseInt(e+n-r/4,10)+"px",this.selectionHandles.styles.bottomRightHitArea.left=parseInt(t+o-r/4,10)+"px",this.settings.border.multipleSelectionHandlesVisible&&this.settings.border.multipleSelectionHandlesVisible()?(this.selectionHandles.styles.topLeft.display="block",this.selectionHandles.styles.topLeftHitArea.display="block",T.call(this)?(this.selectionHandles.styles.bottomRight.display="none",this.selectionHandles.styles.bottomRightHitArea.display="none"):(this.selectionHandles.styles.bottomRight.display="block",this.selectionHandles.styles.bottomRightHitArea.display="block")):(this.selectionHandles.styles.topLeft.display="none",this.selectionHandles.styles.bottomRight.display="none",this.selectionHandles.styles.topLeftHitArea.display="none",this.selectionHandles.styles.bottomRightHitArea.display="none"),m==this.instance.wtSettings.getSetting("fixedRowsTop")||g==this.instance.wtSettings.getSetting("fixedColumnsLeft")?(this.selectionHandles.styles.topLeft.zIndex="9999",this.selectionHandles.styles.topLeftHitArea.zIndex="9999"):(this.selectionHandles.styles.topLeft.zIndex="",this.selectionHandles.styles.topLeftHitArea.zIndex="")};for(y=E.cloneOverlay instanceof S||E.cloneOverlay instanceof b?E.getSetting("fixedRowsTop"):E.wtTable.getRenderedRowsCount(),C=0;y>C;C++)if(R=E.wtTable.rowFilter.renderedToSource(C),R>=e[0]&&R<=e[2]){m=R;break}for(C=y-1;C>=0;C--)if(R=E.wtTable.rowFilter.renderedToSource(C),R>=e[0]&&R<=e[2]){w=R;break}for(y=E.wtTable.getRenderedColumnsCount(),C=0;y>C;C++)if(R=E.wtTable.columnFilter.renderedToSource(C),R>=e[1]&&R<=e[3]){g=R;break}for(C=y-1;C>=0;C--)if(R=E.wtTable.columnFilter.renderedToSource(C),R>=e[1]&&R<=e[3]){v=R;break}if(void 0===m||void 0===g)return void this.disappear();o=m!==w||g!==v,n=E.wtTable.getCell(new h(m,g)),i=o?E.wtTable.getCell(new h(w,v)):n,r=t.Dom.offset(n),s=o?t.Dom.offset(i):r,a=t.Dom.offset(E.wtTable.TABLE),c=r.top,f=s.top+t.Dom.outerHeight(i)-c,d=r.left,p=s.left+t.Dom.outerWidth(i)-d,l=c-a.top-1,u=d-a.left-1;var k=t.Dom.getComputedStyle(n);parseInt(k.borderTopWidth,10)>0&&(l+=1,f=f>0?f-1:0),parseInt(k.borderLeftWidth,10)>0&&(u+=1,p=p>0?p-1:0),this.topStyle.top=l+"px",this.topStyle.left=u+"px",this.topStyle.width=p+"px",this.topStyle.display="block",this.leftStyle.top=l+"px",this.leftStyle.left=u+"px",this.leftStyle.height=f+"px",this.leftStyle.display="block";var A=Math.floor(this.settings.border.width/2);if(this.bottomStyle.top=l+f-A+"px",this.bottomStyle.left=u+"px",this.bottomStyle.width=p+"px",this.bottomStyle.display="block",this.rightStyle.top=l+"px",this.rightStyle.left=u+p-A+"px",this.rightStyle.height=f+1+"px",this.rightStyle.display="block",t.mobileBrowser||!this.hasSetting(this.settings.border.cornerVisible)||T.call(this))this.cornerStyle.display="none";else if(this.cornerStyle.top=l+f-4+"px",this.cornerStyle.left=u+p-4+"px",this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="block",v===this.instance.getSetting("totalColumns")-1){var H=t.Dom.getScrollableElement(E.wtTable.TABLE),x=i.offsetLeft+t.Dom.outerWidth(i)>=t.Dom.innerWidth(H);x&&(this.cornerStyle.left=Math.floor(u+p-3-parseInt(this.cornerDefaultStyle.width)/2)+"px",this.cornerStyle.borderRightWidth=0)}t.mobileBrowser&&D.call(this,l,u,p,f)}},u.prototype.disappear=function(){this.topStyle.display="none",this.leftStyle.display="none",this.bottomStyle.display="none",this.rightStyle.display="none",this.cornerStyle.display="none",t.mobileBrowser&&(this.selectionHandles.styles.topLeft.display="none",this.selectionHandles.styles.bottomRight.display="none")},u.prototype.hasSetting=function(e){return"function"==typeof e?e():!!e},h.prototype.isValid=function(e){return this.row<0||this.col<0?!1:this.row>=e.getSetting("totalRows")||this.col>=e.getSetting("totalColumns")?!1:!0},h.prototype.isEqual=function(e){return e===this?!0:this.row===e.row&&this.col===e.col},h.prototype.isSouthEastOf=function(e){return this.row>=e.row&&this.col>=e.col},h.prototype.isNorthWestOf=function(e){return this.row<=e.row&&this.col<=e.col},h.prototype.isSouthWestOf=function(e){return this.row>=e.row&&this.col<=e.col},h.prototype.isNorthEastOf=function(e){return this.row<=e.row&&this.col>=e.col},e.WalkontableCellCoords=h,d.prototype.isValid=function(e){return this.from.isValid(e)&&this.to.isValid(e)},d.prototype.isSingle=function(){return this.from.row===this.to.row&&this.from.col===this.to.col},d.prototype.getHeight=function(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1},d.prototype.getWidth=function(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1},d.prototype.includes=function(e){var t=this.getTopLeftCorner(),o=this.getBottomRightCorner();return e.row<0&&(e.row=0),e.col<0&&(e.col=0),t.row<=e.row&&o.row>=e.row&&t.col<=e.col&&o.col>=e.col},d.prototype.includesRange=function(e){return this.includes(e.getTopLeftCorner())&&this.includes(e.getBottomRightCorner())},d.prototype.isEqual=function(e){return Math.min(this.from.row,this.to.row)==Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)==Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)==Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)==Math.max(e.from.col,e.to.col)},d.prototype.overlaps=function(e){return e.isSouthEastOf(this.getTopLeftCorner())&&e.isNorthWestOf(this.getBottomRightCorner())},d.prototype.isSouthEastOf=function(e){return this.getTopLeftCorner().isSouthEastOf(e)||this.getBottomRightCorner().isSouthEastOf(e)},d.prototype.isNorthWestOf=function(e){return this.getTopLeftCorner().isNorthWestOf(e)||this.getBottomRightCorner().isNorthWestOf(e)},d.prototype.expand=function(e){var t=this.getTopLeftCorner(),o=this.getBottomRightCorner();return e.row<t.row||e.col<t.col||e.row>o.row||e.col>o.col?(this.from=new h(Math.min(t.row,e.row),Math.min(t.col,e.col)),this.to=new h(Math.max(o.row,e.row),Math.max(o.col,e.col)),!0):!1},d.prototype.expandByRange=function(e){if(this.includesRange(e)||!this.overlaps(e))return!1;var t=this.getTopLeftCorner(),o=this.getBottomRightCorner(),n=(this.getTopRightCorner(),this.getBottomLeftCorner(),e.getTopLeftCorner()),i=e.getBottomRightCorner(),r=Math.min(t.row,n.row),s=Math.min(t.col,n.col),a=Math.max(o.row,i.row),l=Math.max(o.col,i.col),c=new h(r,s),u=new h(a,l),f=new d(c,c,u).isCorner(this.from,e),p=e.isEqual(new d(c,c,u));return f&&!p&&(this.from.col>c.col&&(c.col=l,u.col=s),this.from.row>c.row&&(c.row=a,u.row=r)),this.from=c,this.to=u,!0},d.prototype.getDirection=function(){return this.from.isNorthWestOf(this.to)?"NW-SE":this.from.isNorthEastOf(this.to)?"NE-SW":this.from.isSouthEastOf(this.to)?"SE-NW":this.from.isSouthWestOf(this.to)?"SW-NE":void 0},d.prototype.setDirection=function(e){switch(e){case"NW-SE":this.from=this.getTopLeftCorner(),this.to=this.getBottomRightCorner();break;case"NE-SW":this.from=this.getTopRightCorner(),this.to=this.getBottomLeftCorner();break;case"SE-NW":this.from=this.getBottomRightCorner(),this.to=this.getTopLeftCorner();break;case"SW-NE":this.from=this.getBottomLeftCorner(),this.to=this.getTopRightCorner()}},d.prototype.getTopLeftCorner=function(){return new h(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))},d.prototype.getBottomRightCorner=function(){return new h(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))},d.prototype.getTopRightCorner=function(){return new h(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))},d.prototype.getBottomLeftCorner=function(){return new h(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))},d.prototype.isCorner=function(e,t){return t&&t.includes(e)&&(this.getTopLeftCorner().isEqual(new h(t.from.row,t.from.col))||this.getTopRightCorner().isEqual(new h(t.from.row,t.to.col))||this.getBottomLeftCorner().isEqual(new h(t.to.row,t.from.col))||this.getBottomRightCorner().isEqual(new h(t.to.row,t.to.col)))?!0:e.isEqual(this.getTopLeftCorner())||e.isEqual(this.getTopRightCorner())||e.isEqual(this.getBottomLeftCorner())||e.isEqual(this.getBottomRightCorner())},d.prototype.getOppositeCorner=function(e,t){if(!(e instanceof h))return!1;if(t&&t.includes(e)){if(this.getTopLeftCorner().isEqual(new h(t.from.row,t.from.col)))return this.getBottomRightCorner();if(this.getTopRightCorner().isEqual(new h(t.from.row,t.to.col)))return this.getBottomLeftCorner();if(this.getBottomLeftCorner().isEqual(new h(t.to.row,t.from.col)))return this.getTopRightCorner();if(this.getBottomRightCorner().isEqual(new h(t.to.row,t.to.col)))return this.getTopLeftCorner()}return e.isEqual(this.getBottomRightCorner())?this.getTopLeftCorner():e.isEqual(this.getTopLeftCorner())?this.getBottomRightCorner():e.isEqual(this.getTopRightCorner())?this.getBottomLeftCorner():e.isEqual(this.getBottomLeftCorner())?this.getTopRightCorner():void 0},d.prototype.getBordersSharedWith=function(e){if(!this.includesRange(e))return[];var t={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},o={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},n=[];return t.top==o.top&&n.push("top"),t.right==o.right&&n.push("right"),t.bottom==o.bottom&&n.push("bottom"),t.left==o.left&&n.push("left"),n},d.prototype.getInner=function(){for(var e=this.getTopLeftCorner(),t=this.getBottomRightCorner(),o=[],n=e.row;n<=t.row;n++)for(var i=e.col;i<=t.col;i++)this.from.row===n&&this.from.col===i||this.to.row===n&&this.to.col===i||o.push(new h(n,i));return o},d.prototype.getAll=function(){for(var e=this.getTopLeftCorner(),t=this.getBottomRightCorner(),o=[],n=e.row;n<=t.row;n++)for(var i=e.col;i<=t.col;i++)e.row===n&&e.col===i?o.push(e):t.row===n&&t.col===i?o.push(t):o.push(new h(n,i));return o},d.prototype.forAll=function(e){for(var t=this.getTopLeftCorner(),o=this.getBottomRightCorner(),n=t.row;n<=o.row;n++)for(var i=t.col;i<=o.col;i++){var r=e(n,i);if(r===!1)return}},e.WalkontableCellRange=d,f.prototype.offsetted=function(e){return e+this.offset},f.prototype.unOffsetted=function(e){return e-this.offset},f.prototype.renderedToSource=function(e){return this.offsetted(e)},f.prototype.sourceToRendered=function(e){return this.unOffsetted(e)},f.prototype.offsettedTH=function(e){return e-this.countTH},f.prototype.unOffsettedTH=function(e){return e+this.countTH},f.prototype.visibleRowHeadedColumnToSourceColumn=function(e){return this.renderedToSource(this.offsettedTH(e))},f.prototype.sourceColumnToVisibleRowHeadedColumn=function(e){return this.unOffsettedTH(this.sourceToRendered(e))},p.prototype.getContainerSize=function(){return"function"==typeof this.containerSizeFn?this.containerSizeFn():this.containerSizeFn},p.prototype.getSize=function(e){return this.cellSizes[e]+(this.cellStretch[e]||0)},p.prototype.stretch=function(){var e=this.getContainerSize(),t=0;if(this.remainingSize=this.cellSizesSum-e,this.cellStretch.length=0,"all"===this.strategy){if(this.remainingSize<0){for(var o,n=e/this.cellSizesSum;t<this.cellCount-1;)o=Math.floor(n*this.cellSizes[t]),this.remainingSize+=o-this.cellSizes[t],this.cellStretch[t]=o-this.cellSizes[t],t++;this.cellStretch[this.cellCount-1]=-this.remainingSize,this.remainingSize=0}}else"last"===this.strategy&&this.remainingSize<0&&e!==1/0&&(this.cellStretch[this.cellCount-1]=-this.remainingSize,this.remainingSize=0)},p.prototype.countVisible=function(){return this.visibleCellCount},p.prototype.isLastIncomplete=function(){var e=this.instance.wtTable.getFirstVisibleRow(),o=this.instance.wtTable.getLastVisibleColumn(),n=this.instance.wtTable.getCell(new h(e,o)),i=t.Dom.offset(n),r=t.Dom.outerWidth(n),s=i.left+r,a=this.instance.wtScrollbars.vertical.getScrollPosition(),l=this.instance.wtViewport.getViewportWidth(),c=a+l;return c>=s},m.prototype.draw=function(e){return this.drawInterrupted=!1,e||t.Dom.isVisible(this.wtTable.TABLE)?(this.wtTable.draw(e),this):void(this.drawInterrupted=!0)},m.prototype.getCell=function(e,t){if(t){var o=this.wtSettings.getSetting("fixedRowsTop"),n=this.wtSettings.getSetting("fixedColumnsLeft");return e.row<o&&e.col<n?this.wtScrollbars.corner.clone.wtTable.getCell(e):e.row<o?this.wtScrollbars.vertical.clone.wtTable.getCell(e):e.col<n?this.wtScrollbars.horizontal.clone.wtTable.getCell(e):this.wtTable.getCell(e)}return this.wtTable.getCell(e)},m.prototype.update=function(e,t){return this.wtSettings.update(e,t)},m.prototype.scrollVertical=function(e){return this.wtScrollbars.vertical.scrollTo(e),this.getSetting("onScrollVertically"),this},m.prototype.scrollHorizontal=function(e){return this.wtScrollbars.horizontal.scrollTo(e),this.getSetting("onScrollHorizontally"),this},m.prototype.scrollViewport=function(e){return this.wtScroll.scrollViewport(e),this},m.prototype.getViewport=function(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]},m.prototype.getSetting=function(e,t,o,n,i){return this.wtSettings.getSetting(e,t,o,n,i)},m.prototype.hasSetting=function(e){return this.wtSettings.has(e)},m.prototype.destroy=function(){this.wtScrollbars.destroy(),this.wtEvent&&this.wtEvent.destroy()},g.prototype=new c,g.prototype.destroy=function(){c.prototype.destroy.call(this),clearTimeout(this.lastTimeout)},w.prototype.parentCell=function(e){var o={},n=this.instance.wtTable.TABLE,i=t.Dom.closest(e,["TD","TH"],n);return i&&t.Dom.isChildOf(i,n)?(o.coords=this.instance.wtTable.getCoords(i),o.TD=i):t.Dom.hasClass(e,"wtBorder")&&t.Dom.hasClass(e,"current")?(o.coords=this.instance.selections.current.cellRange.highlight,o.TD=this.instance.wtTable.getCell(o.coords)):t.Dom.hasClass(e,"wtBorder")&&t.Dom.hasClass(e,"area")&&this.instance.selections.area.cellRange&&(o.coords=this.instance.selections.area.cellRange.to,o.TD=this.instance.wtTable.getCell(o.coords)),o},e.requestAnimFrame=function(){return e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame||function(t,o){return e.setTimeout(t,1e3/60)}}(),e.cancelRequestAnimFrame=function(){return e.cancelAnimationFrame||e.webkitCancelRequestAnimationFrame||e.mozCancelRequestAnimationFrame||e.oCancelRequestAnimationFrame||e.msCancelRequestAnimationFrame||clearTimeout}(),e.getComputedStyle||!function(){var t,o={getPropertyValue:function(e){return"float"==e&&(e="styleFloat"),t.currentStyle[e.toUpperCase()]||null}};e.getComputedStyle=function(e){return t=e,o}}(),!String.prototype.trim){var se=/^\s+|\s+$/g;String.prototype.trim=function(){return this.replace(se,"")}}C.prototype.offsetted=function(e){return e+this.offset},C.prototype.unOffsetted=function(e){return e-this.offset},C.prototype.renderedToSource=function(e){return this.offsetted(e)},C.prototype.sourceToRendered=function(e){return this.unOffsetted(e)},C.prototype.offsettedTH=function(e){return e-this.countTH},C.prototype.visibleColHeadedRowToSourceRow=function(e){return this.renderedToSource(this.offsettedTH(e))},C.prototype.sourceRowToVisibleColHeadedRow=function(e){return this.unOffsettedTH(this.sourceToRendered(e))},y.prototype.scrollViewport=function(e){if(this.instance.drawn){var t=this.instance.getSetting("totalRows"),o=this.instance.getSetting("totalColumns");if(e.row<0||e.row>t-1)throw new Error("row "+e.row+" does not exist");if(e.col<0||e.col>o-1)throw new Error("column "+e.col+" does not exist");e.row>this.instance.wtTable.getLastVisibleRow()?this.instance.wtScrollbars.vertical.scrollTo(e.row,!0):e.row>=this.instance.getSetting("fixedRowsTop")&&e.row<this.instance.wtTable.getFirstVisibleRow()&&this.instance.wtScrollbars.vertical.scrollTo(e.row),e.col>this.instance.wtTable.getLastVisibleColumn()?this.instance.wtScrollbars.horizontal.scrollTo(e.col,!0):e.col>=this.instance.getSetting("fixedColumnsLeft")&&e.col<this.instance.wtTable.getFirstVisibleColumn()&&this.instance.wtScrollbars.horizontal.scrollTo(e.col)}},b.prototype=new c,b.prototype.resetFixedPosition=function(){if(this.instance.wtTable.holder.parentNode){var o,n,i=this.clone.wtTable.holder.parentNode;if(this.scrollHandler===e){var r=this.instance.wtTable.holder.getBoundingClientRect(),s=Math.ceil(r.top),a=Math.ceil(r.left),l=Math.ceil(r.bottom),c=Math.ceil(r.right);o=0>a&&c-i.offsetWidth>0?-a+"px":"0",n=0>s&&l-i.offsetHeight>0?-s+"px":"0"}else t.freezeOverlays||(o=this.instance.wtScrollbars.horizontal.getScrollPosition()+"px",n=this.instance.wtScrollbars.vertical.getScrollPosition()+"px");t.Dom.setOverlayPosition(i,o,n),i.style.width=t.Dom.outerWidth(this.clone.wtTable.TABLE)+4+"px",i.style.height=t.Dom.outerHeight(this.clone.wtTable.TABLE)+4+"px"}},R.prototype=new c,R.prototype.resetFixedPosition=function(){var o,n;if(this.instance.wtTable.holder.parentNode){var i=this.clone.wtTable.holder.parentNode;if(this.scrollHandler===e){var r=this.instance.wtTable.holder.getBoundingClientRect(),s=Math.ceil(r.left),a=Math.ceil(r.right);o=0>s&&a-i.offsetWidth>0?-s+"px":"0",n=this.instance.wtTable.hider.style.top}else t.freezeOverlays||(o=this.getScrollPosition()+"px",n=this.instance.wtTable.hider.style.top);t.Dom.setOverlayPosition(i,o,n),i.style.height=t.Dom.outerHeight(this.clone.wtTable.TABLE)+"px",i.style.width=t.Dom.outerWidth(this.clone.wtTable.TABLE)+4+"px"}},R.prototype.refresh=function(e){this.applyToDOM(),c.prototype.refresh.call(this,e)},R.prototype.getScrollPosition=function(){return t.Dom.getScrollLeft(this.scrollHandler)},R.prototype.setScrollPosition=function(o){this.scrollHandler===e?e.scrollTo(o,t.Dom.getWindowScrollTop()):this.scrollHandler.scrollLeft=o},R.prototype.onScroll=function(){this.instance.getSetting("onScrollHorizontally")},R.prototype.sumCellSizes=function(e,t){for(var o=0;t>e;)o+=this.instance.wtTable.getStretchedColumnWidth(e)||this.instance.wtSettings.defaultColumnWidth,e++;return o},R.prototype.applyToDOM=function(){var e=this.instance.getSetting("totalColumns"),t=this.instance.wtViewport.getRowHeaderWidth();if(this.fixedContainer.style.width=t+this.sumCellSizes(0,e)+"px","number"==typeof this.instance.wtViewport.columnsRenderCalculator.startPosition)this.fixed.style.left=this.instance.wtViewport.columnsRenderCalculator.startPosition+"px";else{if(0!==e)throw new Error("Incorrect value of the columnsRenderCalculator");this.fixed.style.left="0"}this.fixed.style.right=""},R.prototype.scrollTo=function(e,t){var o=this.getTableParentOffset();if(t)o+=this.sumCellSizes(0,e+1),o-=this.instance.wtViewport.getViewportWidth();else{var n=this.instance.getSetting("fixedColumnsLeft");o+=this.sumCellSizes(n,e)}this.setScrollPosition(o)},R.prototype.getTableParentOffset=function(){return this.scrollHandler===e?this.instance.wtTable.holderOffset.left:0},S.prototype=new c,S.prototype.resetFixedPosition=function(){var o,n;if(this.instance.wtTable.holder.parentNode){var i=this.clone.wtTable.holder.parentNode;if(this.scrollHandler===e){var r=this.instance.wtTable.holder.getBoundingClientRect(),s=Math.ceil(r.top),a=Math.ceil(r.bottom);o=this.instance.wtTable.hider.style.left,n=0>s&&a-i.offsetHeight>0?-s+"px":"0"}else t.freezeOverlays||(n=this.getScrollPosition()+"px",o=this.instance.wtTable.hider.style.left);t.Dom.setOverlayPosition(i,o,n),this.instance.wtScrollbars.horizontal.scrollHandler===e?i.style.width=this.instance.wtViewport.getWorkspaceActualWidth()+"px":i.style.width=t.Dom.outerWidth(this.clone.wtTable.TABLE)+"px",i.style.height=t.Dom.outerHeight(this.clone.wtTable.TABLE)+4+"px"}},S.prototype.getScrollPosition=function(){return t.Dom.getScrollTop(this.scrollHandler)},S.prototype.setScrollPosition=function(o){this.scrollHandler===e?e.scrollTo(t.Dom.getWindowScrollLeft(),o):this.scrollHandler.scrollTop=o},S.prototype.onScroll=function(){this.instance.getSetting("onScrollVertically")},S.prototype.sumCellSizes=function(e,t){for(var o=0;t>e;)o+=this.instance.wtTable.getRowHeight(e)||this.instance.wtSettings.settings.defaultRowHeight,e++;return o},S.prototype.refresh=function(e){this.applyToDOM(),c.prototype.refresh.call(this,e)},S.prototype.applyToDOM=function(){var e=this.instance.getSetting("totalRows"),t=this.instance.wtViewport.getColumnHeaderHeight();if(this.fixedContainer.style.height=t+this.sumCellSizes(0,e)+"px","number"==typeof this.instance.wtViewport.rowsRenderCalculator.startPosition)this.fixed.style.top=this.instance.wtViewport.rowsRenderCalculator.startPosition+"px";else{if(0!==e)throw new Error("Incorrect value of the rowsRenderCalculator");this.fixed.style.top="0"}this.fixed.style.bottom=""},S.prototype.scrollTo=function(e,t){var o=this.getTableParentOffset();if(t)o+=this.sumCellSizes(0,e+1),o-=this.instance.wtViewport.getViewportHeight(),o+=1;else{var n=this.instance.getSetting("fixedRowsTop");o+=this.sumCellSizes(n,e)}this.setScrollPosition(o)},S.prototype.getTableParentOffset=function(){return this.scrollHandler===e?this.instance.wtTable.holderOffset.top:0},E.prototype.registerListeners=function(){var o=this;this.refreshAll=function(){if(o.instance.drawn){if(!o.instance.wtTable.holder.parentNode)return void o.destroy();o.instance.draw(!0),o.vertical.onScroll(),o.horizontal.onScroll()}};var n=t.eventManager(o.instance);n.addEventListener(this.vertical.scrollHandler,"scroll",this.refreshAll),this.vertical.scrollHandler!==this.horizontal.scrollHandler&&n.addEventListener(this.horizontal.scrollHandler,"scroll",this.refreshAll),this.vertical.scrollHandler!==e&&this.horizontal.scrollHandler!==e&&n.addEventListener(e,"scroll",this.refreshAll)},E.prototype.destroy=function(){var o=t.eventManager(this.instance);this.vertical&&(this.vertical.destroy(),o.removeEventListener(this.vertical.scrollHandler,"scroll",this.refreshAll)),this.horizontal&&(this.horizontal.destroy(),o.removeEventListener(this.horizontal.scrollHandler,"scroll",this.refreshAll)),o.removeEventListener(e,"scroll",this.refreshAll),this.corner&&this.corner.destroy(),this.debug&&this.debug.destroy()},E.prototype.refresh=function(e){this.horizontal&&this.horizontal.refresh(e),this.vertical&&this.vertical.refresh(e),this.corner&&this.corner.refresh(e),this.debug&&this.debug.refresh(e)},E.prototype.applyToDOM=function(){this.horizontal&&this.horizontal.applyToDOM(),this.vertical&&this.vertical.applyToDOM()},T.prototype.getBorder=function(e){return this.instanceBorders[e.guid]?this.instanceBorders[e.guid]:void(this.instanceBorders[e.guid]=new u(e,this.settings))},T.prototype.isEmpty=function(){return null===this.cellRange},T.prototype.add=function(e){this.isEmpty()?this.cellRange=new d(e,e,e):this.cellRange.expand(e)},T.prototype.replace=function(e,t){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=t,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=t,!0}return!1},T.prototype.clear=function(){this.cellRange=null},T.prototype.getCorners=function(){var e=this.cellRange.getTopLeftCorner(),t=this.cellRange.getBottomRightCorner();return[e.row,e.col,t.row,t.col]},T.prototype.addClassAtCoords=function(e,o,n,i){var r=e.wtTable.getCell(new h(o,n));"object"==typeof r&&t.Dom.addClass(r,i)},T.prototype.draw=function(e){var o,n,i,r,s,a=this,l=e.wtTable.getRenderedRowsCount(),c=e.wtTable.getRenderedColumnsCount();if(this.isEmpty())return void(this.settings.border&&(r=this.getBorder(e),r&&r.disappear()));o=this.getCorners();for(var u=0;c>u;u++)i=e.wtTable.columnFilter.renderedToSource(u),i>=o[1]&&i<=o[3]&&(s=e.wtTable.getColumnHeader(i),s&&a.settings.highlightColumnClassName&&t.Dom.addClass(s,a.settings.highlightColumnClassName));for(var h=0;l>h;h++){n=e.wtTable.rowFilter.renderedToSource(h),n>=o[0]&&n<=o[2]&&(s=e.wtTable.getRowHeader(n),s&&a.settings.highlightRowClassName&&t.Dom.addClass(s,a.settings.highlightRowClassName));for(var u=0;c>u;u++)i=e.wtTable.columnFilter.renderedToSource(u),n>=o[0]&&n<=o[2]&&i>=o[1]&&i<=o[3]?a.settings.className&&a.addClassAtCoords(e,n,i,a.settings.className):n>=o[0]&&n<=o[2]?a.settings.highlightRowClassName&&a.addClassAtCoords(e,n,i,a.settings.highlightRowClassName):i>=o[1]&&i<=o[3]&&a.settings.highlightColumnClassName&&a.addClassAtCoords(e,n,i,a.settings.highlightColumnClassName)}e.getSetting("onBeforeDrawBorders",o,this.settings.className),this.settings.border&&(r=this.getBorder(e),r&&r.appear(o))},D.prototype.update=function(e,t){if(void 0===t)for(var o in e)e.hasOwnProperty(o)&&(this.settings[o]=e[o]);else this.settings[e]=t;return this.instance},D.prototype.getSetting=function(e,t,o,n,i){return"function"==typeof this.settings[e]?this.settings[e](t,o,n,i):void 0!==t&&Array.isArray(this.settings[e])?this.settings[e][t]:this.settings[e]},D.prototype.has=function(e){return!!this.settings[e]},k.prototype.isWorkingOnClone=function(){return!!this.instance.cloneSource},k.prototype.draw=function(e){if(this.isWorkingOnClone()||(this.holderOffset=t.Dom.offset(this.holder),e=this.instance.wtViewport.createRenderCalculators(e)),e)this.isWorkingOnClone()||this.instance.wtViewport.createVisibleCalculators(),this.instance.wtScrollbars&&this.instance.wtScrollbars.refresh(!0);else{this.isWorkingOnClone()?this.tableOffset=this.instance.cloneSource.wtTable.tableOffset:this.tableOffset=t.Dom.offset(this.TABLE);var o;o=this.instance.cloneOverlay instanceof g||this.instance.cloneOverlay instanceof S||this.instance.cloneOverlay instanceof b?0:this.instance.wtViewport.rowsRenderCalculator.startRow;var n;n=this.instance.cloneOverlay instanceof g||this.instance.cloneOverlay instanceof R||this.instance.cloneOverlay instanceof b?0:this.instance.wtViewport.columnsRenderCalculator.startColumn,this.rowFilter=new C(o,this.instance.getSetting("totalRows"),this.instance.getSetting("columnHeaders").length),this.columnFilter=new f(n,this.instance.getSetting("totalColumns"),this.instance.getSetting("rowHeaders").length),this._doDraw()}return this.refreshSelections(e),this.isWorkingOnClone()||(this.instance.wtScrollbars.vertical.resetFixedPosition(),this.instance.wtScrollbars.horizontal.resetFixedPosition(),this.instance.wtScrollbars.corner.resetFixedPosition()),this.instance.drawn=!0,this},k.prototype._doDraw=function(){var e=new A(this);e.render()},k.prototype.removeClassFromCells=function(e){for(var o=this.TABLE.querySelectorAll("."+e),n=0,i=o.length;i>n;n++)t.Dom.removeClass(o[n],e)},k.prototype.refreshSelections=function(e){var t,o;if(this.instance.selections){if(o=this.instance.selections.length,e)for(t=0;o>t;t++)this.instance.selections[t].settings.className&&this.removeClassFromCells(this.instance.selections[t].settings.className),this.instance.selections[t].settings.highlightRowClassName&&this.removeClassFromCells(this.instance.selections[t].settings.highlightRowClassName),this.instance.selections[t].settings.highlightColumnClassName&&this.removeClassFromCells(this.instance.selections[t].settings.highlightColumnClassName);for(t=0;o>t;t++)this.instance.selections[t].draw(this.instance,e)}},k.prototype.getCell=function(e){if(this.isRowBeforeRenderedRows(e.row))return-1;if(this.isRowAfterRenderedRows(e.row))return-2;var t=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e.row)];return t?t.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e.col)]:void 0},k.prototype.getColumnHeader=function(e,t){t||(t=0);var o=this.THEAD.childNodes[t];return o?o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]:void 0;
},k.prototype.getRowHeader=function(e){if(0===this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0))return null;var t=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)];return t?t.childNodes[0]:void 0},k.prototype.getCoords=function(e){var o=e.parentNode,n=t.Dom.index(o);return n=o.parentNode===this.THEAD?this.rowFilter.visibleColHeadedRowToSourceRow(n):this.rowFilter.renderedToSource(n),new h(n,this.columnFilter.visibleRowHeadedColumnToSourceColumn(e.cellIndex))},k.prototype.getTrForRow=function(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]},k.prototype.getFirstRenderedRow=function(){return this.instance.wtViewport.rowsRenderCalculator.startRow},k.prototype.getFirstVisibleRow=function(){return this.instance.wtViewport.rowsVisibleCalculator.startRow},k.prototype.getFirstRenderedColumn=function(){return this.instance.wtViewport.columnsRenderCalculator.startColumn},k.prototype.getFirstVisibleColumn=function(){return this.instance.wtViewport.columnsVisibleCalculator.startColumn},k.prototype.getLastRenderedRow=function(){return this.instance.wtViewport.rowsRenderCalculator.endRow},k.prototype.getLastVisibleRow=function(){return this.instance.wtViewport.rowsVisibleCalculator.endRow},k.prototype.getLastRenderedColumn=function(){return this.instance.wtViewport.columnsRenderCalculator.endColumn},k.prototype.getLastVisibleColumn=function(){return this.instance.wtViewport.columnsVisibleCalculator.endColumn},k.prototype.isRowBeforeRenderedRows=function(e){return this.rowFilter.sourceToRendered(e)<0&&e>=0},k.prototype.isRowAfterViewport=function(e){return e>this.getLastVisibleRow()},k.prototype.isRowAfterRenderedRows=function(e){return e>this.getLastRenderedRow()},k.prototype.isColumnBeforeViewport=function(e){return this.columnFilter.sourceToRendered(e)<0&&e>=0},k.prototype.isColumnAfterViewport=function(e){return e>this.getLastVisibleColumn()},k.prototype.isLastRowFullyVisible=function(){return this.getLastVisibleRow()===this.getLastRenderedRow()},k.prototype.isLastColumnFullyVisible=function(){return this.getLastVisibleColumn()===this.getLastRenderedColumn},k.prototype.getRenderedColumnsCount=function(){return this.instance.cloneOverlay instanceof g?this.instance.getSetting("totalColumns"):this.instance.cloneOverlay instanceof R||this.instance.cloneOverlay instanceof b?this.instance.getSetting("fixedColumnsLeft"):this.instance.wtViewport.columnsRenderCalculator.count},k.prototype.getRenderedRowsCount=function(){return this.instance.cloneOverlay instanceof g?this.instance.getSetting("totalRows"):this.instance.cloneOverlay instanceof S||this.instance.cloneOverlay instanceof b?this.instance.getSetting("fixedRowsTop"):this.instance.wtViewport.rowsRenderCalculator.count},k.prototype.getVisibleRowsCount=function(){return this.instance.wtViewport.rowsVisibleCalculator.count},k.prototype.allRowsInViewport=function(){return this.instance.getSetting("totalRows")==this.getVisibleRowsCount()},k.prototype.getRowHeight=function(e){var t=this.instance.wtSettings.settings.rowHeight(e),o=this.instance.wtViewport.oversizedRows[e];return void 0!==o&&(t=t?Math.max(t,o):o),t},k.prototype.getColumnHeaderHeight=function(e){var t=this.instance.wtSettings.settings.defaultRowHeight,o=this.instance.wtViewport.oversizedColumnHeaders[e];return void 0!==o&&(t=t?Math.max(t,o):o),t},k.prototype.getVisibleColumnsCount=function(){return this.instance.wtViewport.columnsVisibleCalculator.count},k.prototype.allColumnsInViewport=function(){return this.instance.getSetting("totalColumns")==this.getVisibleColumnsCount()},k.prototype.getColumnWidth=function(e){var t=this.instance.wtSettings.settings.columnWidth;"function"==typeof t?t=t(e):"object"==typeof t&&(t=t[e]);var o=this.instance.wtViewport.oversizedCols[e];return void 0!==o&&(t=t?Math.max(t,o):o),t},k.prototype.getStretchedColumnWidth=function(e){var t,o=this.getColumnWidth(e)||this.instance.wtSettings.settings.defaultColumnWidth,n=this.instance.wtViewport.columnsRenderCalculator;return n&&(t=n.getStretchedColumnWidth(e,o),t&&(o=t)),o},A.prototype.render=function(){this.wtTable.isWorkingOnClone()||this.instance.getSetting("beforeDraw",!0),this.rowHeaders=this.instance.getSetting("rowHeaders"),this.rowHeaderCount=this.rowHeaders.length,this.fixedRowsTop=this.instance.getSetting("fixedRowsTop"),this.columnHeaders=this.instance.getSetting("columnHeaders"),this.columnHeaderCount=this.columnHeaders.length;var e,t,o=this.instance.getSetting("totalRows"),n=this.instance.getSetting("totalColumns"),i=!1,r=this.wtTable.getRenderedRowsCount();if(n>0&&(this.adjustAvailableNodes(),i=!0,this.renderColGroups(),this.renderColumnHeaders(),e=this.wtTable.getRenderedColumnsCount(),this.renderRows(o,r,e),this.wtTable.isWorkingOnClone()?this.adjustColumnHeaderHeights():(t=this.instance.wtViewport.getWorkspaceWidth(),this.instance.wtViewport.containerWidth=null),this.adjustColumnWidths(e)),i||this.adjustAvailableNodes(),this.removeRedundantRows(r),!this.wtTable.isWorkingOnClone()){if(this.markOversizedRows(),this.instance.wtViewport.createVisibleCalculators(),this.instance.wtScrollbars.applyToDOM(),t!==this.instance.wtViewport.getWorkspaceWidth()){this.instance.wtViewport.containerWidth=null;for(var s=this.wtTable.getFirstRenderedColumn(),a=this.wtTable.getLastRenderedColumn(),l=s;a>l;l++){var c=this.wtTable.getStretchedColumnWidth(l),u=this.columnFilter.sourceToRendered(l);this.COLGROUP.childNodes[u+this.rowHeaderCount].style.width=c+"px"}}this.instance.wtScrollbars.refresh(!1),this.instance.getSetting("onDraw",!0)}},A.prototype.removeRedundantRows=function(e){for(;this.wtTable.tbodyChildrenLength>e;)this.TBODY.removeChild(this.TBODY.lastChild),this.wtTable.tbodyChildrenLength--},A.prototype.renderRows=function(e,t,o){for(var n,i,r=0,s=this.rowFilter.renderedToSource(r),a=this.wtTable.isWorkingOnClone();e>s&&s>=0;){if(r>1e3)throw new Error("Security brake: Too much TRs. Please define height for your table, which will enforce scrollbars.");if(void 0!==t&&r===t)break;if(i=this.getOrCreateTrForRow(r,i),this.renderRowHeaders(s,i),this.adjustColumns(i,o+this.rowHeaderCount),n=this.renderCells(s,i,o),a||this.resetOversizedRow(s),i.firstChild){var l=this.instance.wtTable.getRowHeight(s);l?i.firstChild.style.height=l+"px":i.firstChild.style.height=""}r++,s=this.rowFilter.renderedToSource(r)}},A.prototype.resetOversizedRow=function(e){this.instance.wtViewport.oversizedRows&&this.instance.wtViewport.oversizedRows[e]&&(this.instance.wtViewport.oversizedRows[e]=void 0)},A.prototype.markOversizedRows=function(){for(var e,o,n,i,r=this.instance.wtTable.TBODY.childNodes.length;r;)r--,n=this.instance.wtTable.rowFilter.renderedToSource(r),e=this.instance.wtTable.getRowHeight(n),i=this.instance.wtTable.getTrForRow(n),o=t.Dom.innerHeight(i)-1,(!e&&this.instance.wtSettings.settings.defaultRowHeight<o||o>e)&&(this.instance.wtViewport.oversizedRows[n]=o)},A.prototype.adjustColumnHeaderHeights=function(){for(var e=this.instance.getSetting("columnHeaders"),t=0,o=e.length;o>t;t++)if(this.instance.wtViewport.oversizedColumnHeaders[t]){if(0===this.instance.wtTable.THEAD.childNodes[t].childNodes.length)return;this.instance.wtTable.THEAD.childNodes[t].childNodes[0].style.height=this.instance.wtViewport.oversizedColumnHeaders[t]+"px"}},A.prototype.markIfOversizedColumnHeader=function(e){var o,n,i,r,s=(0!==this.instance.wtTable.THEAD.childNodes.length?this.instance.wtTable.THEAD.childNodes[0].childNodes.length:0,this.instance.getSetting("columnHeaders")),a=s.length,l=a;for(o=this.instance.wtTable.columnFilter.renderedToSource(e);l;)l--,n=this.instance.wtTable.getColumnHeaderHeight(l),i=this.instance.wtTable.getColumnHeader(o,l),i&&(r=t.Dom.innerHeight(i)-1,(!n&&this.instance.wtSettings.settings.defaultRowHeight<r||r>n)&&(this.instance.wtViewport.oversizedColumnHeaders[l]=r))},A.prototype.renderCells=function(e,o,n){for(var i,r,s=0;n>s;s++)r=this.columnFilter.renderedToSource(s),i=0===s?o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)]:i.nextSibling,"TH"==i.nodeName&&(i=this.utils.replaceThWithTd(i,o)),t.Dom.hasClass(i,"hide")||(i.className=""),i.removeAttribute("style"),this.instance.wtSettings.settings.cellRenderer(e,r,i);return i},A.prototype.adjustColumnWidths=function(e){var t;this.instance.wtViewport.columnsRenderCalculator.refreshStretching(this.instance.wtViewport.getViewportWidth());for(var o=0;e>o;o++)t=this.wtTable.getStretchedColumnWidth(this.columnFilter.renderedToSource(o)),this.COLGROUP.childNodes[o+this.rowHeaderCount].style.width=t+"px"},A.prototype.appendToTbody=function(e){this.TBODY.appendChild(e),this.wtTable.tbodyChildrenLength++},A.prototype.getOrCreateTrForRow=function(e,t){var o;return e>=this.wtTable.tbodyChildrenLength?(o=this.createRow(),this.appendToTbody(o)):o=0===e?this.TBODY.firstChild:t.nextSibling,o},A.prototype.createRow=function(){for(var e=document.createElement("TR"),t=0;t<this.rowHeaderCount;t++)e.appendChild(document.createElement("TH"));return e},A.prototype.renderRowHeader=function(e,t,o){o.className="",o.removeAttribute("style"),this.rowHeaders[t](e,o,t)},A.prototype.renderRowHeaders=function(e,t){for(var o=t.firstChild,n=0;n<this.rowHeaderCount;n++)o?"TD"==o.nodeName&&(o=this.utils.replaceTdWithTh(o,t)):(o=document.createElement("TH"),t.appendChild(o)),this.renderRowHeader(e,n,o),o=o.nextSibling},A.prototype.adjustAvailableNodes=function(){this.adjustColGroups(),this.adjustThead()},A.prototype.renderColumnHeaders=function(){if(this.columnHeaderCount)for(var e,t,o=this.wtTable.getRenderedColumnsCount(),n=0;n<this.columnHeaderCount;n++)for(e=this.getTrForColumnHeaders(n),t=-1*this.rowHeaderCount;o>t;t++){var i=this.columnFilter.renderedToSource(t);this.renderColumnHeader(n,i,e.childNodes[t+this.rowHeaderCount]),this.wtTable.isWorkingOnClone()||this.markIfOversizedColumnHeader(t)}},A.prototype.adjustColGroups=function(){for(var e=this.wtTable.getRenderedColumnsCount();this.wtTable.colgroupChildrenLength<e+this.rowHeaderCount;)this.COLGROUP.appendChild(document.createElement("COL")),this.wtTable.colgroupChildrenLength++;for(;this.wtTable.colgroupChildrenLength>e+this.rowHeaderCount;)this.COLGROUP.removeChild(this.COLGROUP.lastChild),this.wtTable.colgroupChildrenLength--},A.prototype.adjustThead=function(){var e=this.wtTable.getRenderedColumnsCount(),o=this.THEAD.firstChild;if(this.columnHeaders.length){for(var n=0,i=this.columnHeaders.length;i>n;n++){for(o=this.THEAD.childNodes[n],o||(o=document.createElement("TR"),this.THEAD.appendChild(o)),this.theadChildrenLength=o.childNodes.length;this.theadChildrenLength<e+this.rowHeaderCount;)o.appendChild(document.createElement("TH")),this.theadChildrenLength++;for(;this.theadChildrenLength>e+this.rowHeaderCount;)o.removeChild(o.lastChild),this.theadChildrenLength--}var r=this.THEAD.childNodes.length;if(r>this.columnHeaders.length)for(var n=this.columnHeaders.length;r>n;n++)this.THEAD.removeChild(this.THEAD.lastChild)}else o&&t.Dom.empty(o)},A.prototype.getTrForColumnHeaders=function(e){var t=this.THEAD.childNodes[e];return t},A.prototype.renderColumnHeader=function(e,t,o){return o.className="",o.removeAttribute("style"),this.columnHeaders[e](t,o,e)},A.prototype.renderColGroups=function(){for(var e=0;e<this.wtTable.colgroupChildrenLength;e++)e<this.rowHeaderCount?t.Dom.addClass(this.COLGROUP.childNodes[e],"rowHeader"):t.Dom.removeClass(this.COLGROUP.childNodes[e],"rowHeader")},A.prototype.adjustColumns=function(e,t){for(var o=e.childNodes.length;t>o;){var n=document.createElement("TD");e.appendChild(n),o++}for(;o>t;)e.removeChild(e.lastChild),o--},A.prototype.removeRedundantColumns=function(e){for(;this.wtTable.tbodyChildrenLength>e;)this.TBODY.removeChild(this.TBODY.lastChild),this.wtTable.tbodyChildrenLength--},A.utils={},A.utils.replaceTdWithTh=function(e,t){var o;return o=document.createElement("TH"),t.insertBefore(o,e),t.removeChild(e),o},A.utils.replaceThWithTd=function(e,t){var o=document.createElement("TD");return t.insertBefore(o,e),t.removeChild(e),o},H.prototype.getWorkspaceHeight=function(){var o=this.instance.wtScrollbars.vertical.scrollHandler;if(o===e)return document.documentElement.clientHeight;var n=t.Dom.outerHeight(o),i=n>0&&o.clientHeight>0?o.clientHeight:1/0;return i},H.prototype.getWorkspaceWidth=function(){var o,n,i=this.instance.getSetting("totalColumns"),r=this.instance.wtScrollbars.horizontal.scrollHandler,s=this.instance.getSetting("stretchH");return o=t.freezeOverlays?Math.min(document.documentElement.offsetWidth-this.getWorkspaceOffset().left,document.documentElement.offsetWidth):Math.min(this.getContainerFillWidth(),document.documentElement.offsetWidth-this.getWorkspaceOffset().left,document.documentElement.offsetWidth),r===e&&i>0&&this.sumColumnWidths(0,i-1)>o?document.documentElement.clientWidth:r!==e&&(n=this.instance.wtScrollbars.horizontal.scrollHandler.style.overflow,"scroll"==n||"hidden"==n||"auto"==n)?Math.max(o,r.clientWidth):"none"!==s&&s?o:Math.max(o,t.Dom.outerWidth(this.instance.wtTable.TABLE))},H.prototype.sumColumnWidths=function(e,t){for(var o=0;t>e;)o+=this.instance.wtTable.getColumnWidth(e)||this.instance.wtSettings.defaultColumnWidth,e++;return o},H.prototype.getContainerFillWidth=function(){if(this.containerWidth)return this.containerWidth;for(var e,t,o=this.instance.wtTable.holder;o.parentNode!=document.body&&null!=o.parentNode&&-1===o.className.indexOf("handsontable");)o=o.parentNode;return t=document.createElement("DIV"),t.style.width="100%",t.style.height="1px",o.appendChild(t),e=t.offsetWidth,this.containerWidth=e,o.removeChild(t),e},H.prototype.getWorkspaceOffset=function(){return t.Dom.offset(this.instance.wtTable.TABLE)},H.prototype.getWorkspaceActualHeight=function(){return t.Dom.outerHeight(this.instance.wtTable.TABLE)},H.prototype.getWorkspaceActualWidth=function(){return t.Dom.outerWidth(this.instance.wtTable.TABLE)||t.Dom.outerWidth(this.instance.wtTable.TBODY)||t.Dom.outerWidth(this.instance.wtTable.THEAD)},H.prototype.getColumnHeaderHeight=function(){return isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=t.Dom.outerHeight(this.instance.wtTable.THEAD)),this.columnHeaderHeight},H.prototype.getViewportHeight=function(){var e=this.getWorkspaceHeight();if(e===1/0)return e;var t=this.getColumnHeaderHeight();return t>0&&(e-=t),e},H.prototype.getRowHeaderWidth=function(){if(this.instance.cloneSource)return this.instance.cloneSource.wtViewport.getRowHeaderWidth();if(isNaN(this.rowHeaderWidth)){var e=this.instance.getSetting("rowHeaders");if(e.length){var o=this.instance.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(var n=0,i=e.length;i>n;n++)o?(this.rowHeaderWidth+=t.Dom.outerWidth(o),o=o.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0}return this.rowHeaderWidth},H.prototype.getViewportWidth=function(){var e,t=this.getWorkspaceWidth();return t===1/0?t:(e=this.getRowHeaderWidth(),e>0?t-e:t)},H.prototype.createRowsCalculator=function(e){this.rowHeaderWidth=NaN;var t;t=this.instance.wtSettings.settings.renderAllRows?1/0:this.getViewportHeight();var o=this.instance.wtScrollbars.vertical.getScrollPosition()-this.instance.wtScrollbars.vertical.getTableParentOffset();0>o&&(o=0);var n=this.instance.getSetting("fixedRowsTop");if(n){var i=this.instance.wtScrollbars.vertical.sumCellSizes(0,n);o+=i,t-=i}var r=this;return new O(t,o,this.instance.getSetting("totalRows"),function(e){return r.instance.wtTable.getRowHeight(e)},e?null:this.instance.wtSettings.settings.viewportRowCalculatorOverride,e?!0:!1)},H.prototype.createColumnsCalculator=function(e){this.columnHeaderHeight=NaN;var t=this.getViewportWidth(),o=this.instance.wtScrollbars.horizontal.getScrollPosition()-this.instance.wtScrollbars.vertical.getTableParentOffset();0>o&&(o=0);var n=this.instance.getSetting("fixedColumnsLeft");if(n){var i=this.instance.wtScrollbars.horizontal.sumCellSizes(0,n);o+=i,t-=i}var r=this;return new x(t,o,this.instance.getSetting("totalColumns"),function(e){return r.instance.wtTable.getColumnWidth(e)},e?null:this.instance.wtSettings.settings.viewportColumnCalculatorOverride,e?!0:!1,this.instance.getSetting("stretchH"))},H.prototype.createRenderCalculators=function(e){if(e){var t=this.createRowsCalculator(!0),o=this.createColumnsCalculator(!0);this.areAllProposedVisibleRowsAlreadyRendered(t)&&this.areAllProposedVisibleColumnsAlreadyRendered(o)||(e=!1)}return e||(this.rowsRenderCalculator=this.createRowsCalculator(),this.columnsRenderCalculator=this.createColumnsCalculator()),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,e},H.prototype.createVisibleCalculators=function(){this.rowsVisibleCalculator=this.createRowsCalculator(!0),this.columnsVisibleCalculator=this.createColumnsCalculator(!0)},H.prototype.areAllProposedVisibleRowsAlreadyRendered=function(e){return this.rowsVisibleCalculator?e.startRow<this.rowsRenderCalculator.startRow||e.startRow===this.rowsRenderCalculator.startRow&&e.startRow>0?!1:e.endRow>this.rowsRenderCalculator.endRow||e.endRow===this.rowsRenderCalculator.endRow&&e.endRow<this.instance.getSetting("totalRows")-1?!1:!0:!1},H.prototype.areAllProposedVisibleColumnsAlreadyRendered=function(e){return this.columnsVisibleCalculator?e.startColumn<this.columnsRenderCalculator.startColumn||e.startColumn===this.columnsRenderCalculator.startColumn&&e.startColumn>0?!1:e.endColumn>this.columnsRenderCalculator.endColumn||e.endColumn===this.columnsRenderCalculator.endColumn&&e.endColumn<this.instance.getSetting("totalColumns")-1?!1:!0:!1},e.jQuery&&!function(e,t,o){t.fn.handsontable=function(e){var t,n,i,r,s,a=this.first(),l=a.data("handsontable");if("string"!=typeof e)return s=e||{},l?l.updateSettings(s):(l=new o.Core(a[0],s),a.data("handsontable",l),l.init()),a;if(i=[],arguments.length>1)for(t=1,n=arguments.length;n>t;t++)i.push(arguments[t]);if(l){if("undefined"==typeof l[e])throw new Error("Handsontable do not provide action: "+e);r=l[e].apply(l,i),"destroy"===e&&a.removeData()}return r}}(e,jQuery,t)}(window,Handsontable),/*!
 * numeral.js
 * version : 1.5.3
 * author : Adam Draper
 * license : MIT
 * http://adamwdraper.github.com/Numeral-js/
 */
function(){function e(e){this._value=e}function t(e,t,o,n){var i,r,s=Math.pow(10,t);return r=(o(e*s)/s).toFixed(t),n&&(i=new RegExp("0{1,"+n+"}$"),r=r.replace(i,"")),r}function o(e,t,o){var n;return n=t.indexOf("$")>-1?i(e,t,o):t.indexOf("%")>-1?r(e,t,o):t.indexOf(":")>-1?s(e,t):l(e._value,t,o)}function n(e,t){var o,n,i,r,s,l=t,c=["KB","MB","GB","TB","PB","EB","ZB","YB"],u=!1;if(t.indexOf(":")>-1)e._value=a(t);else if(t===g)e._value=0;else{for("."!==p[m].delimiters.decimal&&(t=t.replace(/\./g,"").replace(p[m].delimiters.decimal,".")),o=new RegExp("[^a-zA-Z]"+p[m].abbreviations.thousand+"(?:\\)|(\\"+p[m].currency.symbol+")?(?:\\))?)?$"),n=new RegExp("[^a-zA-Z]"+p[m].abbreviations.million+"(?:\\)|(\\"+p[m].currency.symbol+")?(?:\\))?)?$"),i=new RegExp("[^a-zA-Z]"+p[m].abbreviations.billion+"(?:\\)|(\\"+p[m].currency.symbol+")?(?:\\))?)?$"),r=new RegExp("[^a-zA-Z]"+p[m].abbreviations.trillion+"(?:\\)|(\\"+p[m].currency.symbol+")?(?:\\))?)?$"),s=0;s<=c.length&&!(u=t.indexOf(c[s])>-1?Math.pow(1024,s+1):!1);s++);e._value=(u?u:1)*(l.match(o)?Math.pow(10,3):1)*(l.match(n)?Math.pow(10,6):1)*(l.match(i)?Math.pow(10,9):1)*(l.match(r)?Math.pow(10,12):1)*(t.indexOf("%")>-1?.01:1)*((t.split("-").length+Math.min(t.split("(").length-1,t.split(")").length-1))%2?1:-1)*Number(t.replace(/[^0-9\.]+/g,"")),e._value=u?Math.ceil(e._value):e._value}return e._value}function i(e,t,o){var n,i,r=t.indexOf("$"),s=t.indexOf("("),a=t.indexOf("-"),c="";return t.indexOf(" $")>-1?(c=" ",t=t.replace(" $","")):t.indexOf("$ ")>-1?(c=" ",t=t.replace("$ ","")):t=t.replace("$",""),i=l(e._value,t,o),1>=r?i.indexOf("(")>-1||i.indexOf("-")>-1?(i=i.split(""),n=1,(s>r||a>r)&&(n=0),i.splice(n,0,p[m].currency.symbol+c),i=i.join("")):i=p[m].currency.symbol+c+i:i.indexOf(")")>-1?(i=i.split(""),i.splice(-1,0,c+p[m].currency.symbol),i=i.join("")):i=i+c+p[m].currency.symbol,i}function r(e,t,o){var n,i="",r=100*e._value;return t.indexOf(" %")>-1?(i=" ",t=t.replace(" %","")):t=t.replace("%",""),n=l(r,t,o),n.indexOf(")")>-1?(n=n.split(""),n.splice(-1,0,i+"%"),n=n.join("")):n=n+i+"%",n}function s(e){var t=Math.floor(e._value/60/60),o=Math.floor((e._value-60*t*60)/60),n=Math.round(e._value-60*t*60-60*o);return t+":"+(10>o?"0"+o:o)+":"+(10>n?"0"+n:n)}function a(e){var t=e.split(":"),o=0;return 3===t.length?(o+=60*Number(t[0])*60,o+=60*Number(t[1]),o+=Number(t[2])):2===t.length&&(o+=60*Number(t[0]),o+=Number(t[1])),Number(o)}function l(e,o,n){var i,r,s,a,l,c,u=!1,h=!1,d=!1,f="",w=!1,v=!1,C=!1,y=!1,b=!1,R="",S="",E=Math.abs(e),T=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],D="",k=!1;if(0===e&&null!==g)return g;if(o.indexOf("(")>-1?(u=!0,o=o.slice(1,-1)):o.indexOf("+")>-1&&(h=!0,o=o.replace(/\+/g,"")),o.indexOf("a")>-1&&(w=o.indexOf("aK")>=0,v=o.indexOf("aM")>=0,C=o.indexOf("aB")>=0,y=o.indexOf("aT")>=0,b=w||v||C||y,o.indexOf(" a")>-1?(f=" ",o=o.replace(" a","")):o=o.replace("a",""),E>=Math.pow(10,12)&&!b||y?(f+=p[m].abbreviations.trillion,e/=Math.pow(10,12)):E<Math.pow(10,12)&&E>=Math.pow(10,9)&&!b||C?(f+=p[m].abbreviations.billion,e/=Math.pow(10,9)):E<Math.pow(10,9)&&E>=Math.pow(10,6)&&!b||v?(f+=p[m].abbreviations.million,e/=Math.pow(10,6)):(E<Math.pow(10,6)&&E>=Math.pow(10,3)&&!b||w)&&(f+=p[m].abbreviations.thousand,e/=Math.pow(10,3))),o.indexOf("b")>-1)for(o.indexOf(" b")>-1?(R=" ",o=o.replace(" b","")):o=o.replace("b",""),s=0;s<=T.length;s++)if(i=Math.pow(1024,s),r=Math.pow(1024,s+1),e>=i&&r>e){R+=T[s],i>0&&(e/=i);break}return o.indexOf("o")>-1&&(o.indexOf(" o")>-1?(S=" ",o=o.replace(" o","")):o=o.replace("o",""),S+=p[m].ordinal(e)),o.indexOf("[.]")>-1&&(d=!0,o=o.replace("[.]",".")),a=e.toString().split(".")[0],l=o.split(".")[1],c=o.indexOf(","),l?(l.indexOf("[")>-1?(l=l.replace("]",""),l=l.split("["),D=t(e,l[0].length+l[1].length,n,l[1].length)):D=t(e,l.length,n),a=D.split(".")[0],D=D.split(".")[1].length?p[m].delimiters.decimal+D.split(".")[1]:"",d&&0===Number(D.slice(1))&&(D="")):a=t(e,null,n),a.indexOf("-")>-1&&(a=a.slice(1),k=!0),c>-1&&(a=a.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+p[m].delimiters.thousands)),0===o.indexOf(".")&&(a=""),(u&&k?"(":"")+(!u&&k?"-":"")+(!k&&h?"+":"")+a+D+(S?S:"")+(f?f:"")+(R?R:"")+(u&&k?")":"")}function c(e,t){p[e]=t}function u(e){var t=e.toString().split(".");return t.length<2?1:Math.pow(10,t[1].length)}function h(){var e=Array.prototype.slice.call(arguments);return e.reduce(function(e,t){var o=u(e),n=u(t);return o>n?o:n},-(1/0))}var d,f="1.5.3",p={},m="en",g=null,w="0,0",v="undefined"!=typeof module&&module.exports;d=function(t){return d.isNumeral(t)?t=t.value():0===t||"undefined"==typeof t?t=0:Number(t)||(t=d.fn.unformat(t)),new e(Number(t))},d.version=f,d.isNumeral=function(t){return t instanceof e},d.language=function(e,t){if(!e)return m;if(e=e.toLowerCase(),e&&!t){if(!p[e])throw new Error("Unknown language : "+e);m=e}return(t||!p[e])&&c(e,t),d},d.languageData=function(e){if(!e)return p[m];if(!p[e])throw new Error("Unknown language : "+e);return p[e]},d.language("en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(e){var t=e%10;return 1===~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th"},currency:{symbol:"$"}}),d.zeroFormat=function(e){g="string"==typeof e?e:null},d.defaultFormat=function(e){w="string"==typeof e?e:"0.0"},d.validate=function(e,t){var o,n,i,r,s,a,l,c;if("string"!=typeof e&&(e+="",console.warn&&console.warn("Numeral.js: Value is not string. It has been co-erced to: ",e)),e=e.trim(),""===e)return!1;e=e.replace(/^[+-]?/,"");try{l=d.languageData(t)}catch(u){l=d.languageData(d.language())}return i=l.currency.symbol,s=l.abbreviations,o=l.delimiters.decimal,n="."===l.delimiters.thousands?"\\.":l.delimiters.thousands,c=e.match(/^[^\d]+/),null!==c&&(e=e.substr(1),c[0]!==i)?!1:(c=e.match(/[^\d]+$/),null!==c&&(e=e.slice(0,-1),c[0]!==s.thousand&&c[0]!==s.million&&c[0]!==s.billion&&c[0]!==s.trillion)?!1:e.match(/^\d+$/)?!0:(a=new RegExp(n+"{2}"),e.match(/[^\d.,]/g)?!1:(r=e.split(o),r.length>2?!1:r.length<2?!!r[0].match(/^\d+.*\d$/)&&!r[0].match(a):1===r[0].length?!!r[0].match(/^\d+$/)&&!r[0].match(a)&&!!r[1].match(/^\d+$/):!!r[0].match(/^\d+.*\d$/)&&!r[0].match(a)&&!!r[1].match(/^\d+$/))))},"function"!=typeof Array.prototype.reduce&&(Array.prototype.reduce=function(e,t){"use strict";if(null===this||"undefined"==typeof this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof e)throw new TypeError(e+" is not a function");var o,n,i=this.length>>>0,r=!1;for(1<arguments.length&&(n=t,r=!0),o=0;i>o;++o)this.hasOwnProperty(o)&&(r?n=e(n,this[o],o,this):(n=this[o],r=!0));if(!r)throw new TypeError("Reduce of empty array with no initial value");return n}),d.fn=e.prototype={clone:function(){return d(this)},format:function(e,t){return o(this,e?e:w,void 0!==t?t:Math.round)},unformat:function(e){return"[object Number]"===Object.prototype.toString.call(e)?e:n(this,e?e:w)},value:function(){return this._value},valueOf:function(){return this._value},set:function(e){return this._value=Number(e),this},add:function(e){function t(e,t,n,i){return e+o*t}var o=h.call(null,this._value,e);return this._value=[this._value,e].reduce(t,0)/o,this},subtract:function(e){function t(e,t,n,i){return e-o*t}var o=h.call(null,this._value,e);return this._value=[e].reduce(t,this._value*o)/o,this},multiply:function(e){function t(e,t,o,n){var i=h(e,t);return e*i*(t*i)/(i*i)}return this._value=[this._value,e].reduce(t,1),this},divide:function(e){function t(e,t,o,n){var i=h(e,t);return e*i/(t*i)}return this._value=[this._value,e].reduce(t),this},difference:function(e){return Math.abs(d(this._value).subtract(e).value())}},v&&(module.exports=d),"undefined"==typeof ender&&(this.numeral=d),"function"==typeof define&&define.amd&&define([],function(){return d})}.call(this);var objectData=[],hot,hover=function(e,t,o){var n;if($("#graph-line").data("rapid")&&(n=$("#graph-line").data("rapid").chart.morris_attrs.data),!n)return o;var i=n[e],r=$("#dynamic-js").data("remove");return o+'<a href="javascript:deleteHistory('+i.id+", '"+dateFormatDefault(i.day)+"');\">"+r+"</a>"},loadData=function(){var e=","==numeral.languageData().delimiters.decimal?",":"\\.",t=new RegExp("^\\s*[+-]?\\s*(?:(?:\\d+(?:"+e+"\\d+)?(?:e[+-]?\\d+)?)|(?:0x[a-f\\d]+))\\s*$","i"),o=function(e){var o=typeof e;return"number"==o?!(isNaN(e)||!isFinite(e)):"string"==o&&e.length?1==e.length?/\d/.test(e):t.test(e):!1},n=document.documentElement.lang;$("#spreadsheet").html(""),$("#graph-line").data("rapid")&&(objectData=$("#graph-line").data("rapid").chart.morris_attrs.data.map(function(e){return{day:dateFormatDefault(e.day),value:null===e.value?"":numeral(e.value).format("0.[00000000]"),goal:null===e.goal?"":numeral(e.goal).format("0.[00000000]"),previous:null===e.previous?"":numeral(e.previous).format("0.[00000000]")}}),null==objectData&&(objectData=[]));var i=document.getElementById("spreadsheet"),r=function(e,t){t(e&&0!==e.length?o(e)?!0:!1:!0)};hot=new Handsontable(i,{data:objectData,colHeaders:$("#dynamic-js").data("columns").split(","),columns:[{data:"day",type:"date"},{type:"text",language:n,className:"htRight",validator:r,data:"value"},{type:"text",language:n,className:"htRight",validator:r,data:"goal"},{type:"text",language:n,className:"htRight",validator:r,data:"previous"}],dateFormat:$("[data-rapid-page-data]").data("rapid-page-data").dateformat.toUpperCase(),correctFormat:!0,contextMenu:["row_above","row_below","remove_row","undo","redo"],minSpareRows:1}),Handsontable.hooks.add("afterValidate",function(e,t,o,n,i){return e?void 0:(hadErrors=!0,!1)},hot)},hadErrors=!1,data_update=function(){for(hadErrors=!1;hot.isEmptyRow(objectData.length-1);)hot.updateSettings({minSpareRows:0}),hot.alter("remove_row",objectData.length-1);return hot.validateCells(function(e){if(hadErrors)return!1;var t=objectData.map(function(e){return{day:e.day,value:null==e.value||""==e.value?null:numeral(e.value).value(),goal:null==e.goal||""==e.goal?null:numeral(e.goal).value(),previous:null==e.previous||""==e.previous?null:numeral(e.previous).value()}});$("#json").val(JSON.stringify(t)),$("#upload").submit()}),!1};$(document).ready(loadData);